<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSVÂä®ÁîªÂØπÊØî</title>
    <script>
        // === Â§ö CDN Â§á‰ªΩÂä†ËΩΩÊú∫Âà∂ ===
        // Ëß£ÂÜ≥ Windows Âπ≥Âè∞‰∏ä CDN ËÆøÈóÆÈóÆÈ¢ò

        (function() {
            'use strict';

            // CDN ÂàóË°®ÔºàÊåâ‰ºòÂÖàÁ∫ßÊéíÂ∫èÔºâ- ÂõΩÂÜÖÂèãÂ•Ω CDN
            const cdnList = [
                {
                    name: 'BootCDN (ÂõΩÂÜÖ)',
                    url: 'https://cdn.bootcdn.net/ajax/libs/Chart.js/4.4.1/chart.umd.min.js',
                    timeout: 8000
                },
                {
                    name: 'Staticfile (‰∏ÉÁâõ‰∫ë)',
                    url: 'https://cdn.staticfile.org/Chart.js/4.4.1/chart.umd.min.js',
                    timeout: 8000
                },
                {
                    name: 'Baomitu (‰øùÈöúÊÄß)',
                    url: 'https://lib.baomitu.com/Chart.js/4.4.1/chart.umd.min.js',
                    timeout: 8000
                },
                {
                    name: 'jsDelivr (ÂõΩÈôÖ)',
                    url: 'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js',
                    timeout: 5000
                },
                {
                    name: 'cdnjs (ÂõΩÈôÖ)',
                    url: 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js',
                    timeout: 5000
                }
            ];

            let currentCdnIndex = 0;
            let currentScript = null; // Ë∑üË∏™ÂΩìÂâçÂä†ËΩΩÁöÑËÑöÊú¨
            let loadTimeout = null;
            let isLoaded = false; // Èò≤Ê≠¢ÈáçÂ§çÂä†ËΩΩ
            let isAborted = false; // Èò≤Ê≠¢Â∑≤‰∏≠Ê≠¢ÁöÑÂä†ËΩΩËß¶ÂèëÂõûË∞É

            // ÂÅúÊ≠¢ÂΩìÂâçÂä†ËΩΩ
            function abortCurrentLoad() {
                if (currentScript) {
                    // ÁßªÈô§ËÑöÊú¨ËäÇÁÇπ‰ª•ÂÅúÊ≠¢Âä†ËΩΩ
                    if (currentScript.parentNode) {
                        currentScript.parentNode.removeChild(currentScript);
                    }
                    // Ê∏ÖÈô§‰∫ã‰ª∂ÁõëÂê¨Âô®
                    currentScript.onload = null;
                    currentScript.onerror = null;
                    currentScript = null;
                }
                if (loadTimeout) {
                    clearTimeout(loadTimeout);
                    loadTimeout = null;
                }
                isAborted = true;
            }

            // Âä†ËΩΩ Chart.js ËÑöÊú¨
            function loadChartJs(cdnIndex) {
                // Â¶ÇÊûúÂ∑≤ÁªèÊàêÂäüÂä†ËΩΩÔºå‰∏çÂÜçÂ∞ùËØï
                if (isLoaded || typeof Chart !== 'undefined') {
                    console.log('‚úÖ Chart.js Â∑≤Âä†ËΩΩÔºåË∑≥ËøáÂêéÁª≠ CDN');
                    return;
                }

                if (cdnIndex >= cdnList.length) {
                    console.error('‚ùå ÊâÄÊúâ CDN ÂùáÂä†ËΩΩÂ§±Ë¥•ÔºÅ');
                    showLoadFailedWarning();
                    return;
                }

                const cdn = cdnList[cdnIndex];
                console.log(`üì° Â∞ùËØï‰ªé ${cdn.name} Âä†ËΩΩ Chart.js...`);

                // ÂÅúÊ≠¢‰πãÂâçÁöÑÂä†ËΩΩ
                abortCurrentLoad();
                isAborted = false;

                const script = document.createElement('script');
                currentScript = script;
                script.async = false; // ‰øùÊåÅÂêåÊ≠•Âä†ËΩΩ‰ª•Á°Æ‰øùÊâßË°åÈ°∫Â∫è
                script.src = cdn.url;

                // ÊàêÂäüÂä†ËΩΩ
                script.onload = function() {
                    // Â¶ÇÊûúÂ∑≤‰∏≠Ê≠¢Ôºå‰∏çÂ§ÑÁêÜ
                    if (isAborted) {
                        console.log(`‚ö†Ô∏è ${cdn.name} Âä†ËΩΩÂÆåÊàê‰ΩÜÂ∑≤Ë¢´‰∏≠Ê≠¢`);
                        return;
                    }

                    // Ê∏ÖÈô§Ë∂ÖÊó∂
                    if (loadTimeout) {
                        clearTimeout(loadTimeout);
                        loadTimeout = null;
                    }

                    // ÂèåÈáçÊ£ÄÊü• Chart ÊòØÂê¶ÁúüÁöÑÂä†ËΩΩÊàêÂäü
                    if (typeof Chart !== 'undefined') {
                        isLoaded = true;
                        currentScript = null;
                        const loadTime = Date.now() - performance.timing.navigationStart;
                        console.log(`‚úÖ Chart.js ‰ªé ${cdn.name} Âä†ËΩΩÊàêÂäüÔºÅËÄóÊó∂: ${loadTime}ms`);
                        window.chartJsLoadStatus = {
                            isLoaded: true,
                            loadTime: loadTime,
                            cdnUsed: cdn.name
                        };
                    } else {
                        console.warn(`‚ö†Ô∏è ${cdn.name} ËÑöÊú¨Â∑≤Âä†ËΩΩÔºå‰ΩÜ Chart ÂØπË±°Êú™ÂÆö‰πâÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™ CDN...`);
                        currentScript = null;
                        tryNextCdn(cdnIndex);
                    }
                };

                // Âä†ËΩΩÂ§±Ë¥•
                script.onerror = function() {
                    // Â¶ÇÊûúÂ∑≤‰∏≠Ê≠¢Ôºå‰∏çÂ§ÑÁêÜ
                    if (isAborted) {
                        return;
                    }

                    console.warn(`‚ùå ${cdn.name} Âä†ËΩΩÂ§±Ë¥•ÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™ CDN...`);
                    currentScript = null;
                    tryNextCdn(cdnIndex);
                };

                // ËÆæÁΩÆË∂ÖÊó∂
                loadTimeout = setTimeout(() => {
                    if (isAborted || isLoaded) {
                        return;
                    }
                    console.warn(`‚è±Ô∏è ${cdn.name} Âä†ËΩΩË∂ÖÊó∂ (${cdn.timeout}ms)ÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™ CDN...`);
                    // ‰∏≠Ê≠¢ÂΩìÂâçÂä†ËΩΩÂπ∂Â∞ùËØï‰∏ã‰∏Ä‰∏™
                    abortCurrentLoad();
                    tryNextCdn(cdnIndex);
                }, cdn.timeout);

                document.head.appendChild(script);
            }

            // Â∞ùËØï‰∏ã‰∏Ä‰∏™ CDN
            function tryNextCdn(failedIndex) {
                currentCdnIndex = failedIndex + 1;
                if (currentCdnIndex < cdnList.length) {
                    // Áü≠ÊöÇÂª∂ËøüÂêéÈáçËØï
                    setTimeout(() => {
                        loadChartJs(currentCdnIndex);
                    }, 500);
                } else {
                    console.error('‚ùå ÊâÄÊúâ CDN ÂùáÂä†ËΩΩÂ§±Ë¥•ÔºÅ');
                    showLoadFailedWarning();
                }
            }

            // ÊòæÁ§∫Âä†ËΩΩÂ§±Ë¥•Ë≠¶Âëä
            function showLoadFailedWarning() {
                window.chartJsLoadStatus = {
                    isLoaded: false,
                    loadTime: null,
                    cdnUsed: null
                };

                // Á≠âÂæÖ DOM Âä†ËΩΩÂêéÊòæÁ§∫Ë≠¶Âëä
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', showWarning);
                } else {
                    showWarning();
                }
            }

            function showWarning() {
                const warningDiv = document.createElement('div');
                warningDiv.style.cssText = 'position: fixed; top: 10px; left: 50%; transform: translateX(-50%); ' +
                    'background: #ff6b6b; color: white; padding: 20px 25px; border-radius: 8px; ' +
                    'z-index: 10000; font-size: 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); max-width: 80%;';
                warningDiv.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 10px;">‚ö†Ô∏è Chart.js Âä†ËΩΩÂ§±Ë¥•</div>
                    <div style="font-size: 13px; line-height: 1.6;">
                        ÊâÄÊúâÂõΩÂÜÖ/ÂõΩÈôÖ CDN ÂùáÊó†Ê≥ïËÆøÈóÆ<br>
                        <strong>ÂèØËÉΩÂéüÂõ†Ôºö</strong><br>
                        ‚Ä¢ ÁΩëÁªúËøûÊé•Êñ≠ÂºÄÊàñÈôêÂà∂<br>
                        ‚Ä¢ ÂÖ¨Âè∏/Â≠¶Ê†°ÁΩëÁªúÁ≠ñÁï•ÈôêÂà∂<br>
                        ‚Ä¢ Èò≤ÁÅ´Â¢ôÊàñÂÆâÂÖ®ËΩØ‰ª∂ÈòªÊ≠¢<br>
                        ‚Ä¢ DNS Ëß£ÊûêÈóÆÈ¢ò<br>
                        <br>
                        <strong>Ëß£ÂÜ≥ÊñπÊ°àÔºö</strong><br>
                        1. Âà∑Êñ∞È°µÈù¢ÈáçËØï (F5)<br>
                        2. Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÊòØÂê¶Ê≠£Â∏∏<br>
                        3. Â∞ùËØïÂàáÊç¢ÁΩëÁªúÔºàÂ¶ÇÊâãÊú∫ÁÉ≠ÁÇπÔºâ<br>
                        4. ÊöÇÊó∂ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô/ÂÆâÂÖ®ËΩØ‰ª∂<br>
                        5. ÊåâF12Êü•ÁúãÊéßÂà∂Âè∞ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ
                    </div>
                `;

                document.body.appendChild(warningDiv);

                // 15ÁßíÂêéËá™Âä®ÁßªÈô§
                setTimeout(() => {
                    if (warningDiv.parentNode) {
                        warningDiv.parentNode.removeChild(warningDiv);
                    }
                }, 15000);
            }

            // ÂêØÂä®Âä†ËΩΩ
            console.log('üöÄ ÂºÄÂßãÂä†ËΩΩ Chart.js...');
            loadChartJs(0);

        })();
    </script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --primary-hover: #5a6fd6;
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger-gradient: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.12);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 24px;
            background:
                linear-gradient(135deg, rgba(245, 247, 250, 0.75) 0%, rgba(228, 237, 245, 0.75) 50%, rgba(240, 244, 248, 0.75) 100%),
                var(--bg-image, url('https://w.wallhaven.cc/full/2y/wallhaven-2yo7y9.png'));
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            color: #2d3748;
            line-height: 1.6;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            padding: 32px;
        }
        .main-title-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 8px;
        }
        .version-info {
            font-size: 14px;
            color: #718096;
            text-align: center;
            margin-bottom: 28px;
            font-weight: 500;
        }
        .version-info a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .version-info a:hover {
            color: var(--primary-hover);
            text-decoration: underline;
        }
        h1 {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        .upload-section {
            border: 2px dashed rgba(102, 126, 234, 0.4);
            border-radius: var(--radius-lg);
            padding: 40px;
            margin-bottom: 28px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .upload-section.has-file {
            border-style: solid;
            border-color: rgba(102, 126, 234, 0.2);
            padding: 20px;
            background: rgba(255, 255, 255, 0.25);
        }
        .upload-section .upload-prompt {
            text-align: center;
        }
        .upload-section:hover {
            border-color: rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .upload-section.dragover {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.12) 0%, rgba(118, 75, 162, 0.12) 100%);
            transform: scale(1.01);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.2);
        }
        .upload-section.parsing {
            pointer-events: none;
            opacity: 0.7;
        }
        .file-input {
            display: none;
        }
        .upload-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .upload-btn:active {
            transform: translateY(0);
        }
        .upload-btn:disabled {
            background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        .data-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        .data-preview-header h3 {
            margin: 0;
            color: #2d3748;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .data-preview-section {
            margin-bottom: 28px;
        }
        .data-preview {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(102, 126, 234, 0.15);
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow-sm);
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }
        th {
            background: linear-gradient(135deg, rgba(240, 242, 255, 0.95) 0%, rgba(235, 238, 255, 0.95) 100%);
            position: sticky;
            top: 0;
            font-weight: 600;
            color: #2d3748;
            font-size: 0.9rem;
            z-index: 1;
        }
        tr:hover td {
            background: rgba(102, 126, 234, 0.03);
        }
        tr:hover td.row-number {
            background: linear-gradient(135deg, rgba(230, 234, 255, 0.98) 0%, rgba(225, 230, 255, 0.98) 100%);
        }
        /* Ë°åÂè∑ÂàóÂõ∫ÂÆöÊ†∑Âºè */
        td.row-number {
            background: linear-gradient(135deg, rgba(245, 247, 255, 0.95) 0%, rgba(242, 245, 255, 0.95) 100%);
            position: sticky;
            left: 0;
            z-index: 1;
            font-weight: 600;
            width: 60px;
            min-width: 60px;
            max-width: 60px;
            white-space: nowrap;
            text-align: center;
            color: #667eea;
        }
        th.row-number-header {
            background: linear-gradient(135deg, rgba(230, 234, 255, 0.98) 0%, rgba(225, 230, 255, 0.98) 100%);
            position: sticky;
            left: 0;
            z-index: 2;
            width: 60px;
            min-width: 60px;
            max-width: 60px;
        }
        .config-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 28px;
        }
        .config-group {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(102, 126, 234, 0.1);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }
        .config-group:hover {
            box-shadow: var(--shadow-md);
            border-color: rgba(102, 126, 234, 0.2);
        }
        .config-group h3 {
            margin-top: 0;
            color: #2d3748;
            border-bottom: 2px solid rgba(102, 126, 234, 0.15);
            padding-bottom: 12px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a5568;
            font-size: 0.95rem;
        }
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: var(--radius-sm);
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.35);
            transition: all 0.3s ease;
            font-size: 14px;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
            background: white;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        /* ÈªòËÆ§ÂÄºÊ†∑Âºè */
        .default-value {
            color: #a0aec0;
        }

        /* Áªü‰∏ÄËæìÂÖ•Ê°ÜÂíå‰∏ãÊãâÊ°ÜÊ†∑Âºè */
        input[type="text"],
        input[type="number"],
        select {
            padding: 12px 16px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: var(--radius-sm);
            background: rgba(255, 255, 255, 0.35);
            font-size: 14px;
            box-sizing: border-box;
            height: 44px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
            background: white;
        }
        /* ÊâãÂä®‰øÆÊîπÂÄºÊ†∑Âºè */
        .manual-value {
            color: #2d3748;
        }
        .btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn:disabled {
            background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
            opacity: 0.7;
        }
        .btn-secondary {
            background: linear-gradient(135deg, #718096 0%, #4a5568 100%);
            box-shadow: 0 4px 12px rgba(113, 128, 150, 0.25);
        }
        .btn-secondary:hover {
            box-shadow: 0 6px 20px rgba(113, 128, 150, 0.35);
        }
        .btn-danger {
            background: var(--danger-gradient);
            box-shadow: 0 4px 12px rgba(238, 90, 111, 0.25);
        }
        .btn-danger:hover {
            box-shadow: 0 6px 20px rgba(238, 90, 111, 0.35);
        }
        .chart-container {
            margin-top: 28px;
            position: relative;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(102, 126, 234, 0.1);
            padding: 20px;
            box-shadow: var(--shadow-sm);
        }
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 24px;
            width: 100%;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(102, 126, 234, 0.1);
            box-shadow: var(--shadow-sm);
        }
        .control-buttons {
            display: flex;
            gap: 12px;
        }
        .frame-info {
            margin: 0 20px;
            font-weight: 600;
            min-width: 100px;
            text-align: right;
            color: #4a5568;
            font-size: 1rem;
        }
        .progress-container {
            flex: 2;
            margin: 0 20px;
            max-width: 800px;
        }
        .progress {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 5px;
            outline: none;
            cursor: pointer;
        }
        .progress::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary-gradient);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }
        .progress::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.5);
        }
        .progress::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--primary-gradient);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }
        .hidden {
            display: none !important;
        }


        /* ToastÈÄöÁü•Ê†∑Âºè */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 10000;
            max-width: 420px;
        }

        .toast {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            margin-bottom: 12px;
            padding: 18px 24px;
            transform: translateX(120%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 100%;
            word-wrap: break-word;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left-color: #48bb78;
            background: linear-gradient(135deg, rgba(72, 187, 120, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
        }

        .toast.error {
            border-left-color: #f56565;
            background: linear-gradient(135deg, rgba(245, 101, 101, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
        }

        .toast.info {
            border-left-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
        }

        .toast.warning {
            border-left-color: #ed8936;
            background: linear-gradient(135deg, rgba(237, 137, 54, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
        }

        .toast-content {
            flex: 1;
            margin-right: 12px;
            white-space: pre-line;
            font-weight: 500;
            color: #2d3748;
        }

        .toast-actions {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .toast-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #718096;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border-radius: 50%;
        }

        .toast-close:hover {
            color: #2d3748;
            background: rgba(0, 0, 0, 0.05);
        }

        .toast-cancel-btn {
            background: var(--danger-gradient);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(238, 90, 111, 0.3);
        }

        .toast-cancel-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(238, 90, 111, 0.4);
        }

        /* Á¶ÅÁî®Êï¥‰∏™È°µÈù¢ÁöÑÊ†∑Âºè */
        .page-disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .page-disabled .toast-container {
            pointer-events: auto;
            opacity: 1;
        }

        /* Êñá‰ª∂Ê†áÁ≠æÈ°µÊ†∑Âºè */
        .file-tabs-container {
            margin-bottom: 24px;
        }

        .file-tabs {
            display: flex;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.25);
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            padding: 4px 4px 0;
        }

        .file-tab {
            padding: 14px 24px;
            cursor: pointer;
            border: none;
            background: rgba(255, 255, 255, 0.25);
            font-size: 14px;
            color: #718096;
            border-bottom: 3px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            position: relative;
            min-width: 140px;
            text-align: center;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
            margin-right: 4px;
        }

        .file-tab:hover {
            background: rgba(102, 126, 234, 0.08);
            color: #4a5568;
        }

        .file-tab.active {
            background: white;
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
            box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.1);
        }

        .file-tab .file-name {
            font-weight: 600;
            margin-bottom: 4px;
            cursor: text;
            padding: 4px 8px;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
        }

        .file-tab .file-name:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .file-tab .file-name:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: -2px;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-tab .file-info {
            font-size: 12px;
            color: #a0aec0;
            white-space: nowrap;
        }
        .file-tab .file-config {
            margin-top: 6px;
        }
        .file-tab .constant-rows-input {
            width: 100%;
            padding: 10px 14px;
            font-size: 14px;
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: var(--radius-sm);
            background: rgba(255, 255, 255, 0.35);
            color: #4a5568;
            transition: all 0.3s ease;
            height: 42px;
            box-sizing: border-box;
        }
        .file-tab .constant-rows-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            color: #2d3748;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }
        .file-tab .constant-rows-input::placeholder {
            color: #a0aec0;
            font-style: italic;
        }

        .file-tab .close-tab {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--danger-gradient);
            color: white;
            border: none;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(238, 90, 111, 0.3);
        }

        .file-tab:hover .close-tab {
            opacity: 0.8;
        }

        .file-tab .close-tab:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .file-tab.active .close-tab {
            background: var(--danger-gradient);
        }

        .add-file-tab {
            padding: 14px 20px;
            cursor: pointer;
            border: 2px dashed rgba(102, 126, 234, 0.4);
            background: rgba(255, 255, 255, 0.25);
            color: var(--primary-color);
            border-radius: var(--radius-sm);
            margin: 8px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .add-file-tab:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: var(--primary-color);
            transform: translateY(-1px);
        }

        /* --- Â∏ÆÂä©ÊµÆÁ™óÊ†∑Âºè --- */
        .help-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            -webkit-animation-name: fadeIn;
            animation-name: fadeIn;
            -webkit-animation-duration: 0.3s;
            animation-duration: 0.3s;
        }
        .help-modal-content {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            margin: 5% auto;
            padding: 28px 36px;
            border: 1px solid rgba(255, 255, 255, 0.8);
            width: 80%;
            max-width: 800px;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            -webkit-animation-name: slideIn;
            animation-name: slideIn;
            -webkit-animation-duration: 0.3s;
            animation-duration: 0.3s;
        }
        .help-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        .help-modal-header h2 {
            margin: 0;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            font-size: 1.5rem;
        }
        .help-modal-close {
            color: #a0aec0;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        .help-modal-close:hover,
        .help-modal-close:focus {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }
        .help-modal-body {
            max-height: 60vh;
            overflow-y: auto;
            line-height: 1.7;
            color: #4a5568;
        }
        .help-modal-body h3 {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 24px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .help-modal-body h4 {
            color: #2d3748;
            margin-top: 16px;
            font-weight: 600;
        }
        .help-modal-body p {
            margin-bottom: 12px;
        }
        .help-modal-body code {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 3px 8px;
            border-radius: var(--radius-sm);
            font-family: 'SF Mono', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            color: var(--primary-color);
            font-weight: 500;
        }
        .help-modal-body ul {
            padding-left: 24px;
        }
        .help-modal-body li {
            margin-bottom: 10px;
        }
        .help-modal-body pre {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            padding: 16px;
            border-radius: var(--radius-md);
            border: 1px solid rgba(102, 126, 234, 0.1);
            overflow-x: auto;
        }

        @-webkit-keyframes fadeIn { from {opacity: 0} to {opacity: 1} }
        @keyframes fadeIn { from {opacity: 0} to {opacity: 1} }
        @-webkit-keyframes slideIn { from {top: -100px; opacity: 0} to {top: 0; opacity: 1} }
        @keyframes slideIn { from {margin-top: 0; opacity: 0} to {margin-top: 5%; opacity: 1} }

        /* Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÊ†∑Âºè */
        .time-series-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            -webkit-animation-name: fadeIn;
            animation-name: fadeIn;
            -webkit-animation-duration: 0.3s;
            animation-duration: 0.3s;
        }

        .time-series-modal-content {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            margin: 3% auto;
            padding: 28px 36px;
            border: 1px solid rgba(102, 126, 234, 0.1);
            width: 80%;
            max-width: 900px;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            -webkit-animation-name: slideIn;
            animation-name: slideIn;
            -webkit-animation-duration: 0.3s;
            animation-duration: 0.3s;
        }

        .time-series-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
            padding-bottom: 16px;
            margin-bottom: 24px;
        }

        .time-series-modal-header h3 {
            margin: 0;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            font-size: 1.4rem;
        }

        .time-series-modal-close {
            color: #a0aec0;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .time-series-modal-close:hover,
        .time-series-modal-close:focus {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .time-series-modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }

        .time-series-info {
            margin-bottom: 20px;
            padding: 16px 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            border-radius: var(--radius-md);
            font-size: 14px;
            color: #4a5568;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .time-series-info span {
            font-weight: 600;
            color: #2d3748;
        }

        .time-series-chart-container {
            position: relative;
            width: 100%;
            height: 400px;
            border: 1px solid rgba(102, 126, 234, 0.15);
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.35);
            box-shadow: var(--shadow-sm);
        }

        #timeSeriesChart {
            width: 100% !important;
            height: 100% !important;
        }

        /* ÂÖ®Â±ÄÊãñÊîæË¶ÜÁõñÂ±ÇÊ†∑Âºè */
        .global-drop-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(102, 126, 234, 0.15);
            backdrop-filter: blur(4px);
            z-index: 9998;
            display: none;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .global-drop-overlay.active {
            display: flex;
            pointer-events: auto;
        }

        .global-drop-overlay .drop-hint {
            background: var(--primary-gradient);
            color: white;
            padding: 40px 60px;
            border-radius: var(--radius-xl);
            font-size: 26px;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4);
            border: 3px dashed rgba(255, 255, 255, 0.6);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 16px 50px rgba(102, 126, 234, 0.5); }
            100% { transform: scale(1); box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4); }
        }

        .global-drop-overlay .drop-hint .drop-icon {
            font-size: 56px;
            margin-bottom: 20px;
            display: block;
        }

        /* ÂÖ®Â±ÄÊãñÊîæÊó∂‰∏ä‰º†Âå∫ÂüüÁöÑÁâπÊÆäÈ´ò‰∫Æ */
        .upload-section.global-drop-highlight {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%);
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.3);
            transform: scale(1.02);
            transition: all 0.3s ease;
        }

        /* Êó∂Èó¥Â∫èÂàóÁªüËÆ°‰ø°ÊÅØÊ†∑Âºè */
        .time-series-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
        }

        .time-series-stats div {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-sm);
            font-size: 13px;
        }

        /* ÂõæÁâáÊù•Ê∫êÊ†áÊ≥® */
        .bg-source {
            position: fixed;
            bottom: 12px;
            right: 12px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(0, 0, 0, 0.4);
            padding: 6px 12px;
            border-radius: 16px;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        .bg-source:hover {
            background: rgba(0, 0, 0, 0.6);
            color: rgba(255, 255, 255, 1);
        }
        .bg-source a {
            color: rgba(102, 200, 255, 0.9);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .bg-source a:hover {
            color: rgba(150, 220, 255, 1);
            text-decoration: underline;
        }

        /* ÂàáÊç¢ËÉåÊôØÊåâÈíÆ */
        .change-bg-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1001;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .change-bg-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }
        .change-bg-btn:active {
            transform: translateY(0);
        }

        /* ÂìçÂ∫îÂºè‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: 16px;
            }
            .container {
                padding: 20px;
                border-radius: var(--radius-lg);
            }
            h1 {
                font-size: 1.8rem;
            }
            .config-section {
                grid-template-columns: 1fr;
            }
            .controls {
                flex-direction: column;
                gap: 16px;
            }
            .progress-container {
                width: 100%;
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <script>
        // ËÉåÊôØÂõæÁâáÁÆ°ÁêÜ
        window.bgManager = (function() {
            // wallhaven Ëá™ÁÑ∂È£éÊôØÁ±ªÂõæÁâáÂ∫ì - SFW Â±±Â∑ùÈ£éÊôØ
            const landscapeImages = [
                { url: 'https://w.wallhaven.cc/full/96/wallhaven-96zjwk.jpg', id: '96zjwk' },
                { url: 'https://w.wallhaven.cc/full/eo/wallhaven-eododo.jpg', id: 'eododo' },
                { url: 'https://w.wallhaven.cc/full/4d/wallhaven-4dqlxo.jpg', id: '4dqlxo' },
                { url: 'https://w.wallhaven.cc/full/dp/wallhaven-dpm3jm.jpg', id: 'dpm3jm' },
                { url: 'https://w.wallhaven.cc/full/2k/wallhaven-2k7eg6.jpg', id: '2k7eg6' },
                { url: 'https://w.wallhaven.cc/full/lq/wallhaven-lq8prl.jpg', id: 'lq8prl' },
                { url: 'https://w.wallhaven.cc/full/49/wallhaven-49yx68.jpg', id: '49yx68' },
                { url: 'https://w.wallhaven.cc/full/3k/wallhaven-3kp7gy.jpg', id: '3kp7gy' },
                { url: 'https://w.wallhaven.cc/full/43/wallhaven-43lw73.jpg', id: '43lw73' },
                { url: 'https://w.wallhaven.cc/full/3k/wallhaven-3koke6.jpg', id: '3koke6' },
                { url: 'https://w.wallhaven.cc/full/0q/wallhaven-0qp1dd.jpg', id: '0qp1dd' },
                { url: 'https://w.wallhaven.cc/full/ym/wallhaven-ymelgd.jpg', id: 'ymelgd' },
                { url: 'https://w.wallhaven.cc/full/vg/wallhaven-vgo1yl.jpg', id: 'vgo1yl' },
                { url: 'https://w.wallhaven.cc/full/0q/wallhaven-0q1xod.jpg', id: '0q1xod' },
                { url: 'https://w.wallhaven.cc/full/48/wallhaven-48rz8j.jpg', id: '48rz8j' },
                { url: 'https://w.wallhaven.cc/full/yj/wallhaven-yjmmyd.jpg', id: 'yjmmyd' },
                { url: 'https://w.wallhaven.cc/full/4l/wallhaven-4lm8g2.jpg', id: '4lm8g2' },
                { url: 'https://w.wallhaven.cc/full/42/wallhaven-42re6g.jpg', id: '42re6g' },
                { url: 'https://w.wallhaven.cc/full/nz/wallhaven-nzokrv.jpg', id: 'nzokrv' },
                { url: 'https://w.wallhaven.cc/full/57/wallhaven-57qx51.jpg', id: '57qx51' },
                { url: 'https://w.wallhaven.cc/full/0j/wallhaven-0jej2y.jpg', id: '0jej2y' },
                { url: 'https://w.wallhaven.cc/full/4y/wallhaven-4y2l7l.jpg', id: '4y2l7l' },
                { url: 'https://w.wallhaven.cc/full/5d/wallhaven-5dwz67.jpg', id: '5dwz67' },
                { url: 'https://w.wallhaven.cc/full/57/wallhaven-57zey5.jpg', id: '57zey5' },
                { url: 'https://w.wallhaven.cc/full/r7/wallhaven-r77qrw.jpg', id: 'r77qrw' },
                { url: 'https://w.wallhaven.cc/full/4g/wallhaven-4gxpe7.jpg', id: '4gxpe7' },
                { url: 'https://w.wallhaven.cc/full/0w/wallhaven-0w7rz7.jpg', id: '0w7rz7' },
                { url: 'https://w.wallhaven.cc/full/95/wallhaven-95x3z1.jpg', id: '95x3z1' },
                { url: 'https://w.wallhaven.cc/full/md/wallhaven-md69y9.jpg', id: 'md69y9' },
                { url: 'https://w.wallhaven.cc/full/nm/wallhaven-nm7k3y.jpg', id: 'nm7k3y' },
                { url: 'https://w.wallhaven.cc/full/zy/wallhaven-zy79mj.jpg', id: 'zy79mj' },
                { url: 'https://w.wallhaven.cc/full/vm/wallhaven-vmz7rl.jpg', id: 'vmz7rl' },
                { url: 'https://w.wallhaven.cc/full/n6/wallhaven-n6g1dl.jpg', id: 'n6g1dl' },
                { url: 'https://w.wallhaven.cc/full/zm/wallhaven-zmjy8g.jpg', id: 'zmjy8g' },
                { url: 'https://w.wallhaven.cc/full/4o/wallhaven-4ork8m.jpg', id: '4ork8m' },
                { url: 'https://w.wallhaven.cc/full/d5/wallhaven-d5g373.jpg', id: 'd5g373' },
                { url: 'https://w.wallhaven.cc/full/rd/wallhaven-rd1vvq.jpg', id: 'rd1vvq' },
                { url: 'https://w.wallhaven.cc/full/6q/wallhaven-6qq3o7.jpg', id: '6qq3o7' },
                { url: 'https://w.wallhaven.cc/full/0w/wallhaven-0wg93q.jpg', id: '0wg93q' },
                { url: 'https://w.wallhaven.cc/full/v9/wallhaven-v9j5k8.jpg', id: 'v9j5k8' },
                { url: 'https://w.wallhaven.cc/full/vm/wallhaven-vmdz35.jpg', id: 'vmdz35' },
                { url: 'https://w.wallhaven.cc/full/7p/wallhaven-7pvkkv.jpg', id: '7pvkkv' },
                { url: 'https://w.wallhaven.cc/full/n6/wallhaven-n6rgqw.jpg', id: 'n6rgqw' },
                { url: 'https://w.wallhaven.cc/full/vg/wallhaven-vgv8q3.jpg', id: 'vgv8q3' },
                { url: 'https://w.wallhaven.cc/full/we/wallhaven-we7l5q.jpg', id: 'we7l5q' },
                { url: 'https://w.wallhaven.cc/full/kw/wallhaven-kwg657.jpg', id: 'kwg657' },
                { url: 'https://w.wallhaven.cc/full/gp/wallhaven-gpml53.jpg', id: 'gpml53' },
                { url: 'https://w.wallhaven.cc/full/qr/wallhaven-qr27rq.jpg', id: 'qr27rq' },
                { url: 'https://w.wallhaven.cc/full/6k/wallhaven-6k2xe6.jpg', id: '6k2xe6' },
                { url: 'https://w.wallhaven.cc/full/4l/wallhaven-4l3mr2.jpg', id: '4l3mr2' },
                { url: 'https://w.wallhaven.cc/full/28/wallhaven-28o93y.jpg', id: '28o93y' }
            ];

            let currentImageId = null;

            function loadRandomImage(attempts, excludeId) {
                if (attempts <= 0) {
                    console.warn('Êó†Ê≥ïÂä†ËΩΩËÉåÊôØÂõæÁâáÔºå‰ΩøÁî®ÈªòËÆ§ËÉåÊôØ');
                    document.body.style.setProperty('--bg-image', 'none');
                    updateSourceLink(null);
                    return;
                }

                // ËøáÊª§ÊéâÂΩìÂâçÂõæÁâáÔºåÈÅøÂÖçÈáçÂ§ç
                const availableImages = excludeId
                    ? landscapeImages.filter(img => img.id !== excludeId)
                    : landscapeImages;

                if (availableImages.length === 0) {
                    availableImages = landscapeImages;
                }

                const randomImage = availableImages[Math.floor(Math.random() * availableImages.length)];
                const img = new Image();

                img.onload = function() {
                    document.body.style.setProperty('--bg-image', `url('${randomImage.url}')`);
                    currentImageId = randomImage.id;
                    updateSourceLink(randomImage.id);
                };

                img.onerror = function() {
                    console.warn(`ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•: ${randomImage.url}ÔºåÂ∞ùËØï‰∏ã‰∏Ä‰∏™...`);
                    loadRandomImage(attempts - 1, excludeId);
                };

                img.src = randomImage.url;
            }

            function updateSourceLink(imageId) {
                const bgSourceLink = document.getElementById('bgSourceLink');
                if (bgSourceLink) {
                    if (imageId) {
                        bgSourceLink.href = `https://wallhaven.cc/w/${imageId}`;
                        bgSourceLink.textContent = `wallhaven.cc/w/${imageId}`;
                    } else {
                        bgSourceLink.href = 'https://wallhaven.cc';
                        bgSourceLink.textContent = 'wallhaven.cc';
                    }
                }
            }

            function changeBackground() {
                loadRandomImage(5, currentImageId);
            }

            // ÂàùÂßãÂåñÂä†ËΩΩ
            loadRandomImage(5);

            // Êö¥Èú≤ÂÖ¨ÂÖ±Êé•Âè£
            return {
                changeBackground: changeBackground
            };
        })();
    </script>
    <button class="change-bg-btn" onclick="window.bgManager.changeBackground()" title="ÂàáÊç¢ËÉåÊôØÂõæÁâá">üñºÔ∏è ÂàáÊç¢ËÉåÊôØ</button>
    <div class="toast-container" id="toastContainer"></div>

    <!-- ÂÖ®Â±ÄÊãñÊîæË¶ÜÁõñÂ±Ç -->
    <div class="global-drop-overlay" id="globalDropOverlay">
        <div class="drop-hint">
            <span class="drop-icon">üìÅ</span>
            ÊãñÊîæÂà∞‰ªªÊÑè‰ΩçÁΩÆ‰∏ä‰º†CSVÊñá‰ª∂
        </div>
    </div>

    <div class="container" id="mainContainer">
        <div class="main-title-container">
            <h1>CSVÂä®ÁîªÂØπÊØî</h1>
            <button class="btn btn-secondary" id="helpBtn">Â∏ÆÂä©</button>
        </div>
        <div class="version-info">‰ΩúËÄÖÔºö<a href="mailto:miboyu@yeah.net">Á±≥ÂçöÂÆá</a> | ÁâàÊú¨Ôºöv1.0.3</div>

        <div class="upload-section" id="uploadSection">
            <div class="upload-prompt" id="uploadPrompt">
                <p>ÊãñÊãΩCSVÊñá‰ª∂Âà∞Ê≠§Â§ÑÊàñ</p>
                <button class="upload-btn" id="initialUploadBtn">ÈÄâÊã©Êñá‰ª∂</button>
                <button class="upload-btn" id="addFileBtn" style="margin-left: 10px; display: none;">Ê∑ªÂä†Êñá‰ª∂</button>
            </div>

            <!-- Êñá‰ª∂Ê†áÁ≠æÈ°µÂÆπÂô® -->
            <div id="fileTabsContainer" class="file-tabs-container" style="display: none;">
                <div class="file-tabs" id="fileTabs"></div>
            </div>

            <div id="dataPreviewSection" class="data-preview-section hidden">
                <div class="data-preview-header">
                    <h3 id="fileName"></h3>
                    <div>
                        <button class="btn" id="refreshFileBtn">Âà∑Êñ∞Êñá‰ª∂</button>
                        <button class="btn" id="uploadBtn">Ê∑ªÂä†Êñá‰ª∂</button>
                        <button class="btn btn-danger" id="clearFilesBtn" style="display: none;">Ê∏ÖÈô§Êñá‰ª∂</button>
                    </div>
                </div>
                <div class="data-preview" id="dataPreview"></div>
            </div>
            <input type="file" id="fileInput" class="file-input" accept=".csv" multiple>
        </div>

        <div id="configSection" class="hidden">
            <div class="config-section">
                <div class="config-group">
                    <h3>Êï∞ÊçÆËÆæÁΩÆ</h3>
                    <div class="form-group">
                        <label for="xAxisRow">XËΩ¥Êï∞ÊçÆË°åÂè∑ÔºàÈªòËÆ§Á¨¨1Ë°åÔºâ</label>
                        <input type="number" id="xAxisRow" min="1" value="1" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="startRow">YËΩ¥Ëµ∑ÂßãË°åÔºàÈªòËÆ§XËΩ¥Ë°åÂè∑Âä†1Ôºâ</label>
                        <input type="number" id="startRow" min="1" value="2" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="endRow">YËΩ¥ÁªìÊùüË°åÔºàÈªòËÆ§ÊúÄÂêé‰∏ÄË°åÔºåË¥üÊï∞Ë°®Á§∫ÂÄíÊï∞Ôºâ</label>
                        <input type="number" id="endRow" value="-1" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="startCol">YËΩ¥Ëµ∑ÂßãÂàóÔºàÈªòËÆ§Á¨¨2ÂàóÔºâ</label>
                        <input type="number" id="startCol" min="1" value="2" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="endCol">YËΩ¥ÁªìÊùüÂàóÔºàÈªòËÆ§ÊúÄÂêé‰∏ÄÂàóÔºåË¥üÊï∞Ë°®Á§∫ÂÄíÊï∞Ôºâ</label>
                        <input type="number" id="endCol" value="-1" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="constantRows">Â∏∏ÊòæË°åÔºàÈªòËÆ§‰∏çÊòæÁ§∫Ôºâ</label>
                        <textarea id="constantRows"
                            placeholder="ËæìÂÖ•Ë¶ÅÂõ∫ÂÆöÊòæÁ§∫ÁöÑË°åÂè∑ÔºåÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÂ¶Ç: 3,5,7 Êàñ -1,-2 Ë°®Á§∫ÂÄíÊï∞ÔºåÂºÄÂêØÂêéÂ∞ÜËá™Âä®ÊâìÂºÄ<ÊòæÁ§∫Âõæ‰æã>ËÆæÁΩÆ„ÄÇÊèêÁ§∫ÔºöÂèØÂú®Êñá‰ª∂Ê†áÁ≠æÈ°µ‰∏≠‰∏∫Âçï‰∏™Êñá‰ª∂ÂçïÁã¨ËÆæÁΩÆÂ∏∏ÊòæË°å„ÄÇ" class="default-value"></textarea>
                    </div>
                </div>

                <div class="config-group">
                    <h3>Âä®ÁîªËÆæÁΩÆ</h3>
                    <div class="form-group">
                        <label for="frameInterval">Â∏ßÈó¥Èöî (ÊØ´Áßí)</label>
                        <input type="number" id="frameInterval" min="10" max="5000" value="50" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="skipFrames">Ë∑≥Â∏ßÊï∞ (0=‰∏çË∑≥Â∏ß)</label>
                        <input type="number" id="skipFrames" min="0" value="0" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="xMin">XËΩ¥ÊúÄÂ∞èÂÄº</label>
                        <input type="text" id="xMin" value="auto" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="xMax">XËΩ¥ÊúÄÂ§ßÂÄº</label>
                        <input type="text" id="xMax" value="auto" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="yMin">YËΩ¥ÊúÄÂ∞èÂÄº</label>
                        <input type="text" id="yMin" value="auto" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="yMax">YËΩ¥ÊúÄÂ§ßÂÄº</label>
                        <input type="text" id="yMax" value="auto" class="default-value">
                    </div>
                </div>

                <div class="config-group">
                    <h3>ÊòæÁ§∫ËÆæÁΩÆ</h3>
                    <div class="form-group">
                        <label for="showLegend">ÊòæÁ§∫Âõæ‰æã</label>
                        <select id="showLegend" class="default-value">
                            <option value="false">Âê¶</option>
                            <option value="true">ÊòØ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tooltipMode">ÊµÆÁ™óÊòæÁ§∫Ê®°Âºè</label>
                        <select id="tooltipMode" class="default-value">
                            <option value="compact" selected>Áº©Áï•ÊòæÁ§∫</option>
                            <option value="full">ÂÆåÊï¥ÊòæÁ§∫</option>
                            <option value="off">ÂÖ≥Èó≠ÊòæÁ§∫</option>
                        </select>
                    </div>
                        <div class="form-group">
                        <label for="xAxisType">XËΩ¥Á±ªÂûã</label>
                        <select id="xAxisType" class="default-value">
                            <option value="linear">Êï∞ÂÄº</option>
                            <option value="category">ÂàÜÁ±ª</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="chartTitle">Âä®ÁîªÊ†áÈ¢ò</label>
                        <input type="text" id="chartTitle" value="Êï∞ÊçÆÂä®Áîª" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="xAxisLabel">XËΩ¥Ê†áÁ≠æ</label>
                        <input type="text" id="xAxisLabel" value="XËΩ¥" class="default-value">
                    </div>
                    <div class="form-group">
                        <label for="yAxisLabel">YËΩ¥Ê†áÁ≠æ</label>
                        <input type="text" id="yAxisLabel" value="YËΩ¥" class="default-value">
                    </div>
                    </div>
            </div>

            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="btn" id="generateChartBtn">ÁîüÊàêÂä®Áîª</button>
                        <button class="btn" id="saveVideoBtn" disabled>‰øùÂ≠òËßÜÈ¢ë</button>
                        <select id="videoQuality" class="default-value" style="width: auto; min-width: 80px; text-align: center;">
                            <option value="low">Ê†áÊ∏Ö</option>
                            <option value="medium" selected>È´òÊ∏Ö</option>
                            <option value="high">Ë∂ÖÊ∏Ö</option>
                            <option value="ultra">2K</option>
                            <option value="extreme">4K</option>
                        </select>
                        <button class="btn btn-secondary" id="resetBtn">ÈáçÁΩÆËÆæÁΩÆ</button>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <select id="axisZoomTarget" title="ÈÄâÊã©Áº©ÊîæÁõÆÊ†á" class="default-value">
                            <option value="xy">XYËΩ¥ÂêåÊ≠•</option>
                            <option value="x">‰ªÖXËΩ¥</option>
                            <option value="y">‰ªÖYËΩ¥</option>
                        </select>
                        <button class="btn" id="axisZoomInBtn" title="ÊîæÂ§ßÂùêÊ†áËΩ¥ (+)" style="padding: 10px 15px; width: auto; min-width: 60px;">ÊîæÂ§ß</button>
                        <button class="btn" id="axisZoomOutBtn" title="Áº©Â∞èÂùêÊ†áËΩ¥ (-)" style="padding: 10px 15px; width: auto; min-width: 60px;">Áº©Â∞è</button>
                        <button class="btn btn-secondary" id="axisResetBtn" title="ÈáçÁΩÆÂùêÊ†áËΩ¥ (0)" style="padding: 10px 15px; width: auto; min-width: 60px;">ÈáçÁΩÆ</button>
                        <input type="range" id="axisZoomSlider" min="1" max="1000" value="100" step="1">
                        <input type="number" id="axisZoomInput" min="1" max="999999" value="100" step="1"
                               style="width: 70px; text-align: center;"
                               title="Áõ¥Êé•ËæìÂÖ•Áº©ÊîæÁôæÂàÜÊØî" class="default-value">
                        <span>%</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="chartSection" class="hidden">
            <div class="chart-container">
                <div id="chartContainer" style="width: 100%; height: 600px;"></div>
            </div>

            <div class="controls">
                <div class="control-buttons">
                    <button class="btn" id="playPauseBtn">Êí≠Êîæ</button>
                    <button class="btn" id="prevFrameBtn">‰∏ä‰∏ÄÂ∏ß</button>
                    <button class="btn" id="nextFrameBtn">‰∏ã‰∏ÄÂ∏ß</button>
                </div>
                <div class="progress-container" id="progressContainer">
                    <input type="range" class="progress" id="progressBar" min="0" max="100" value="0">
                </div>
                <div class="frame-info">
                    <span id="currentFrame">0</span> / <span id="totalFrames">0</span>
                </div>
            </div>

          </div>
    </div>

    <!-- Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó -->
    <div id="timeSeriesModal" class="time-series-modal">
        <div class="time-series-modal-content">
            <div class="time-series-modal-header">
                <h3 id="timeSeriesModalTitle">Êï∞ÊçÆÁÇπÊó∂Èó¥Â∫èÂàó</h3>
                <span class="time-series-modal-close" id="timeSeriesModalClose">&times;</span>
            </div>
            <div class="time-series-modal-body">
                <div class="time-series-info">
                    <div>ÁÇπÂáª‰ΩçÁΩÆ: <span id="clickedPosition"></span></div>
                    <div class="time-series-stats" id="timeSeriesStats" style="display: none;">
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-top: 10px;">
                            <div>ÊúÄÂ§ßÂÄº: <span id="statsMax" style="color: #e74c3c; font-weight: bold;"></span></div>
                            <div>ÊúÄÂ∞èÂÄº: <span id="statsMin" style="color: #27ae60; font-weight: bold;"></span></div>
                            <div>Âπ≥ÂùáÂÄº: <span id="statsAvg" style="color: #3498db; font-weight: bold;"></span></div>
                            <div>Ê†áÂáÜÂ∑Æ: <span id="statsStd" style="color: #9b59b6; font-weight: bold;"></span></div>
                            <div>Êï∞ÊçÆÁÇπÊï∞: <span id="statsCount" style="color: #34495e; font-weight: bold;"></span></div>
                            <div>ÂèòÂåñËåÉÂõ¥: <span id="statsRange" style="color: #f39c12; font-weight: bold;"></span></div>
                        </div>
                    </div>
                </div>
                <div class="time-series-chart-container">
                    <canvas id="timeSeriesChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div id="helpModal" class="help-modal">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h2>Â∏ÆÂä©ÊñáÊ°£</h2>
                <span class="help-modal-close" id="helpModalClose">&times;</span>
            </div>
            <div class="help-modal-body">
                <h3>Â∑•ÂÖ∑ÁÆÄ‰ªã</h3>
                <p><strong>CSVÂä®ÁîªÂØπÊØîÂ∑•ÂÖ∑</strong>ÊòØ‰∏Ä‰∏™‰∏ì‰∏öÁöÑÊï∞ÊçÆÂèØËßÜÂåñÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Â∞ÜCSVÊñá‰ª∂‰∏≠ÁöÑÊó∂Â∫èÊï∞ÊçÆËΩ¨Êç¢ÊàêÂä®ÊÄÅÁöÑÊäòÁ∫øÂõæÂä®ÁîªÔºåÊîØÊåÅÂ§öÊñá‰ª∂ÂØπÊØîÂàÜÊûêÔºåÂπ∂ÂèØÂ∞ÜÂä®ÁîªÂØºÂá∫‰∏∫È´òË¥®ÈáèËßÜÈ¢ëÊñá‰ª∂„ÄÇÂ∑•ÂÖ∑ÈõÜÊàê‰∫Ü‰∏∞ÂØåÁöÑ‰∫§‰∫íÂäüËÉΩÂíåÁªüËÆ°ÂàÜÊûêËÉΩÂäõÔºåÈùûÂ∏∏ÈÄÇÂêàÁßëÁ†î„ÄÅÂ∑•Á®ãÂíåÊï∞ÊçÆÂàÜÊûêÂú∫ÊôØ„ÄÇ</p>

                <h3>Êìç‰ΩúÊ≠•È™§</h3>
                <ol>
                    <li><b>‰∏ä‰º†Êñá‰ª∂Ôºö</b>ÁÇπÂáª"ÈÄâÊã©Êñá‰ª∂"ÊåâÈíÆÊàñÁõ¥Êé•Â∞ÜCSVÊñá‰ª∂ÊãñÊãΩÂà∞‰∏ä‰º†Âå∫Âüü„ÄÇÊîØÊåÅÂçïÊñá‰ª∂ÊàñÂ§öÊñá‰ª∂ÂêåÊó∂ÂØºÂÖ•„ÄÇ</li>
                    <li><b>ËÆæÁΩÆÂèÇÊï∞Ôºö</b>Êñá‰ª∂‰∏ä‰º†ÊàêÂäüÂêéÔºåÊ†πÊçÆÊÇ®ÁöÑÊï∞ÊçÆÊ†ºÂºèÂíåÈúÄÊ±ÇÔºåÂú®ËÆæÁΩÆÂå∫ÂüüÔºàÊï∞ÊçÆ„ÄÅÂä®Áîª„ÄÅÊòæÁ§∫Ôºâ‰∏≠ËÆæÁΩÆÂèÇÊï∞„ÄÇ</li>
                    <li><b>ÁîüÊàêÂä®ÁîªÔºö</b>ÁÇπÂáª"ÁîüÊàêÂä®Áîª"ÊåâÈíÆÔºåÁ≥ªÁªüÂ∞ÜÂàõÂª∫Â§öÊñá‰ª∂ÂØπÊØîÂõæË°®ÂíåÊéßÂà∂Èù¢Êùø„ÄÇ</li>
                    <li><b>Êí≠Êîæ‰∏éÈ¢ÑËßàÔºö</b>‰ΩøÁî®Êí≠Êîæ/ÊöÇÂÅú„ÄÅÂ∏ßÂØºËà™ÂíåËøõÂ∫¶Êù°Êù•È¢ÑËßàÂä®ÁîªÊïàÊûú„ÄÇ</li>
                    <li><b>Áº©Êîæ‰∏éÂàÜÊûêÔºö</b>‰ΩøÁî®Áº©ÊîæÊéß‰ª∂Êü•ÁúãÊï∞ÊçÆÁªÜËäÇÔºåÂèåÂáªÂõæË°®ËøõË°åÊó∂Èó¥Â∫èÂàóÂàÜÊûê„ÄÇ</li>
                    <li><b>‰øùÂ≠òËßÜÈ¢ëÔºö</b>ÂÖàÈÄâÊã©ËßÜÈ¢ëË¥®ÈáèÔºåÁÑ∂ÂêéÁÇπÂáª"‰øùÂ≠òËßÜÈ¢ë"ÊåâÈíÆÂØºÂá∫ÂÆåÊï¥ÁöÑÂä®ÁîªËßÜÈ¢ëÔºàÂåÖÂê´ÊâÄÊúâÊï∞ÊçÆÁ∫øÊù°Ôºâ„ÄÇ</li>
                </ol>

                <h3>Êñá‰ª∂Êìç‰ΩúËØ¥Êòé</h3>
                <h4>Êñá‰ª∂ÂØºÂÖ•ÊñπÂºè</h4>
                <p>Êú¨Â∑•ÂÖ∑ÊîØÊåÅÁÅµÊ¥ªÁöÑÊñá‰ª∂ÂØºÂÖ•ÊñπÂºèÔºåÊª°Ë∂≥‰∏çÂêå‰ΩøÁî®Âú∫ÊôØÔºö</p>
                <ul>
                    <li><b>ÊåâÈíÆÈÄâÊã©ÔºàÊé®ËçêÔºâÔºö</b>ÁÇπÂáª"ÈÄâÊã©Êñá‰ª∂"ÊåâÈíÆÔºåÈÄöËøáÊñá‰ª∂ÈÄâÊã©Âô®ÂØºÂÖ•Êñá‰ª∂„ÄÇÊîØÊåÅÂçïÊñá‰ª∂ÊàñÂ§öÊñá‰ª∂ÊâπÈáèÈÄâÊã©ÔºåËá™Âä®Ëé∑ÂèñÊåÅ‰πÖËÆøÈóÆÊùÉÈôêÔºåÂêéÁª≠Âà∑Êñ∞Êñá‰ª∂Êó∂Êó†ÈúÄÈáçÊñ∞ÈÄâÊã©„ÄÇ</li>
                    <li><b>ÊãñÊãΩÂØºÂÖ•Ôºö</b>Áõ¥Êé•Â∞ÜÂçï‰∏™ÊàñÂ§ö‰∏™CSVÊñá‰ª∂ÊãñÊãΩÂà∞‰∏ä‰º†Âå∫Âüü„ÄÇÊìç‰ΩúÁÆÄÂçïÂø´Êç∑ÔºåÊîØÊåÅÊâπÈáèÂØºÂÖ•Ôºå‰ΩÜÂà∑Êñ∞Êó∂ÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉ„ÄÇ</li>
                    <li><b>Êñá‰ª∂Ë∑ØÂæÑËÆ∞ÂøÜÔºö</b>Á≥ªÁªü‰ºöËÆ∞‰Ωè‰∏äÊ¨°ÊâìÂºÄÁöÑÊñá‰ª∂Ë∑ØÂæÑÔºå‰∏ãÊ¨°ÈÄâÊã©Êñá‰ª∂Êó∂ÈªòËÆ§ÊâìÂºÄËØ•ÁõÆÂΩïÔºåÊèêÂçáÊìç‰ΩúÊïàÁéá„ÄÇ</li>
                </ul>

                <h4>Êñá‰ª∂Âà∑Êñ∞ÂäüËÉΩ</h4>
                <p>ÂΩìÊÇ®ÁöÑCSVÊñá‰ª∂ÂÜÖÂÆπÊõ¥Êñ∞ÂêéÔºåÂèØ‰ª•‰ΩøÁî®"Âà∑Êñ∞Êñá‰ª∂"ÊåâÈíÆÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆÔºö</p>
                <ul>
                    <li><b>ÊâπÈáèÂà∑Êñ∞Ôºö</b>ÊîØÊåÅ‰∏ÄÈîÆÂà∑Êñ∞ÊâÄÊúâÂ∑≤ÂØºÂÖ•ÁöÑÊñá‰ª∂ÔºåËá™Âä®‰øùÊåÅÂΩìÂâçÁöÑËÆæÁΩÆ„ÄÇ</li>
                    <li><b>Êô∫ËÉΩÊùÉÈôêÁÆ°ÁêÜÔºö</b>Ê†πÊçÆÊñá‰ª∂ÂØºÂÖ•ÊñπÂºèËá™Âä®Â§ÑÁêÜÊùÉÈôêÈóÆÈ¢òÔºåÊåâÈíÆÂØºÂÖ•ÁöÑÊñá‰ª∂Áõ¥Êé•Âà∑Êñ∞ÔºåÊãñÊãΩÊñá‰ª∂ÊèêÁ§∫ÈáçÊñ∞ÊéàÊùÉ„ÄÇ</li>
                    <li><b>Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫Ôºö</b>È¢ÑËßàÁ™óÂè£ÊòæÁ§∫Êñá‰ª∂Â§ßÂ∞è„ÄÅË°åÊï∞ÂíåÂàóÊï∞ÔºåÂà∑Êñ∞Âêé‰ø°ÊÅØËá™Âä®Êõ¥Êñ∞„ÄÇ</li>
                    <li><b>ÈáçÂëΩÂêçÊîØÊåÅÔºö</b>Â¶ÇÊûúÂØπÊñá‰ª∂ËøõË°å‰∫ÜÈáçÂëΩÂêçÔºåÂà∑Êñ∞ÊèêÁ§∫‰∏≠‰ºöÊòæÁ§∫Êñ∞ÁöÑÊñá‰ª∂ÂêçÁß∞„ÄÇ</li>
                </ul>
                <p><b>ÊèêÁ§∫Ôºö</b>ÂØπ‰∫éÈúÄË¶ÅÈ¢ëÁπÅÊõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºåÂª∫ËÆÆ‰ΩøÁî®"ÈÄâÊã©Êñá‰ª∂"ÊåâÈíÆÂØºÂÖ•‰ª•Ëé∑ÂæóÊúÄ‰Ω≥ÁöÑÊó†ÁºùÂà∑Êñ∞‰ΩìÈ™å„ÄÇ</p>

                <h4>Êñá‰ª∂ÁÆ°ÁêÜÂäüËÉΩ</h4>
                <p>Â§öÊñá‰ª∂ÁéØÂ¢É‰∏ãÁöÑÊñá‰ª∂ÁÆ°ÁêÜÊìç‰ΩúÔºö</p>
                <ul>
                    <li><b>TabÊ†áÁ≠æÂàáÊç¢Ôºö</b>ÊØè‰∏™Êñá‰ª∂ÈÉΩÊúâÁã¨Á´ãÁöÑTabÊ†áÁ≠æÔºåÁÇπÂáªÂèØÂàáÊç¢Êü•Áúã‰∏çÂêåÊñá‰ª∂ÁöÑÈ¢ÑËßàÊï∞ÊçÆ„ÄÇ</li>
                    <li><b>Êñá‰ª∂ÈáçÂëΩÂêçÔºö</b>ÁÇπÂáªTabÊ†áÁ≠æÂèØ‰ª•Áõ¥Êé•ÁºñËæëÊñá‰ª∂ÂêçÔºåÈáçÂëΩÂêçÂêé‰ºöÂêåÊ≠•Êõ¥Êñ∞ÂõæË°®Âõæ‰æã„ÄÇ</li>
                    <li><b>Ê∑ªÂä†Êñá‰ª∂Ôºö</b>ÁÇπÂáª"Ê∑ªÂä†Êñá‰ª∂"ÊåâÈíÆÂèØ‰ª•ÁªßÁª≠ÂØºÂÖ•Êñ∞ÁöÑCSVÊñá‰ª∂ËøõË°åÂØπÊØîÂàÜÊûê„ÄÇ</li>
                    <li><b>Âà†Èô§Êñá‰ª∂Ôºö</b>ÁÇπÂáªTabÊ†áÁ≠æ‰∏äÁöÑ"√ó"ÊåâÈíÆÂèØ‰ª•Âà†Èô§Âçï‰∏™Êñá‰ª∂„ÄÇ</li>
                    <li><b>Ê∏ÖÈô§ÊâÄÊúâÊñá‰ª∂Ôºö</b>ÁÇπÂáª"Ê∏ÖÈô§Êñá‰ª∂"ÊåâÈíÆÂèØ‰ª•‰∏ÄÊ¨°ÊÄßÊ∏ÖÈô§ÊâÄÊúâÊñá‰ª∂ÔºåÈáçÁΩÆ‰∏∫ÂàùÂßãÁä∂ÊÄÅ„ÄÇ</li>
                </ul>

                <h4>ÊùÉÈôêËØ¥Êòé</h4>
                <p>‰∏∫‰∫Ü‰øùÊä§Áî®Êà∑ÈöêÁßÅÔºåÁé∞‰ª£ÊµèËßàÂô®ÂØπÊñá‰ª∂ËÆøÈóÆÊúâ‰∏•Ê†ºÁöÑÂÆâÂÖ®ÈôêÂà∂Ôºö</p>
                <ul>
                    <li><b>ÊåÅ‰πÖÊùÉÈôêÔºö</b>ÈÄöËøá"ÈÄâÊã©Êñá‰ª∂"ÊåâÈíÆÂØºÂÖ•Êó∂ÔºåÂ∑•ÂÖ∑‰ºöËØ∑Ê±ÇÊåÅ‰πÖËÆøÈóÆÊùÉÈôêÔºåËé∑ÂæóÊùÉÈôêÂêéÂèØ‰ª•ÈöèÊó∂ËØªÂèñÊñá‰ª∂„ÄÇ</li>
                    <li><b>‰∏¥Êó∂ÊùÉÈôêÔºö</b>ÊãñÊãΩÂØºÂÖ•ÁöÑÊñá‰ª∂Âè™ËÉΩËé∑Âæó‰∏¥Êó∂ËÆøÈóÆÊùÉÈôêÔºåÈ°µÈù¢Âà∑Êñ∞ÊàñÈáçÊñ∞ÊâìÂºÄÂêéÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉ„ÄÇ</li>
                    <li><b>ÊùÉÈôêËåÉÂõ¥Ôºö</b>ÊùÉÈôê‰ªÖÈôê‰∫éÊÇ®ÈÄâÊã©ÁöÑÁâπÂÆöÊñá‰ª∂ÔºåÂ∑•ÂÖ∑Êó†Ê≥ïËÆøÈóÆÂÖ∂‰ªñÊñá‰ª∂„ÄÇ</li>
                    <li><b>ÈªòËÆ§ÁõÆÂΩïÔºö</b>È¶ñÊ¨°ÈÄâÊã©Êñá‰ª∂Êó∂ÈªòËÆ§ÊâìÂºÄDownloadsÁõÆÂΩïÔºåÂêéÁª≠ËÆ∞‰Ωè‰∏äÊ¨°ÊâìÂºÄË∑ØÂæÑ„ÄÇ</li>
                </ul>

                <h3>CSVÊï∞ÊçÆÊ†ºÂºèË¶ÅÊ±Ç</h3>
                <p>‰∏∫‰∫ÜËÆ©Â∑•ÂÖ∑Ê≠£Á°ÆËß£ÊûêÔºåÊÇ®ÁöÑCSVÊñá‰ª∂ÈúÄË¶ÅÈÅµÂæ™‰ª•‰∏ãÊ†ºÂºèÔºö</p>
                <ul>
                    <li><b>XËΩ¥Êï∞ÊçÆÔºö</b>ÊâÄÊúâÊï∞ÊçÆÁÇπÂÖ±‰∫´ÁöÑXËΩ¥ÂùêÊ†áÂÄºÔºåÂøÖÈ°ªÂçïÁã¨ÊîæÂú®<b>‰∏ÄË°å</b>‰∏≠„ÄÇ‰æãÂ¶ÇÔºåÈ¢ëÁéá„ÄÅÊ≥¢ÈïøÁ≠â„ÄÇ</li>
                    <li><b>YËΩ¥Êï∞ÊçÆÔºö</b>ÊØè‰∏Ä<b>Ë°å</b>‰ª£Ë°®Âä®ÁîªÁöÑ‰∏ÄÂ∏ß„ÄÇË°å‰∏≠ÁöÑÊØè‰∏™ÂçïÂÖÉÊ†ºÊòØËØ•Â∏ßÂú®ÂØπÂ∫îXËΩ¥ÂùêÊ†á‰∏äÁöÑYÂÄº„ÄÇ</li>
                    <li><b>Ê†áÁ≠æ/Êó∂Èó¥ÂàóÔºö</b>Âª∫ËÆÆÊØèË°åÁöÑ<b>Á¨¨‰∏ÄÂàó</b>Áî®‰∫éÂ≠òÊîæËØ•Â∏ßÁöÑÊ†áËØÜÔºåÂ¶ÇÊó∂Èó¥Êà≥ÊàñÂêçÁß∞„ÄÇËøô‰∏™Ê†áËØÜ‰ºöÊòæÁ§∫Âú®Âä®ÁîªÊ†áÈ¢ò‰∏≠Ôºå‰ª•Âèä‰Ωú‰∏∫‚ÄúÂ∏∏ÊòæË°å‚ÄùÁöÑÂõæ‰æãÊ†áÁ≠æ„ÄÇ</li>
                </ul>
                <p><b>Á§∫‰æãÔºö</b></p>
                <pre><code>X-Axis, 1, 2, 3, 4, 5
Time_1, 10, 12, 15, 13, 11
Time_2, 11, 13, 14, 12, 10
Time_3, 12, 14, 13, 11, 9
...
Static_Line_A, 5, 5, 5, 5, 5
Static_Line_B, 15, 15, 15, 15, 15
</code></pre>
                <p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÁ¨¨‰∏ÄË°åÊòØXËΩ¥Êï∞ÊçÆÔºåÁ¨¨2-4Ë°åÊòØÂä®ÁîªÂ∏ßÊï∞ÊçÆÔºåÁ¨¨5-6Ë°åÊòØÂèØ‰ª•ËÆæÁΩÆ‰∏∫‚ÄúÂ∏∏ÊòæË°å‚ÄùÁöÑÈùôÊÄÅÊï∞ÊçÆ„ÄÇ</p>

                <h3>ËÆæÁΩÆËØ¶Ëß£</h3>
                <h4>Êï∞ÊçÆËÆæÁΩÆ</h4>
                <ul>
                    <li><b>XËΩ¥Êï∞ÊçÆË°åÂè∑Ôºö</b>ÊåáÂÆöÂì™‰∏ÄË°åÊòØXËΩ¥ÁöÑÂùêÊ†áÊï∞ÊçÆ„ÄÇ‰æãÂ¶ÇÔºåÁ§∫‰æã‰∏≠Â∫îÂ°´ <code>1</code>„ÄÇ</li>
                    <li><b>YËΩ¥Ëµ∑Âßã/ÁªìÊùüË°åÔºö</b>ÂÆö‰πâÂì™‰∫õË°åÁöÑÊï∞ÊçÆÁî®‰∫éÁîüÊàêÂä®ÁîªÂ∏ß„ÄÇ‰æãÂ¶ÇÔºåÁ§∫‰æã‰∏≠ÂèØÂ°´Ëµ∑Âßã <code>2</code>ÔºåÁªìÊùü <code>4</code>„ÄÇ</li>
                    <li><b>YËΩ¥Ëµ∑Âßã/ÁªìÊùüÂàóÔºö</b>ÂÆö‰πâ‰ªéÂì™‰∏ÄÂàóÂºÄÂßãËØªÂèñXÂíåYÁöÑÊï∞ÊçÆ„ÄÇÈÄöÂ∏∏‰ªéÁ¨¨2ÂàóÂºÄÂßãÔºåÂõ†‰∏∫Á¨¨1ÂàóÊòØÊ†áÁ≠æ„ÄÇ‰æãÂ¶ÇÔºåÁ§∫‰æã‰∏≠Â∫îÂ°´Ëµ∑Âßã <code>2</code>„ÄÇ</li>
                    <li><b>Ë¥üÊï∞Á¥¢ÂºïÔºö</b>Âú®"ÁªìÊùüË°å/Âàó"‰∏≠ÔºåÂèØ‰ª•‰ΩøÁî®Ë¥üÊï∞Ë°®Á§∫ÂÄíÊï∞„ÄÇ‰æãÂ¶ÇÔºå<code>-1</code> Ë°®Á§∫ÊúÄÂêé‰∏ÄË°å/ÂàóÔºå<code>-2</code> Ë°®Á§∫ÂÄíÊï∞Á¨¨‰∫åË°å/Âàó„ÄÇ</li>
                    <li><b>Â∏∏ÊòæË°åÔºö</b>ËæìÂÖ•ÊÇ®Â∏åÊúõÂú®Êï¥‰∏™Âä®Áîª‰∏≠ÈÉΩ‰øùÊåÅ‰∏çÂèòÁöÑÈùôÊÄÅÊï∞ÊçÆË°åÂè∑„ÄÇËøô‰∫õË°å‰ºö‰ª•ÁªÜÂÆûÁ∫øÁöÑÂΩ¢ÂºèÊòæÁ§∫‰Ωú‰∏∫ÂèÇËÄÉÁ∫ø„ÄÇÂ§ö‰∏™Ë°åÂè∑Áî®Ëã±ÊñáÈÄóÂè∑ <code>,</code> ÂàÜÈöîÔºåÊîØÊåÅË¥üÊï∞Á¥¢Âºï„ÄÇ‰æãÂ¶ÇÔºåÁ§∫‰æã‰∏≠ÂèØÂ°´ <code>5,6</code> Êàñ <code>-1,-2</code>„ÄÇ</li>
                    <li><b>Êñá‰ª∂Áã¨Á´ãÂ∏∏ÊòæË°åÔºö</b>Âú®Â§öÊñá‰ª∂Ê®°Âºè‰∏ãÔºåÂèØ‰ª•‰∏∫ÊØè‰∏™Êñá‰ª∂ÂçïÁã¨ËÆæÁΩÆÂ∏∏ÊòæË°å„ÄÇÊñá‰ª∂Áã¨Á´ãËÆæÁΩÆ‰ºòÂÖàÁ∫ßÈ´ò‰∫éÂÖ®Â±ÄËÆæÁΩÆ„ÄÇ</li>
                </ul>

                <h4>Âä®ÁîªËÆæÁΩÆ</h4>
                <ul>
                    <li><b>Â∏ßÈó¥Èöî (ÊØ´Áßí)Ôºö</b>ÊØè‰∏ÄÂ∏ßÁöÑÊí≠ÊîæÊó∂ÈïøÔºåÂçï‰ΩçÊòØÊØ´ÁßíÔºà1000ÊØ´Áßí = 1ÁßíÔºâ„ÄÇÊï∞ÂÄºË∂äÂ∞èÔºåÂä®ÁîªÊí≠ÊîæË∂äÂø´„ÄÇ</li>
                    <li><b>Ë∑≥Â∏ßÊï∞Ôºö</b>ËÆæÁΩÆÂä®ÁîªÊØèÈöîÂá†Â∏ßÊí≠Êîæ‰∏ÄÊ¨°„ÄÇ<code>0</code> Ë°®Á§∫‰∏çË∑≥Â∏ßÔºåÊí≠ÊîæÊâÄÊúâÂ∏ßÔºõ<code>1</code> Ë°®Á§∫ÊØèÈöî1Â∏ßÊí≠Êîæ1Ê¨°ÔºàÂç≥Êí≠ÊîæÁ¨¨1„ÄÅ3„ÄÅ5...Â∏ßÔºâÔºåÂèØ‰ª•Áî®‰∫éÊï∞ÊçÆÈáèÂ§ßÊó∂Âä†Âø´È¢ÑËßàÈÄüÂ∫¶„ÄÇ</li>
                    <li><b>X/YËΩ¥ÊúÄÂ∞èÂÄº/ÊúÄÂ§ßÂÄºÔºö</b>ÊâãÂä®ËÆæÂÆöÂùêÊ†áËΩ¥ÁöÑÊòæÁ§∫ËåÉÂõ¥„ÄÇÈªòËÆ§ÂÄº‰∏∫ <code>auto</code>ÔºåË°®Á§∫Ê†πÊçÆÊï∞ÊçÆËá™Âä®Ë∞ÉÊï¥„ÄÇÂ¶ÇÊûúÂä®ÁîªËøáÁ®ã‰∏≠Êï∞ÊçÆÊ≥¢Âä®ËåÉÂõ¥ÂèòÂåñÂæàÂ§ßÔºåÂª∫ËÆÆÊâãÂä®ËÆæÁΩÆ‰∏Ä‰∏™Âõ∫ÂÆöÁöÑËåÉÂõ¥‰ª•Ëé∑ÂæóÊõ¥Â•ΩÁöÑËßÜËßâÊïàÊûú„ÄÇ</li>
                </ul>

                <h4>ÊòæÁ§∫ËÆæÁΩÆ</h4>
                <ul>
                    <li><b>ÊòæÁ§∫Âõæ‰æãÔºö</b>ÊòØÂê¶Âú®ÂõæË°®‰∏äÊòæÁ§∫Âõæ‰æã„ÄÇÂ¶ÇÊûúËÆæÁΩÆ‰∫Ü"Â∏∏ÊòæË°å"ÔºåÂª∫ËÆÆÂºÄÂêØÊ≠§È°π‰ª•Âå∫ÂàÜ‰∏çÂêåÁöÑÊï∞ÊçÆÁ∫ø„ÄÇ</li>
                    <li><b>ÊµÆÁ™óÊòæÁ§∫Ê®°ÂºèÔºö</b>ÊéßÂà∂Èº†Ê†áÊÇ¨ÂÅúÂú®ÂõæË°®‰∏äÊó∂ÊòæÁ§∫ÁöÑÊï∞ÊçÆÊµÆÁ™óÔºö
                        <ul>
                            <li><b>Áº©Áï•ÊòæÁ§∫ÔºàÈªòËÆ§ÔºâÔºö</b>‰ªÖÊòæÁ§∫Êï∞ÊçÆÁÇπÁöÑYËΩ¥Êï∞ÂÄºÔºåÁïåÈù¢ÁÆÄÊ¥Å‰∏çÈÅÆÊå°Êï∞ÊçÆ„ÄÇ</li>
                            <li><b>ÂÆåÊï¥ÊòæÁ§∫Ôºö</b>ÊòæÁ§∫Êñá‰ª∂ÂêçÂíåÊï∞ÊçÆÂÄºÔºåÈÄÇÂêàÂ§öÊñá‰ª∂ÂØπÊØîÊó∂ËØÜÂà´Êï∞ÊçÆÊù•Ê∫ê„ÄÇ</li>
                            <li><b>ÂÖ≥Èó≠ÊòæÁ§∫Ôºö</b>ÂÆåÂÖ®‰∏çÊòæÁ§∫Êï∞ÊçÆÊµÆÁ™óÔºåËé∑ÂæóÊúÄÂπ≤ÂáÄÁöÑÂõæË°®ËßÜÂõæ„ÄÇ</li>
                        </ul>
                    </li>
                    <li><b>XËΩ¥Á±ªÂûãÔºö</b><code>Êï∞ÂÄº(linear)</code> Áî®‰∫éËøûÁª≠ÁöÑÊï∞Â≠óÂûãXËΩ¥Ôºõ<code>ÂàÜÁ±ª(category)</code> Áî®‰∫éÁ¶ªÊï£ÁöÑ„ÄÅÈùûÊï∞Â≠óÁöÑXËΩ¥Ê†áÁ≠æ„ÄÇ</li>
                    <li><b>Âä®ÁîªÊ†áÈ¢ò / XËΩ¥Ê†áÁ≠æ / YËΩ¥Ê†áÁ≠æÔºö</b>Ëá™ÂÆö‰πâÂõæË°®ÁöÑÊ†áÈ¢òÂíåÂùêÊ†áËΩ¥ÂêçÁß∞„ÄÇ</li>
                </ul>

                </ul>

                <h4>ËßÜÈ¢ëËÆæÁΩÆ</h4>
                <ul>
                    <li><b>ËßÜÈ¢ëË¥®ÈáèÔºö</b>ÈÄöËøá"‰øùÂ≠òËßÜÈ¢ë"ÊåâÈíÆÂè≥‰æßÁöÑ‰∏ãÊãâÊ°ÜÈÄâÊã©ËæìÂá∫ËßÜÈ¢ëË¥®ÈáèÔºö
                        <ul>
                            <li><b>Ê†áÊ∏Ö (480p)Ôºö</b>854√ó480 ÂÉèÁ¥†Ôºå1 MbpsÔºå30 fps - Êñá‰ª∂ÊúÄÂ∞èÔºåÈÄÇÂêàÂø´ÈÄüÈ¢ÑËßàÂíå‰ΩéÂ∏¶ÂÆΩÂú∫ÊôØ</li>
                            <li><b>È´òÊ∏Ö (720p)Ôºö</b>1280√ó720 ÂÉèÁ¥†Ôºå2.5 MbpsÔºå30 fps - Âπ≥Ë°°ÈÄâÊã©ÔºåÊé®ËçêÂ§ßÂ§öÊï∞Êó•Â∏∏‰ΩøÁî®</li>
                            <li><b>Ë∂ÖÊ∏Ö (1080p)Ôºö</b>1920√ó1080 ÂÉèÁ¥†Ôºå5 MbpsÔºå30 fps - Ê†áÂáÜÈ´òÊ∏ÖÔºåÈÄÇÂêàÊºîÁ§∫ÂíåÂàÜ‰∫´</li>
                            <li><b>2KÔºö</b>2560√ó1440 ÂÉèÁ¥†Ôºå8 MbpsÔºå30 fps - ÂáÜ2KÁîªË¥®ÔºåÈÄÇÂêàÈ´òË¥®ÈáèÂ±ïÁ§∫</li>
                            <li><b>4KÔºö</b>3840√ó2160 ÂÉèÁ¥†Ôºå15 MbpsÔºå30 fps - ÊúÄ‰Ω≥ÁîªË¥®ÔºåÈÄÇÂêà‰∏ì‰∏öÁî®ÈÄî</li>
                        </ul>
                    </li>
                    <li><b>‰øùÂ≠òËßÜÈ¢ëÔºö</b>ÂÆåÊàêÂä®ÁîªÁîüÊàêÂêéÔºåÁÇπÂáª"‰øùÂ≠òËßÜÈ¢ë"ÊåâÈíÆÔºåÁ≥ªÁªü‰ºö‰ΩøÁî®ÂΩìÂâçÈÄâÊã©ÁöÑËßÜÈ¢ëË¥®ÈáèËÆæÁΩÆÂØºÂá∫ÂÆåÊï¥ÁöÑÂä®ÁîªËßÜÈ¢ëÔºàÂåÖÂê´ÊâÄÊúâÊï∞ÊçÆÁ∫øÊù°Ôºâ„ÄÇ</li>
                </ul>

                <h3>Áº©Êîæ‰∏éÂπ≥ÁßªÊìç‰Ωú</h3>
                <p>ÂõæË°®ÁîüÊàêÂêéÔºåÊÇ®ÂèØ‰ª•ÈÄöËøáÂ§öÁßçÊñπÂºèË∞ÉÊï¥ËßÜÂõæËåÉÂõ¥‰ª•Êõ¥Â•ΩÂú∞Êü•ÁúãÊï∞ÊçÆÁªÜËäÇÔºö</p>
                <h4>Áº©ÊîæÊéßÂà∂</h4>
                <ul>
                    <li><b>Áº©ÊîæÁõÆÊ†áÈÄâÊã©Ôºö</b>ÂèØ‰ª•ÈÄâÊã©"XYËΩ¥ÂêåÊ≠•"„ÄÅ"‰ªÖXËΩ¥"Êàñ"‰ªÖYËΩ¥"‰Ωú‰∏∫Áº©ÊîæÂØπË±°ÔºåÈªòËÆ§‰∏∫XYËΩ¥ÂêåÊ≠•Áº©Êîæ„ÄÇ</li>
                    <li><b>Áº©ÊîæÊåâÈíÆÔºö</b>ËÆæÁΩÆÂå∫ÂüüÁöÑ"ÊîæÂ§ß"„ÄÅ"Áº©Â∞è"„ÄÅ"ÈáçÁΩÆ"ÊåâÈíÆÂèØ‰ª•Ë∞ÉÊï¥ÂùêÊ†áËΩ¥ËåÉÂõ¥„ÄÇÊåâÈíÆÊîØÊåÅÊúÄÂ§ß999999%Áº©Êîæ„ÄÇ</li>
                    <li><b>Áº©ÊîæÊªëÂùóÔºö</b>ÊãñÊãΩÊªëÂùóÂèØ‰ª•Á≤æÁ°ÆÊéßÂà∂Áº©ÊîæÁ∫ßÂà´Ôºà1%-1000%ÔºâÔºåÊªëÂùó‰ªÖÈôêÂà∂ÊªëÂä®Êìç‰Ωú„ÄÇ</li>
                    <li><b>Áº©ÊîæËæìÂÖ•Ê°ÜÔºö</b>Áõ¥Êé•ËæìÂÖ•Áº©ÊîæÁôæÂàÜÊØîÔºà1%-999999%ÔºâÔºåÊîØÊåÅ‰ªªÊÑèÁ≤æÁ°ÆÂÄºËÆæÁΩÆ„ÄÇ</li>
                    <li><b>Âø´Êç∑ÈîÆÔºö</b>Âú®ÂõæË°®ÊòæÁ§∫Êó∂ÔºåÊåâ<code>+</code>ÈîÆÊîæÂ§ßÔºåÊåâ<code>-</code>ÈîÆÁº©Â∞èÔºåÊåâ<code>0</code>ÈîÆÈáçÁΩÆËßÜÂõæ„ÄÇ</li>
                    <li><b>ÊªöËΩÆÁº©ÊîæÔºö</b>Âú®ÂõæË°®Âå∫ÂüüÊåâ‰Ωè<code>Ctrl</code>ÈîÆÔºàMac‰∏∫<code>Command</code>ÈîÆÔºâ+ ÊªöËΩÆÂêë‰∏äÊªöÂä®ÊîæÂ§ßÔºåÂêë‰∏ãÊªöÂä®Áº©Â∞è„ÄÇ</li>
                    <li><b>È°µÈù¢ÊªöÂä®Ôºö</b>Âú®ÂõæË°®Âå∫ÂüüÊ≠£Â∏∏‰ΩøÁî®Èº†Ê†áÊªöËΩÆÂèØ‰ª•ÊªöÂä®È°µÈù¢Ôºå‰∏ç‰ºöÂΩ±ÂìçÂõæË°®Áº©Êîæ„ÄÇ</li>
                    <li><b>‰øùÊåÅÊØî‰æãÔºö</b>XYËΩ¥ÂêåÊ≠•Áº©ÊîæÊó∂‰ºöËá™Âä®‰øùÊåÅXËΩ¥ÂíåYËΩ¥ÁöÑÂéüÂßãÊØî‰æãÔºåÁ°Æ‰øùÊï∞ÊçÆ‰∏ç‰ºöÂèòÂΩ¢„ÄÇ</li>
                    <li><b>Ëá™Âä®ËåÉÂõ¥Â§ÑÁêÜÔºö</b>ÂΩìYËΩ¥ËÆæÁΩÆ‰∏∫autoÊó∂ÔºåÁ≥ªÁªü‰ºöËÆ∞ÂΩïÂàùÂßãÊï∞ÊçÆËåÉÂõ¥‰Ωú‰∏∫Áº©ÊîæÈáçÁΩÆÂéüÁÇπ„ÄÇÊâãÂä®ËÆæÁΩÆ‰ºòÂÖàÁ∫ßÈ´ò‰∫éautoËÆæÁΩÆ„ÄÇ</li>
                </ul>
                <h4>Âπ≥ÁßªÊìç‰Ωú</h4>
                <ul>
                    <li><b>Èº†Ê†áÊãñÊãΩÔºö</b>Âú®ÂõæË°®Âå∫ÂüüÊåâ‰ΩèÈº†Ê†áÂ∑¶ÈîÆÂπ∂ÊãñÊãΩÔºåÂèØ‰ª•Âπ≥ÁßªËßÜÂõæÊü•Áúã‰∏çÂêåÂå∫ÂüüÁöÑÊï∞ÊçÆ„ÄÇ</li>
                </ul>
                <h4>Â∏ßÂØºËà™Êìç‰Ωú</h4>
                <ul>
                    <li><b>Â∑¶Âè≥ÊñπÂêëÈîÆÔºö</b>Êåâ<code>‚Üê</code>ÈîÆ‰∏ä‰∏ÄÂ∏ßÔºåÊåâ<code>‚Üí</code>ÈîÆ‰∏ã‰∏ÄÂ∏ß„ÄÇ</li>
                    <li><b>ÈïøÊåâÂØºËà™Ôºö</b>ÈïøÊåâ"‰∏ä‰∏ÄÂ∏ß"Êàñ"‰∏ã‰∏ÄÂ∏ß"ÊåâÈíÆ0.5ÁßíÂêéÂºÄÂßãËøûÁª≠Â∏ßÂàáÊç¢ÔºåÊØè100ÊØ´ÁßíÂàáÊç¢‰∏ÄÂ∏ß„ÄÇ</li>
                    <li><b>ÈïøÊåâÊñπÂêëÈîÆÔºö</b>ÈïøÊåâ<code>‚Üê</code>Êàñ<code>‚Üí</code>ÈîÆÂêåÊ†∑ÊîØÊåÅËøûÁª≠Â∏ßÂàáÊç¢ÂäüËÉΩ„ÄÇ</li>
                </ul>

                <h3>Êó∂Èó¥Â∫èÂàóÂàÜÊûêÂäüËÉΩ</h3>
                <p>Èô§‰∫ÜÂü∫Êú¨ÁöÑÂä®ÁîªÊí≠ÊîæÂ§ñÔºåÊú¨Â∑•ÂÖ∑ËøòÊèê‰æõ‰∫ÜÂº∫Â§ßÁöÑÊó∂Èó¥Â∫èÂàóÂàÜÊûêÂäüËÉΩÔºåËÆ©ÊÇ®ÂèØ‰ª•Ê∑±ÂÖ•ÂàÜÊûêÁâπÂÆöX‰ΩçÁΩÆÁöÑÊï∞ÊçÆÂèòÂåñË∂ãÂäøÂπ∂Ëé∑ÂæóËØ¶ÁªÜÁöÑÁªüËÆ°‰ø°ÊÅØ„ÄÇ</p>
                <h4>‰ΩøÁî®ÊñπÊ≥ï</h4>
                <ul>
                    <li><b>ÂèåÂáªËß¶ÂèëÔºö</b>Âú®Âä®ÁîªÊí≠ÊîæÊàñÊöÇÂÅúÁä∂ÊÄÅ‰∏ãÔºå<b>ÂèåÂáªÂõæË°®ÁªòÂõæÂå∫ÂüüÂÜÖÁöÑ‰ªªÊÑè‰ΩçÁΩÆ</b>ÔºåÁ≥ªÁªü‰ºöËá™Âä®ÊâæÂà∞ËØ•XÂùêÊ†áÊúÄÊé•ËøëÁöÑÊï∞ÊçÆÁÇπÂπ∂ÂºπÂá∫Êó∂Èó¥Â∫èÂàóÂàÜÊûêÊµÆÁ™ó„ÄÇ</li>
                    <li><b>Êü•ÁúãÊó∂Èó¥Â∫èÂàóÔºö</b>ÊµÆÁ™ó‰∏≠‰ºöÊòæÁ§∫ËØ•X‰ΩçÁΩÆÂú®ÊâÄÊúâÊó∂Èó¥Â∏ß‰∏≠ÁöÑÊï∞ÊçÆÂèòÂåñË∂ãÂäøÂõæÔºàXËΩ¥ÔºöÊó∂Èó¥ÔºåYËΩ¥ÔºöÊï∞ÂÄºÔºâÔºåÈááÁî®ÊäòÁ∫øÂõæÊòæÁ§∫„ÄÇ</li>
                    <li><b>ÁªüËÆ°‰ø°ÊÅØÔºö</b>ÊµÆÁ™ó‰ºöËá™Âä®ËÆ°ÁÆóÂπ∂ÊòæÁ§∫ËØ•Êó∂Èó¥Â∫èÂàóÁöÑËØ¶ÁªÜÁªüËÆ°‰ø°ÊÅØÔºåÂåÖÊã¨ÊúÄÂ§ßÂÄº„ÄÅÊúÄÂ∞èÂÄº„ÄÅÂπ≥ÂùáÂÄº„ÄÅÊ†áÂáÜÂ∑ÆÁ≠â„ÄÇ</li>
                    <li><b>ÂÖ≥Èó≠ÊµÆÁ™óÔºö</b>ÁÇπÂáªÊµÆÁ™óÂè≥‰∏äËßíÁöÑ"√ó"ÊåâÈíÆ„ÄÅÊåâEscÈîÆÊàñÁÇπÂáªÊµÆÁ™óÂ§ñÈÉ®Âå∫ÂüüÂùáÂèØÂÖ≥Èó≠Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó„ÄÇ</li>
                </ul>
                <h4>ÂäüËÉΩÁâπÁÇπ</h4>
                <ul>
                    <li><b>Êô∫ËÉΩÊï∞ÊçÆÊèêÂèñÔºö</b>Á≥ªÁªü‰ºöËá™Âä®‰ªéCSVÊï∞ÊçÆ‰∏≠ÊèêÂèñÂèåÂáª‰ΩçÁΩÆXÂùêÊ†áÂØπÂ∫îÁöÑÊâÄÊúâÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÔºåÊó†ÈúÄÁ≤æÁ°ÆÁÇπÂáªÊï∞ÊçÆÁ∫ø„ÄÇ</li>
                    <li><b>ÁªüËÆ°‰ø°ÊÅØÂàÜÊûêÔºö</b>Ëá™Âä®ËÆ°ÁÆó6È°πÂÖ≥ÈîÆÁªüËÆ°ÊåáÊ†áÔºåÂ∏ÆÂä©ÊÇ®Ê∑±ÂÖ•‰∫ÜËß£Êï∞ÊçÆÁâπÂæÅÔºö
                        <ul>
                            <li><span style="color: #e74c3c;">ÊúÄÂ§ßÂÄº</span> - Êï∞ÊçÆ‰∏≠ÁöÑÊúÄÂ§ßÂÄº</li>
                            <li><span style="color: #27ae60;">ÊúÄÂ∞èÂÄº</span> - Êï∞ÊçÆ‰∏≠ÁöÑÊúÄÂ∞èÂÄº</li>
                            <li><span style="color: #3498db;">Âπ≥ÂùáÂÄº</span> - Êï∞ÊçÆÁöÑÁÆóÊúØÂπ≥ÂùáÂÄº</li>
                            <li><span style="color: #9b59b6;">Ê†áÂáÜÂ∑Æ</span> - Êï∞ÊçÆÁ¶ªÊï£Á®ãÂ∫¶ÁöÑÂ∫¶Èáè</li>
                            <li><span style="color: #34495e;">Êï∞ÊçÆÁÇπÊï∞</span> - ÊúâÊïàÊï∞ÊçÆÁÇπÁöÑÊï∞Èáè</li>
                            <li><span style="color: #f39c12;">ÂèòÂåñËåÉÂõ¥</span> - ÊúÄÂ§ßÂÄº‰∏éÊúÄÂ∞èÂÄºÁöÑÂ∑Æ</li>
                        </ul>
                    </li>
                    <li><b>‰∫§‰∫íÂºèÂõæË°®Ôºö</b>Êó∂Èó¥Â∫èÂàóÂõæË°®ÊîØÊåÅÈº†Ê†áÊÇ¨ÂÅúÊü•ÁúãÂÖ∑‰ΩìÊï∞ÂÄºÔºå‰æø‰∫éÁ≤æÁ°ÆÂàÜÊûê„ÄÇÈªòËÆ§ÈááÁî®Áº©Áï•ÊòæÁ§∫Ê®°ÂºèÔºå‰ªÖÊòæÁ§∫Êï∞ÊçÆÂÄºÔºåÁïåÈù¢ÁÆÄÊ¥Å„ÄÇ</li>
                    <li><b>Âä®ÊÄÅÊ†áÈ¢òÔºö</b>ÊµÆÁ™óÊ†áÈ¢ò‰ºöÊòæÁ§∫XËΩ¥Ê†áÁ≠æÂíå‰ΩçÁΩÆÔºå‰æø‰∫éËØÜÂà´‰∏çÂêåÁöÑÊó∂Èó¥Â∫èÂàó„ÄÇ</li>
                    <li><b>Ëá™Âä®Êï∞ÊçÆËøáÊª§Ôºö</b>Á≥ªÁªü‰ºöËá™Âä®ËøáÊª§Êó†ÊïàÊï∞ÊçÆÔºànull„ÄÅundefined„ÄÅNaNÔºâÔºåÁ°Æ‰øùÁªüËÆ°ÁªìÊûúÁöÑÂáÜÁ°ÆÊÄß„ÄÇ</li>
                </ul>
                <h4>Â∫îÁî®Âú∫ÊôØ</h4>
                <ul>
                    <li><b>‰ø°Âè∑ÂàÜÊûêÔºö</b>ÂàÜÊûêÁâπÂÆöÈ¢ëÁéáÁöÑ‰ø°Âè∑Âº∫Â∫¶ÈöèÊó∂Èó¥ÂèòÂåñÔºåËØÜÂà´‰ø°Âè∑ÁâπÂæÅÂíåÂºÇÂ∏∏</li>
                    <li><b>ÂÖâË∞±Á†îÁ©∂Ôºö</b>ËßÇÂØüÊüê‰∏™Ê≥¢Èïø‰ΩçÁΩÆÁöÑÂÖâË∞±ÂèòÂåñË∂ãÂäøÔºåÂàÜÊûêÊùêÊñôÁâπÊÄß</li>
                    <li><b>Ê∏©Â∫¶ÁõëÊéßÔºö</b>ÁõëÊéßÁâπÂÆöÊ∏©Â∫¶ÁÇπÁöÑÂéÜÂè≤Êï∞ÊçÆÂèòÂåñÔºåËØÑ‰º∞Á≥ªÁªüÁ®≥ÂÆöÊÄß</li>
                    <li><b>Ë¥®ÈáèÊéßÂà∂Ôºö</b>ÂØπÊØî‰∏çÂêå‰ΩçÁΩÆÁöÑÊó∂Èó¥ÁâπÂæÅÔºåÂèëÁé∞Áîü‰∫ßËøáÁ®ã‰∏≠ÁöÑÂºÇÂ∏∏Ê®°Âºè</li>
                    <li><b>ÁßëÂ≠¶Á†îÁ©∂Ôºö</b>ÂàÜÊûêÂÆûÈ™åÊï∞ÊçÆ‰∏≠ÁâπÂÆöÂèÇÊï∞ÁöÑÊó∂Èó¥ÊºîÂåñËßÑÂæã</li>
                    <li><b>Â∑•Á®ãÁõëÊµãÔºö</b>ÁõëÊµãËÆæÂ§áËøêË°åÂèÇÊï∞ÁöÑÂèòÂåñË∂ãÂäøÔºåËøõË°åÈ¢ÑÊµãÊÄßÁª¥Êä§</li>
                </ul>

                <h3>ÁïåÈù¢ÁâπÊÄß</h3>
                <p>Êú¨Â∑•ÂÖ∑ÈááÁî®Áé∞‰ª£ÁéªÁíÉÊãüÊÄÅÔºàGlassmorphismÔºâËÆæËÆ°È£éÊ†ºÔºåÊèê‰æõ‰ºòÈõÖÁöÑËßÜËßâ‰ΩìÈ™åÔºö</p>
                <ul>
                    <li><b>Âä®ÊÄÅËÉåÊôØÂõæÁâáÔºö</b>ÂÜÖÁΩÆ 50 Âº†Á≤æÈÄâÁöÑËá™ÁÑ∂È£éÊôØÂ£ÅÁ∫∏ÔºåÊØèÊ¨°Âà∑Êñ∞È°µÈù¢Ëá™Âä®ÈöèÊú∫ÂàáÊç¢ÔºåËê•ÈÄ†ËàíÈÄÇÁöÑËßÜËßâÁéØÂ¢É„ÄÇ</li>
                    <li><b>ÂàáÊç¢ËÉåÊôØÊåâÈíÆÔºö</b>ÁÇπÂáªÈ°µÈù¢Âè≥‰∏äËßíÁöÑ"ÂàáÊç¢ËÉåÊôØ"ÊåâÈíÆÔºåÂèØÈöèÊó∂Êõ¥Êç¢ËÉåÊôØÂõæÁâáÔºà‰∏ç‰ºöÈáçÂ§çÊòæÁ§∫ÂΩìÂâçËÉåÊôØÔºâ„ÄÇ</li>
                    <li><b>ÁéªÁíÉÊãüÊÄÅËÆæËÆ°Ôºö</b>ÊâÄÊúâÂäüËÉΩÊ®°ÂùóÈááÁî®ÂçäÈÄèÊòéÊØõÁéªÁíÉÊïàÊûúÔºåËÉåÊôØÂõæÁâáÂèØËá™ÁÑ∂ÈÄèÂÖ•ÔºåÂ¢ûÂº∫ËßÜËßâÂ±ÇÊ¨°ÊÑü„ÄÇ</li>
                    <li><b>ÂõæÁâáÊù•Ê∫êÊ†áÊ≥®Ôºö</b>È°µÈù¢Âè≥‰∏ãËßíÊòæÁ§∫ÂΩìÂâçËÉåÊôØÂõæÁâáÁöÑÊù•Ê∫êÈìæÊé•ÔºåÁÇπÂáªÂèØË∑≥ËΩ¨Ëá≥ÂéüÂßãÂõæÁâáÈ°µÈù¢„ÄÇ</li>
                    <li><b>ÂìçÂ∫îÂºèÂ∏ÉÂ±ÄÔºö</b>ÁïåÈù¢Ëá™ÈÄÇÂ∫î‰∏çÂêåÂ±èÂπïÂ∞∫ÂØ∏ÔºåÊîØÊåÅÊ°åÈù¢„ÄÅÂπ≥ÊùøÂíåÁßªÂä®ËÆæÂ§á„ÄÇ</li>
                </ul>

                <h3>Âø´Êç∑ÈîÆÂèÇËÄÉ</h3>
                <ul>
                    <li><b>Á©∫Ê†ºÈîÆÔºö</b>Êí≠Êîæ/ÊöÇÂÅúÂä®Áîª</li>
                    <li><b>‚ÜêÈîÆÔºö</b>‰∏ä‰∏ÄÂ∏ßÔºàÊîØÊåÅÈïøÊåâËøûÁª≠ÂàáÊç¢Ôºâ</li>
                    <li><b>‚ÜíÈîÆÔºö</b>‰∏ã‰∏ÄÂ∏ßÔºàÊîØÊåÅÈïøÊåâËøûÁª≠ÂàáÊç¢Ôºâ</li>
                    <li><b>+ ÈîÆÔºö</b>ÊîæÂ§ßÂùêÊ†áËΩ¥</li>
                    <li><b>- ÈîÆÔºö</b>Áº©Â∞èÂùêÊ†áËΩ¥</li>
                    <li><b>0 ÈîÆÔºö</b>ÈáçÁΩÆÂùêÊ†áËΩ¥ËßÜÂõæ</li>
                    <li><b>Ctrl+ÊªöËΩÆÔºö</b>Âú®ÂõæË°®Âå∫ÂüüÊåâ‰ΩèCtrl+ÊªöËΩÆËøõË°åÁº©ÊîæÔºàMac‰∏∫Command+ÊªöËΩÆÔºâ</li>
                    <li><b>F1ÈîÆÔºö</b>ÊâìÂºÄÂ∏ÆÂä©Á™óÂè£</li>
                    <li><b>F5ÈîÆÔºö</b>Âà∑Êñ∞ÁΩëÈ°µÂπ∂ÂÆåÂÖ®ÈáçÁΩÆÊâÄÊúâÊï∞ÊçÆÔºàÊ∏ÖÈô§ÂõæË°®„ÄÅËÆæÁΩÆ„ÄÅÊñá‰ª∂ËÆ∞ÂΩïÁ≠âÔºâ</li>
                    <li><b>Ctrl+RÔºö</b>Âà∑Êñ∞ÂΩìÂâçÊñá‰ª∂ÔºàÈáçÊñ∞ËØªÂèñCSVÊï∞ÊçÆÔºå‰øùÊåÅËÆæÁΩÆ‰∏çÂèòÔºâ</li>
                    <li><b>Ctrl+OÔºö</b>ÊâìÂºÄÊñá‰ª∂ÈÄâÊã©Âô®ÔºàÂØºÂÖ•Êñ∞Êñá‰ª∂Ôºâ</li>
                    <li><b>EscÈîÆÔºö</b>ÂÖ≥Èó≠Â∏ÆÂä©Á™óÂè£ÂíåÊó∂Èó¥Â∫èÂàóÊµÆÁ™ó</li>
                </ul>

                <h4>ÈáçË¶ÅËØ¥Êòé</h4>
                <ul>
                    <li><b>F5 vs Ctrl+RÔºö</b>F5‰ºöÂÆåÂÖ®ÈáçÁΩÆÈ°µÈù¢Ôºå‰∏¢Â§±ÊâÄÊúâÂ∑•‰ΩúÔºõCtrl+RÂè™Âà∑Êñ∞Êñá‰ª∂Êï∞ÊçÆÔºå‰øùÊåÅÊÇ®ÁöÑËÆæÁΩÆ‰∏çÂèò„ÄÇ</li>
                    <li><b>ËæìÂÖ•Ê°Ü‰æãÂ§ñÔºö</b>ÊâÄÊúâÂø´Êç∑ÈîÆÂú®ËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•Êó∂ÈÉΩ‰∏ç‰ºöÁîüÊïàÔºåÈÅøÂÖçÂπ≤Êâ∞ÊñáÊú¨ÁºñËæë„ÄÇ</li>
                </ul>

                <h3>‰ΩúËÄÖ‰∏éÁâàÊú¨‰ø°ÊÅØ</h3>
                <ul>
                    <li><b>‰ΩúËÄÖÔºö</b>Á±≥ÂçöÂÆá</li>
                    <li><b>ÈÇÆÁÆ±Ôºö</b><a href="mailto:miboyu@yeah.net">miboyu@yeah.net</a></li>
                    <li><b>ÁâàÊú¨Ôºö</b>v1.0.3 (2025-01-30)</li>
                </ul>

                <h4>Êõ¥Êñ∞Êó•Âøó</h4>
                <ul>
                    <li><b>v1.0.3 (2025-01-30)Ôºö</b>UI ËßÜËßâÂçáÁ∫ß - Ê∑ªÂä† 50 Âº†Á≤æÈÄâËá™ÁÑ∂È£éÊôØËÉåÊôØÂ£ÅÁ∫∏ÔºåÂÆûÁé∞ÈöèÊú∫ËÉåÊôØÂõæÁâáÂàáÊç¢ÂäüËÉΩÔºõÊñ∞Â¢û"ÂàáÊç¢ËÉåÊôØ"ÊåâÈíÆÊîØÊåÅÊâãÂä®Êõ¥Êç¢ÔºõÈááÁî®ÁéªÁíÉÊãüÊÄÅÔºàGlassmorphismÔºâËÆæËÆ°È£éÊ†ºÔºå‰ºòÂåñÊï¥‰ΩìËßÜËßâÊïàÊûúÔºõÊ∑ªÂä†ÂõæÁâáÊù•Ê∫êÊ†áÊ≥®Ôºõ‰øÆÂ§çË°®Ê†ºË°®Â§¥ÂíåË°åÂè∑ÂàóÂú®ÊªöÂä®Êó∂ÁöÑÊñáÂ≠óÈáçÂè†ÈóÆÈ¢ò</li>
                    <li><b>v1.0.2 (2025-01-08)Ôºö</b>‰ºòÂåñ CDN Âä†ËΩΩÊú∫Âà∂ - ÂÆûÁé∞Â§ö CDN Ëá™Âä®ÂàáÊç¢Âä†ËΩΩÁ≥ªÁªüÔºàÊîØÊåÅ BootCDN„ÄÅStaticfile„ÄÅBaomitu Á≠âÂõΩÂÜÖ CDNÔºâÔºåÂΩªÂ∫ïËß£ÂÜ≥ÂõΩÂÜÖÁΩëÁªúÁéØÂ¢É‰∏ã Chart.js Â∫ìÂä†ËΩΩÂ§±Ë¥•ÈóÆÈ¢òÔºõÂ¢ûÂº∫ÈîôËØØËØäÊñ≠ÂäüËÉΩÔºåÊèê‰æõËØ¶ÁªÜÁöÑÂä†ËΩΩÁä∂ÊÄÅÊèêÁ§∫ÂíåËß£ÂÜ≥ÊñπÊ°à</li>
                    <li><b>v1.0.1 (2025-12-16)Ôºö</b>‰øÆÂ§ç Windows Âπ≥Âè∞ÂÖºÂÆπÊÄßÈóÆÈ¢ò - Â∞ÜÊâÄÊúâ‰ΩøÁî®Êâ©Â±ïËøêÁÆóÁ¨¶ÁöÑ Math.min/max Ë∞ÉÁî®Êîπ‰∏∫Âæ™ÁéØÂÆûÁé∞ÔºåËß£ÂÜ≥Â§ßÂûã CSV Êñá‰ª∂Âú® Windows ÊµèËßàÂô®‰∏≠Âõ†ÂèÇÊï∞Êï∞ÈáèÈôêÂà∂ÂØºËá¥ÁöÑ RangeError ÂºÇÂ∏∏</li>
                    <li><b>v1.0.0 (2025-09-25)Ôºö</b>Ê≠£ÂºèÂèëÂ∏ÉÁâàÊú¨ÔºåÂÆåÊï¥ÁöÑÂ§öÊñá‰ª∂ÂØπÊØî„ÄÅÊó∂Èó¥Â∫èÂàóÂàÜÊûê„ÄÅËßÜÈ¢ëÂØºÂá∫ÂäüËÉΩÔºåÊîØÊåÅÈ´òÁ∫ßÁº©ÊîæÁ≥ªÁªü„ÄÅÊµÆÁ™óÊòæÁ§∫Ê®°Âºè„ÄÅÊñá‰ª∂Ë∑ØÂæÑËÆ∞ÂøÜ„ÄÅÊâπÈáèÂà∑Êñ∞Á≠âÊ†∏ÂøÉÂäüËÉΩ</li>
                </ul>
                <footer>
                    <small>¬© 2025 Á±≥ÂçöÂÆá. ‰øùÁïôÊâÄÊúâÊùÉÂà©„ÄÇ</small><br/>
                    <small>ËÆ∏ÂèØÊù°Ê¨æÔºöÈô§ÈùûÂè¶ÊúâÂ£∞ÊòéÔºåÂê¶ÂàôÊú¨Â∑•ÂÖ∑ÂèäÂÖ∂‰ª£Á†ÅÂíåÂÜÖÂÆπÂèóÁâàÊùÉ‰øùÊä§ÔºåÊú™ÁªèÊéàÊùÉ‰∏çÂæóÂ§çÂà∂„ÄÅ‰øÆÊîπÊàñÂàÜÂèë„ÄÇ</small><br/>
                    <small>ÂÖçË¥£Â£∞ÊòéÔºöÊ≠§Â∑•ÂÖ∑‚ÄúÊåâÁé∞Áä∂‚ÄùÊèê‰æõÔºå‰∏ç‰Ωú‰ªª‰ΩïÊòéÁ§∫ÊàñÊöóÁ§∫‰øùËØÅÔºõ‰ΩúËÄÖ‰∏çÂØπ‰ΩøÁî®ÁªìÊûúÊâøÊãÖË¥£‰ªª„ÄÇ</small>
                </footer>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // === È°µÈù¢ÂàùÂßãÂåñÔºöÂÆåÂÖ®ÈáçÁΩÆÂà∞ÂàùÂßãÁä∂ÊÄÅ ===
            console.log('üîÑ È°µÈù¢Âä†ËΩΩÔºåÈáçÁΩÆÊâÄÊúâÁä∂ÊÄÅÂà∞ÂàùÂßãÂÄº');

            // Á°Æ‰øùbodyÂèØ‰ª•Ëé∑ÂæóÁÑ¶ÁÇπÔºåËøôÊòØÂø´Êç∑ÈîÆÊ≠£Â∏∏Â∑•‰ΩúÁöÑÂÖ≥ÈîÆ
            document.body.setAttribute('tabindex', '0');
            document.body.style.outline = 'none';

            // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁ´ãÂç≥Â∞ÜÁÑ¶ÁÇπËÆæÁΩÆÂà∞body
            window.addEventListener('load', () => {
                document.body.focus();
            });

            // ÂÖ®Â±ÄÁÇπÂáª‰∫ã‰ª∂ÔºöÁ°Æ‰øùÁÇπÂáªÈùûËæìÂÖ•ÂÖÉÁ¥†ÂêéÁÑ¶ÁÇπÂõûÂà∞body
            document.addEventListener('click', (e) => {
                // Â¶ÇÊûúÁÇπÂáªÁöÑ‰∏çÊòØËæìÂÖ•Á±ªÂÖÉÁ¥†Ôºå‰∏îÂΩìÂâçÁÑ¶ÁÇπ‰∏çÂú®ËæìÂÖ•Á±ªÂÖÉÁ¥†‰∏äÔºåÂàôÂ∞ÜÁÑ¶ÁÇπËÆæÁΩÆÂà∞body
                const activeElement = document.activeElement;
                const isInputElement = activeElement.tagName === 'INPUT' ||
                                     activeElement.tagName === 'TEXTAREA' ||
                                     activeElement.tagName === 'SELECT' ||
                                     activeElement.isContentEditable;

                const targetIsInput = e.target.tagName === 'INPUT' ||
                                    e.target.tagName === 'TEXTAREA' ||
                                    e.target.tagName === 'SELECT' ||
                                    e.target.isContentEditable;

                if (!targetIsInput && !isInputElement) {
                    // Âª∂Ëøü‰∏ÄÁÇπËÆæÁΩÆÁÑ¶ÁÇπÔºåÁ°Æ‰øù‰∏çÂΩ±ÂìçÊ≠£Â∏∏ÁöÑÁÇπÂáªË°å‰∏∫
                    setTimeout(() => {
                        document.body.focus();
                    }, 0);
                }
            });

            // ÂÖ®Â±ÄÂèòÈáè
            let csvData = [];
            let csvFiles = []; // Â≠òÂÇ®Â§ö‰∏™CSVÊñá‰ª∂Êï∞ÊçÆÔºåÊØè‰∏™Êñá‰ª∂ÂåÖÂê´: {file, data, fileName, displayName, fileHandle}
            let currentFileIndex = 0; // ÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñá‰ª∂Á¥¢Âºï
            let rememberedFileHandle = null; // ËÆ∞‰ΩèÁöÑÊñá‰ª∂Âè•ÊüÑ
            let rememberedFileDirectory = null; // ËÆ∞‰ΩèÁöÑÊñá‰ª∂ÁõÆÂΩïÁ±ªÂûã
            let lastOpenedFileHandle = null; // ËÆ∞ÂΩïÊúÄÂêé‰∏ÄÊ¨°ÊâìÂºÄÁöÑÊñá‰ª∂Âè•ÊüÑÔºåÁî®‰∫é‰∏ãÊ¨°ÊâìÂºÄÊó∂ÊÅ¢Â§çË∑ØÂæÑ
            let chart = null;
            let animationTimer = null;
            let currentFrameIndex = 0;
            let isPlaying = false;
            let frameData = [];
            let allFilesFrameData = []; // Â≠òÂÇ®ÊâÄÊúâÊñá‰ª∂ÁöÑÂ∏ßÊï∞ÊçÆ
            let constantRowsData = []; // Â≠òÂÇ®Â∏∏ÊòæË°åÊï∞ÊçÆÔºàÊù•Ëá™ÊâÄÊúâÊñá‰ª∂Ôºâ
            let csvFileName = ''; // Â≠òÂÇ®Êñá‰ª∂ÂêçÔºà‰∏çÂê´Êâ©Â±ïÂêçÔºâ
            let parseAbortController = null; // Áî®‰∫éÂèñÊ∂àÊñá‰ª∂Ëß£Êûê
            let isRecording = false; // ËßÜÈ¢ëÂΩïÂà∂Áä∂ÊÄÅ
            let recordingAbortController = null; // Áî®‰∫éÂèñÊ∂àÂΩïÂà∂
            let recordingToast = null; // ÂΩïÂà∂ËøõÂ∫¶ToastÁöÑÂºïÁî®

            // È°µÈù¢ÂÆåÂÖ®ÈáçÁΩÆÂáΩÊï∞
            function resetToInitialState() {
                console.log('üîÑ ÊâßË°åÂÆåÂÖ®ÈáçÁΩÆÂà∞ÂàùÂßãÁä∂ÊÄÅ');
                csvData = [];
                rememberedFileHandle = null;
                rememberedFileDirectory = null;
                lastOpenedFileHandle = null;
                chart = null;
                animationTimer = null;
                currentFrameIndex = 0;
                isPlaying = false;
                frameData = [];
                constantRowsData = [];
                csvFileName = '';
                parseAbortController = null;
                isRecording = false;
                recordingAbortController = null;
                recordingToast = null;

                // ÈáçÁΩÆÁº©ÊîæÁõ∏ÂÖ≥ÂèòÈáè
                axisZoomLevel = 1.0;
                xAxisZoomLevel = 1.0;
                yAxisZoomLevel = 1.0;
                axisPanOffset = { x: 0, y: 0 };
                originalAxisLimits = null;
                originalAxisRatio = null;
                isPanning = false;
                hasPanned = false;

                // ÈáçÁΩÆUIÁä∂ÊÄÅ
                uploadSection.classList.remove('has-file');
                uploadPrompt.classList.remove('hidden');
                dataPreviewSection.classList.add('hidden');
                configSection.classList.add('hidden');
                chartSection.classList.add('hidden');

                // Ê∏ÖÁ©∫È¢ÑËßàÊï∞ÊçÆ
                dataPreview.innerHTML = '';
                fileName.textContent = '';

                console.log('‚úÖ È°µÈù¢Áä∂ÊÄÅÂ∑≤ÂÆåÂÖ®ÈáçÁΩÆ');
            }

            // È°µÈù¢Âä†ËΩΩÊó∂‰∏çÊâßË°åÂÆåÂÖ®ÈáçÁΩÆÔºåËÆ©Áî®Êà∑ÂèØ‰ª•Ê≠£Â∏∏ÂØºÂÖ•Êñá‰ª∂
            // resetToInitialState();

            // ÂùêÊ†áËΩ¥Áº©ÊîæÁõ∏ÂÖ≥ÂèòÈáè
            let axisZoomLevel = 1.0; // ÂùêÊ†áËΩ¥Áº©ÊîæÁ∫ßÂà´ (1.0 = 100%)
            let xAxisZoomLevel = 1.0; // XËΩ¥Áã¨Á´ãÁº©ÊîæÁ∫ßÂà´
            let yAxisZoomLevel = 1.0; // YËΩ¥Áã¨Á´ãÁº©ÊîæÁ∫ßÂà´
            let axisPanOffset = { x: 0, y: 0 }; // ÂùêÊ†áËΩ¥Âπ≥ÁßªÂÅèÁßªÈáè
            let originalAxisLimits = null; // ÂéüÂßãÂùêÊ†áËΩ¥ËåÉÂõ¥
            let originalAxisRatio = null; // ÂéüÂßãÂùêÊ†áËΩ¥ÊØî‰æã (width/height)
            let isPanning = false; // ÊòØÂê¶Ê≠£Âú®Âπ≥Áßª
            let panStartPos = { x: 0, y: 0 }; // Âπ≥ÁßªËµ∑Âßã‰ΩçÁΩÆ
            let hasPanned = false; // ÊòØÂê¶Â∑≤ÁªèÂπ≥ÁßªËøá


            // ÈïøÊåâÁõ∏ÂÖ≥ÂèòÈáè
            let frameNavTimer = null; // Â∏ßÂØºËà™ÂÆöÊó∂Âô®

            // Ê£ÄÊµãÊñá‰ª∂ÁõÆÂΩïÁ±ªÂûã
            function detectFileDirectory(fileName) {
                if (!fileName) return 'documents';

                const lowerName = fileName.toLowerCase();

                // Ê£ÄÊü•ÂÆåÊï¥Ë∑ØÂæÑ‰∏≠ÁöÑÁõÆÂΩïÊèêÁ§∫ÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
                if (lowerName.includes('/users/') || lowerName.includes('\\users\\')) {
                    const pathParts = lowerName.split(/[/\\]/);

                    // Ê£ÄÊü•Áî®Êà∑ÁõÆÂΩï‰∏ãÁöÑÂ≠êÁõÆÂΩï
                    for (let i = 0; i < pathParts.length; i++) {
                        const part = pathParts[i];
                        if (part.includes('desktop') || part.includes('Ê°åÈù¢')) {
                            return 'desktop';
                        }
                        if (part.includes('download') || part.includes('‰∏ãËΩΩ')) {
                            return 'downloads';
                        }
                        if (part.includes('document') || part.includes('ÊñáÊ°£')) {
                            return 'documents';
                        }
                        if (part.includes('picture') || part.includes('ÂõæÁâá') || part.includes('image')) {
                            return 'pictures';
                        }
                        if (part.includes('video') || part.includes('ËßÜÈ¢ë') || part.includes('movie')) {
                            return 'videos';
                        }
                        if (part.includes('music') || part.includes('Èü≥‰πê') || part.includes('audio')) {
                            return 'music';
                        }
                    }
                }

                // Ê£ÄÊü•Êñá‰ª∂Âêç‰∏≠ÁöÑÁõÆÂΩïÊèêÁ§∫
                if (lowerName.includes('desktop') || lowerName.includes('Ê°åÈù¢')) {
                    return 'desktop';
                }
                if (lowerName.includes('download') || lowerName.includes('‰∏ãËΩΩ')) {
                    return 'downloads';
                }
                if (lowerName.includes('document') || lowerName.includes('ÊñáÊ°£')) {
                    return 'documents';
                }
                if (lowerName.includes('picture') || lowerName.includes('ÂõæÁâá') || lowerName.includes('image')) {
                    return 'pictures';
                }
                if (lowerName.includes('video') || lowerName.includes('ËßÜÈ¢ë') || lowerName.includes('movie')) {
                    return 'videos';
                }
                if (lowerName.includes('music') || lowerName.includes('Èü≥‰πê') || lowerName.includes('audio')) {
                    return 'music';
                }

                // Ê†πÊçÆÊñá‰ª∂ÂêçÊ®°ÂºèÊé®Êñ≠ÁõÆÂΩïÁ±ªÂûã
                const baseName = fileName.replace(/\.[^/.]+$/, "");

                // Â¶ÇÊûúÊñá‰ª∂ÂêçÂåÖÂê´ÂØºÂá∫„ÄÅÊï∞ÊçÆ„ÄÅÊä•ÂëäÁ≠âÂÖ≥ÈîÆËØçÔºåÂæàÂèØËÉΩÂú®‰∏ãËΩΩÊàñÊñáÊ°£ÁõÆÂΩï
                if (baseName.includes('export') || baseName.includes('ÂØºÂá∫') ||
                    baseName.includes('data') || baseName.includes('Êï∞ÊçÆ') ||
                    baseName.includes('report') || baseName.includes('Êä•Âëä') ||
                    baseName.includes('output') || baseName.includes('ËæìÂá∫') ||
                    baseName.includes('result') || baseName.includes('ÁªìÊûú')) {
                    // ‰ºòÂÖàËøîÂõû‰∏ãËΩΩÁõÆÂΩïÔºåÂõ†‰∏∫ÂØºÂá∫Êñá‰ª∂ÈÄöÂ∏∏ÂÖàÂú®‰∏ãËΩΩÁõÆÂΩï
                    return 'downloads';
                }

                // Â¶ÇÊûúÊñá‰ª∂ÂêçÂåÖÂê´È°πÁõÆ„ÄÅÂ∑•‰ΩúÁ≠âÂÖ≥ÈîÆËØçÔºåÂæàÂèØËÉΩÂú®ÊñáÊ°£ÁõÆÂΩï
                if (baseName.includes('project') || baseName.includes('È°πÁõÆ') ||
                    baseName.includes('work') || baseName.includes('Â∑•‰Ωú') ||
                    baseName.includes('task') || baseName.includes('‰ªªÂä°')) {
                    return 'documents';
                }

                // Â¶ÇÊûúÊñá‰ª∂ÂêçÂåÖÂê´‰∏¥Êó∂„ÄÅÊµãËØïÁ≠âÂÖ≥ÈîÆËØçÔºåÂèØËÉΩÂú®Ê°åÈù¢
                if (baseName.includes('temp') || baseName.includes('‰∏¥Êó∂') ||
                    baseName.includes('test') || baseName.includes('ÊµãËØï') ||
                    baseName.includes('demo') || baseName.includes('ÊºîÁ§∫')) {
                    return 'desktop';
                }

                // Ê†πÊçÆÊñá‰ª∂Êâ©Â±ïÂêçÊé®Êñ≠ÁõÆÂΩïÁ±ªÂûã
                if (lowerName.endsWith('.csv') || lowerName.endsWith('.xlsx') || lowerName.endsWith('.xls')) {
                    return 'documents'; // Êï∞ÊçÆÊñá‰ª∂ÈÄöÂ∏∏Âú®ÊñáÊ°£ÁõÆÂΩï
                }
                if (lowerName.endsWith('.jpg') || lowerName.endsWith('.jpeg') || lowerName.endsWith('.png') ||
                    lowerName.endsWith('.gif') || lowerName.endsWith('.bmp')) {
                    return 'pictures';
                }
                if (lowerName.endsWith('.mp4') || lowerName.endsWith('.avi') || lowerName.endsWith('.mov') ||
                    lowerName.endsWith('.wmv') || lowerName.endsWith('.flv')) {
                    return 'videos';
                }
                if (lowerName.endsWith('.mp3') || lowerName.endsWith('.wav') || lowerName.endsWith('.flac') ||
                    lowerName.endsWith('.aac')) {
                    return 'music';
                }

                // ÈªòËÆ§ËøîÂõûÊñáÊ°£ÁõÆÂΩï
                return 'documents';
            }

                  let frameNavDirection = 0; // Â∏ßÂØºËà™ÊñπÂêë (-1: ‰∏ä‰∏ÄÂ∏ß, 1: ‰∏ã‰∏ÄÂ∏ß, 0: Êó†)
            let longPressDelay = 500; // ÈïøÊåâÂª∂ËøüÊó∂Èó¥ÔºàÊØ´ÁßíÔºâ
            let frameNavInterval = 100; // Â∏ßÂØºËà™Èó¥ÈöîÊó∂Èó¥ÔºàÊØ´ÁßíÔºâ

            // Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÁõ∏ÂÖ≥ÂèòÈáè
            let timeSeriesChart = null; // Êó∂Èó¥Â∫èÂàóÂõæË°®ÂÆû‰æã
            let clickedDataPoint = null; // ÁÇπÂáªÁöÑÊï∞ÊçÆÁÇπ‰ø°ÊÅØ

            // ËÆ∞ÂΩïÂì™‰∫õÂ≠óÊÆµË¢´ÊâãÂä®‰øÆÊîπËøá
            let manuallyModified = new Set();

            // DOMÂÖÉÁ¥†
            const uploadSection = document.getElementById('uploadSection');
            const uploadPrompt = document.getElementById('uploadPrompt');
            const globalDropOverlay = document.getElementById('globalDropOverlay');
            const initialUploadBtn = document.getElementById('initialUploadBtn');
            const uploadBtn = document.getElementById('uploadBtn');
            const fileInput = document.getElementById('fileInput');
            const refreshFileBtn = document.getElementById('refreshFileBtn');
            const clearFilesBtn = document.getElementById('clearFilesBtn');
            const fileName = document.getElementById('fileName');
            const dataPreviewSection = document.getElementById('dataPreviewSection');
            const dataPreview = document.getElementById('dataPreview');
            const configSection = document.getElementById('configSection');

            // Êñá‰ª∂ÁÆ°ÁêÜÁõ∏ÂÖ≥ÂÖÉÁ¥†
            const addFileBtn = document.getElementById('addFileBtn');
            const fileTabsContainer = document.getElementById('fileTabsContainer');
            const fileTabs = document.getElementById('fileTabs');

            const generateChartBtn = document.getElementById('generateChartBtn');
            const saveVideoBtn = document.getElementById('saveVideoBtn');
            const resetBtn = document.getElementById('resetBtn');
            const chartSection = document.getElementById('chartSection');
            const chartContainer = document.getElementById('chartContainer');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const prevFrameBtn = document.getElementById('prevFrameBtn');
            const nextFrameBtn = document.getElementById('nextFrameBtn');
            const currentFrameSpan = document.getElementById('currentFrame');
            const totalFramesSpan = document.getElementById('totalFrames');
            const progressBar = document.getElementById('progressBar');
            const progressContainer = document.getElementById('progressContainer');
            const toastContainer = document.getElementById('toastContainer');
            const mainContainer = document.getElementById('mainContainer');

            // --- Â∏ÆÂä©ÊµÆÁ™óÂÖÉÁ¥† ---
            const helpBtn = document.getElementById('helpBtn');
            const helpModal = document.getElementById('helpModal');
            const helpModalClose = document.getElementById('helpModalClose');

            // Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÂÖÉÁ¥†
            const timeSeriesModal = document.getElementById('timeSeriesModal');
            const timeSeriesModalClose = document.getElementById('timeSeriesModalClose');
            const timeSeriesModalTitle = document.getElementById('timeSeriesModalTitle');
            const clickedPosition = document.getElementById('clickedPosition');
            const timeSeriesStats = document.getElementById('timeSeriesStats');
            const statsMax = document.getElementById('statsMax');
            const statsMin = document.getElementById('statsMin');
            const statsAvg = document.getElementById('statsAvg');
            const statsStd = document.getElementById('statsStd');
            const statsCount = document.getElementById('statsCount');
            const statsRange = document.getElementById('statsRange');
            const timeSeriesChartContainer = document.getElementById('timeSeriesChart');

            // ËÆæÁΩÆÂÖÉÁ¥†
            const xAxisRowInput = document.getElementById('xAxisRow');
            const startRowInput = document.getElementById('startRow');
            const endRowInput = document.getElementById('endRow');
            const startColInput = document.getElementById('startCol');
            const endColInput = document.getElementById('endCol');
            const constantRowsInput = document.getElementById('constantRows');
            const frameIntervalInput = document.getElementById('frameInterval');
            const skipFramesInput = document.getElementById('skipFrames');
            const xMinInput = document.getElementById('xMin');
            const xMaxInput = document.getElementById('xMax');
            const yMinInput = document.getElementById('yMin');
            const yMaxInput = document.getElementById('yMax');
            const showLegendSelect = document.getElementById('showLegend');
            const tooltipModeSelect = document.getElementById('tooltipMode');
            const xAxisTypeSelect = document.getElementById('xAxisType');
            const chartTitleInput = document.getElementById('chartTitle');
            const xAxisLabelInput = document.getElementById('xAxisLabel');
            const yAxisLabelInput = document.getElementById('yAxisLabel');

            // ËßÜÈ¢ëË¥®ÈáèËÆæÁΩÆÂÖÉÁ¥†
            const videoQualitySelect = document.getElementById('videoQuality');

            // ÂùêÊ†áËΩ¥Áº©ÊîæÊéßÂà∂ÂÖÉÁ¥†
            const axisZoomTarget = document.getElementById('axisZoomTarget');
            const axisZoomInBtn = document.getElementById('axisZoomInBtn');
            const axisZoomOutBtn = document.getElementById('axisZoomOutBtn');
            const axisResetBtn = document.getElementById('axisResetBtn');
            const axisZoomSlider = document.getElementById('axisZoomSlider');
            const axisZoomInput = document.getElementById('axisZoomInput');

            // --- Â∏ÆÂä©ÊµÆÁ™óÈÄªËæë ---
            helpBtn.onclick = function() {
                helpModal.style.display = "block";
            }
            helpModalClose.onclick = function() {
                helpModal.style.display = "none";
            }
            window.onclick = function(event) {
                if (event.target == helpModal) {
                    helpModal.style.display = "none";
                }
                if (event.target == timeSeriesModal) {
                    closeTimeSeriesModal();
                }
            }
            // Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó‰∫ã‰ª∂ÁõëÂê¨Âô®
            timeSeriesModalClose.onclick = function() {
                closeTimeSeriesModal();
            }

            window.onkeydown = function(event) {
                if (event.key === "Escape") {
                     helpModal.style.display = "none";
                     closeTimeSeriesModal();
                }

                // Ê£ÄÊü•ÊòØÂê¶Âú®ËæìÂÖ•Ê°Ü‰∏≠ÔºåÂ¶ÇÊûúÊòØÂàô‰∏çÂ§ÑÁêÜÂø´Êç∑ÈîÆ
                const activeElement = document.activeElement;
                const isInputElement = activeElement.tagName === 'INPUT' ||
                                     activeElement.tagName === 'TEXTAREA' ||
                                     activeElement.tagName === 'SELECT' ||
                                     activeElement.isContentEditable;

                // ÂÖ®Â±ÄÂø´Êç∑ÈîÆÔºà‰∏çÂú®ËæìÂÖ•Ê°Ü‰∏≠Êó∂ÁîüÊïàÔºâ
                if (!isInputElement) {
                    // F1 - ÊâìÂºÄÂ∏ÆÂä©
                    if (event.key === 'F1') {
                        event.preventDefault();
                        helpModal.style.display = "block";
                        return;
                    }

                    // F5 - Âà∑Êñ∞ÁΩëÈ°µÈáçÁΩÆ
                    if (event.key === 'F5') {
                        event.preventDefault();
                        if (confirm('Á°ÆÂÆöË¶ÅÂà∑Êñ∞È°µÈù¢Âπ∂ÈáçÁΩÆÊâÄÊúâÊï∞ÊçÆÂêóÔºü')) {
                            window.location.reload();
                        }
                        return;
                    }

                    // Ctrl+R - Âà∑Êñ∞ÂΩìÂâçÊñá‰ª∂
                    if (event.ctrlKey && event.key === 'r') {
                        event.preventDefault();
                        refreshCurrentFile();
                        return;
                    }

                    // Ctrl+O - ÊâìÂºÄÊñá‰ª∂ÈÄâÊã©Âô®
                    if (event.ctrlKey && event.key === 'o') {
                        event.preventDefault();
                        selectFileWithPermission();
                        return;
                    }
                }

                // Á©∫Ê†ºÈîÆÊí≠Êîæ/ÊöÇÂÅúÔºöÂè™Ë¶ÅÂõæË°®Â∑≤ÁîüÊàê‰∏î‰∏çÂú®ËæìÂÖ•Ê°Ü‰∏≠Â∞±ÁîüÊïà
                if (chart && !isInputElement && event.key === ' ') {
                    event.preventDefault();
                    togglePlayPause();
                }

                // Â∏ßÂØºËà™Âø´Êç∑ÈîÆÔºà‰ªÖÂú®ÂõæË°®ÊòæÁ§∫Êó∂ÁîüÊïà‰∏î‰∏çÂú®ËæìÂÖ•Ê°Ü‰∏≠Ôºâ
                if (!chartSection.classList.contains('hidden') && !isInputElement) {
                    switch(event.key) {
                        case 'ArrowLeft':
                            if (chart && !event.ctrlKey && !event.altKey) {
                                event.preventDefault();
                                // Â¶ÇÊûúÊ≠£Âú®Êí≠ÊîæÔºåÂÖàÊöÇÂÅú
                                if (isPlaying) {
                                    togglePlayPause();
                                }
                                navigateFrame(-1);
                            }
                            break;
                        case 'ArrowRight':
                            if (chart && !event.ctrlKey && !event.altKey) {
                                event.preventDefault();
                                // Â¶ÇÊûúÊ≠£Âú®Êí≠ÊîæÔºåÂÖàÊöÇÂÅú
                                if (isPlaying) {
                                    togglePlayPause();
                                }
                                navigateFrame(1);
                            }
                            break;
                        case '+':
                        case '=':
                            if (chart && !event.ctrlKey && !event.altKey) {
                                event.preventDefault();
                                axisZoomIn();
                            }
                            break;
                        case '-':
                        case '_':
                            if (chart && !event.ctrlKey && !event.altKey) {
                                event.preventDefault();
                                axisZoomOut();
                            }
                            break;
                        case '0':
                            if (chart && !event.ctrlKey && !event.altKey) {
                                event.preventDefault();
                                resetAxisZoom();
                            }
                            break;
                    }
                }
            }
            // ToastÈÄöÁü•Á≥ªÁªü
            function showToast(message, type = 'info', options = {}) {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;

                const content = document.createElement('div');
                content.className = 'toast-content';
                content.innerHTML = message;

                const actions = document.createElement('div');
                actions.className = 'toast-actions';

                // Ê∑ªÂä†ÂèñÊ∂àÊåâÈíÆÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ
                if (options.showCancel && options.onCancel) {
                    const cancelBtn = document.createElement('button');
                    cancelBtn.className = 'toast-cancel-btn';
                    cancelBtn.textContent = options.cancelText || 'ÂèñÊ∂à';
                    cancelBtn.onclick = () => {
                        options.onCancel();
                        removeToast(toast);
                    };
                    actions.appendChild(cancelBtn);
                }

                // Ê∑ªÂä†ÂÖ≥Èó≠ÊåâÈíÆ
                if (!options.persistent) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'toast-close';
                    closeBtn.innerHTML = '√ó';
                    closeBtn.onclick = () => removeToast(toast);
                    actions.appendChild(closeBtn);
                }

                toast.appendChild(content);
                toast.appendChild(actions);
                toast.contentElement = content; // ‰øùÂ≠òcontentÂÖÉÁ¥†ÁöÑÂºïÁî®‰ª•‰æøÊõ¥Êñ∞
                toast.actionsElement = actions; // ‰øùÂ≠òactionsÂÖÉÁ¥†ÁöÑÂºïÁî®‰ª•‰æøÊõ¥Êñ∞
                toastContainer.appendChild(toast);

                // Ëß¶ÂèëÊòæÁ§∫Âä®Áîª
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);

                // Ëá™Âä®ÁßªÈô§ÔºàÈô§ÈùûÊòØÊåÅ‰πÖÁöÑÔºâ
                if (!options.persistent) {
                    setTimeout(() => {
                        removeToast(toast);
                    }, options.duration || 3000);
                }

                return toast;
            }

            // Êõ¥Êñ∞ToastÂÜÖÂÆπ
            function updateToast(toast, message, options = {}) {
                if (toast && toast.contentElement) {
                    toast.contentElement.innerHTML = message;

                    // Êõ¥Êñ∞ÂèñÊ∂àÊåâÈíÆÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ
                    if (options.showCancel !== undefined) {
                        const existingCancelBtn = toast.actionsElement.querySelector('.toast-cancel-btn');

                        if (options.showCancel && options.onCancel) {
                            if (!existingCancelBtn) {
                                const cancelBtn = document.createElement('button');
                                cancelBtn.className = 'toast-cancel-btn';
                                cancelBtn.textContent = options.cancelText || 'ÂèñÊ∂à';
                                cancelBtn.onclick = () => {
                                    options.onCancel();
                                    removeToast(toast);
                                };
                                // ÊèíÂÖ•Âà∞ÂÖ≥Èó≠ÊåâÈíÆ‰πãÂâç
                                const closeBtn = toast.actionsElement.querySelector('.toast-close');
                                if (closeBtn) {
                                    toast.actionsElement.insertBefore(cancelBtn, closeBtn);
                                } else {
                                    toast.actionsElement.appendChild(cancelBtn);
                                }
                            } else {
                                existingCancelBtn.textContent = options.cancelText || 'ÂèñÊ∂à';
                                existingCancelBtn.onclick = () => {
                                    options.onCancel();
                                    removeToast(toast);
                                };
                            }
                        } else if (existingCancelBtn) {
                            existingCancelBtn.remove();
                        }
                    }
                }
            }

            function removeToast(toast) {
                if (toast && toast.parentNode) {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }
            }

            function clearToasts() {
                const toasts = toastContainer.querySelectorAll('.toast');
                toasts.forEach(removeToast);
            }

            // Ê∑ªÂä†ËæìÂÖ•‰∫ã‰ª∂ÁõëÂê¨Âô®Êù•ÂàáÊç¢Ê†∑Âºè
            function addInputListener(element, fieldName) {
                element.addEventListener('input', function() {
                    // Âè™Âú®ËæìÂÖ•ËøáÁ®ã‰∏≠Ê†áËÆ∞‰∏∫ÊâãÂä®‰øÆÊîπÔºå‰∏çÂº∫Âà∂Â°´ÂÖÖÈªòËÆ§ÂÄº
                    manuallyModified.add(fieldName);
                    element.classList.remove('default-value');
                    element.classList.add('manual-value');

                    // ÁâπÊÆäÂ§ÑÁêÜÔºöÂ∏∏ÊòæË°åÊîπÂèòÊó∂Ëá™Âä®Ë∞ÉÊï¥ÊòæÁ§∫Âõæ‰æã
                    if (fieldName === 'constantRows') {
                        updateLegendDisplay();
                    }
                });

                // Â§±ÂéªÁÑ¶ÁÇπÊó∂Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊÅ¢Â§çÈªòËÆ§ÂÄº
                element.addEventListener('blur', function() {
                    if (element.value.trim() === '') {
                        // Ë∞ÉÁî®Áõ∏Â∫îÁöÑÊõ¥Êñ∞ÂáΩÊï∞Êù•ÊÅ¢Â§çÂä®ÊÄÅÈªòËÆ§ÂÄº
                        restoreDefaultValue(fieldName);
                        manuallyModified.delete(fieldName);
                    }
                });

                // ÂØπ‰∫éÂ∏∏ÊòæË°åËæìÂÖ•Ê°ÜÔºåËøòÈúÄË¶ÅÁõëÂê¨change‰∫ã‰ª∂
                if (fieldName === 'constantRows') {
                    element.addEventListener('change', function() {
                        updateLegendDisplay();
                    });
                }
            }

            // Ê†πÊçÆÂ≠óÊÆµÂêçÊÅ¢Â§çÂØπÂ∫îÁöÑÂä®ÊÄÅÈªòËÆ§ÂÄº
            function restoreDefaultValue(fieldName) {
                switch(fieldName) {
                    case 'xMin':
                    case 'xMax':
                        updateXAxisRange();
                        break;
                    case 'xAxisLabel':
                        updateXAxisLabel();
                        break;
                    case 'chartTitle':
                        chartTitleInput.value = csvFileName || 'Êï∞ÊçÆÂä®Áîª';
                        chartTitleInput.classList.remove('manual-value');
                        chartTitleInput.classList.add('default-value');
                        break;
                    case 'yAxisLabel':
                        yAxisLabelInput.value = 'YËΩ¥';
                        yAxisLabelInput.classList.remove('manual-value');
                        yAxisLabelInput.classList.add('default-value');
                        break;
                    // ÂÖ∂‰ªñÂõ∫ÂÆöÈªòËÆ§ÂÄºÁöÑÂ≠óÊÆµ
                    case 'xAxisRow':
                        xAxisRowInput.value = '1';
                        xAxisRowInput.classList.remove('manual-value');
                        xAxisRowInput.classList.add('default-value');
                        break;
                    case 'startRow':
                        const defaultStartRow = (parseInt(xAxisRowInput.value) || 1) + 1;
                        startRowInput.value = defaultStartRow.toString();
                        startRowInput.classList.remove('manual-value');
                        startRowInput.classList.add('default-value');
                        break;
                    case 'endRow':
                        endRowInput.value = '-1';
                        endRowInput.classList.remove('manual-value');
                        endRowInput.classList.add('default-value');
                        break;
                    case 'startCol':
                        startColInput.value = '2';
                        startColInput.classList.remove('manual-value');
                        startColInput.classList.add('default-value');
                        break;
                    case 'endCol':
                        endColInput.value = '-1';
                        endColInput.classList.remove('manual-value');
                        endColInput.classList.add('default-value');
                        break;
                    case 'constantRows':
                        constantRowsInput.value = '';
                        constantRowsInput.classList.remove('manual-value');
                        constantRowsInput.classList.add('default-value');
                        updateLegendDisplay();
                        break;
                    case 'frameInterval':
                        frameIntervalInput.value = '50';
                        frameIntervalInput.classList.remove('manual-value');
                        frameIntervalInput.classList.add('default-value');
                        break;
                    case 'skipFrames':
                        skipFramesInput.value = '0';
                        skipFramesInput.classList.remove('manual-value');
                        skipFramesInput.classList.add('default-value');
                        break;
                    case 'yMin':
                        yMinInput.value = 'auto';
                        yMinInput.classList.remove('manual-value');
                        yMinInput.classList.add('default-value');
                        break;
                    case 'yMax':
                        yMaxInput.value = 'auto';
                        yMaxInput.classList.remove('manual-value');
                        yMaxInput.classList.add('default-value');
                        break;
                    case 'showLegend':
                        showLegendSelect.value = 'false';
                        showLegendSelect.classList.remove('manual-value');
                        showLegendSelect.classList.add('default-value');
                        break;
                    case 'tooltipMode':
                        tooltipModeSelect.value = 'compact';
                        tooltipModeSelect.classList.remove('manual-value');
                        tooltipModeSelect.classList.add('default-value');
                        break;
                    case 'xAxisType':
                        xAxisTypeSelect.value = 'linear';
                        xAxisTypeSelect.classList.remove('manual-value');
                        xAxisTypeSelect.classList.add('default-value');
                        break;
                    case 'videoQuality':
                        videoQualitySelect.value = 'medium';
                        videoQualitySelect.classList.remove('manual-value');
                        videoQualitySelect.classList.add('default-value');
                        break;
                    case 'axisZoomTarget':
                        axisZoomTarget.value = 'xy';
                        axisZoomTarget.classList.remove('manual-value');
                        axisZoomTarget.classList.add('default-value');
                        break;
                    case 'axisZoomInput':
                        axisZoomInput.value = '100';
                        axisZoomInput.classList.remove('manual-value');
                        axisZoomInput.classList.add('default-value');
                        axisZoomSlider.value = '100';
                        break;
                }
            }

            // ‰∏∫ÊâÄÊúâËÆæÁΩÆÂ≠óÊÆµÊ∑ªÂä†ÁõëÂê¨Âô®
            addInputListener(xAxisRowInput, 'xAxisRow');
            addInputListener(startRowInput, 'startRow');
            addInputListener(endRowInput, 'endRow');
            addInputListener(startColInput, 'startCol');
            addInputListener(endColInput, 'endCol');
            addInputListener(constantRowsInput, 'constantRows');
            addInputListener(frameIntervalInput, 'frameInterval');
            addInputListener(skipFramesInput, 'skipFrames');
            addInputListener(xMinInput, 'xMin');
            addInputListener(xMaxInput, 'xMax');
            addInputListener(yMinInput, 'yMin');
            addInputListener(yMaxInput, 'yMax');
            addInputListener(showLegendSelect, 'showLegend');
            addInputListener(tooltipModeSelect, 'tooltipMode');
            addInputListener(xAxisTypeSelect, 'xAxisType');
            addInputListener(chartTitleInput, 'chartTitle');
            addInputListener(xAxisLabelInput, 'xAxisLabel');
            addInputListener(yAxisLabelInput, 'yAxisLabel');
            addInputListener(videoQualitySelect, 'videoQuality');
            addInputListener(axisZoomInput, 'axisZoomInput');

            // === Â§öÊñá‰ª∂ÁÆ°ÁêÜÂäüËÉΩ ===

            // Ê∑ªÂä†Êñá‰ª∂ÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
            addFileBtn.addEventListener('click', () => {
                fileInput.click();
            });

            // Êñá‰ª∂ÁÆ°ÁêÜÂäüËÉΩÂáΩÊï∞
            function addCsvFile(file, fileData, fileName) {
                const fileIndex = csvFiles.length;
                const fileInfo = {
                    file: file,
                    data: fileData,
                    fileName: fileName,
                    displayName: fileName, // ÂàùÂßãÊòæÁ§∫ÂêçÁß∞‰∏éÊñá‰ª∂ÂêçÁõ∏Âêå
                    fileHandle: file,
                    constantRows: "" // ÊØè‰∏™Êñá‰ª∂Áã¨Á´ãÁöÑÂ∏∏ÊòæË°åËÆæÁΩÆ
                };

                csvFiles.push(fileInfo);

                // Â¶ÇÊûúÊòØÁ¨¨‰∏Ä‰∏™Êñá‰ª∂ÔºåËÆæÁΩÆ‰∏∫‰∏ªÊñá‰ª∂Âπ∂ÊòæÁ§∫Â∏∏ÊòæË°å
                if (fileIndex === 0) {
                    csvData = fileData;
                    currentFileIndex = 0;
                }

                // ÂàõÂª∫Ê†áÁ≠æÈ°µ
                createFileTab(fileInfo, fileIndex);

                // Â¶ÇÊûúÊòØÁ¨¨‰∏Ä‰∏™Êñá‰ª∂ÔºåËá™Âä®ÈÄâ‰∏≠
                if (fileIndex === 0) {
                    selectFile(0);
                }

                // ÊòæÁ§∫Êñá‰ª∂ÁÆ°ÁêÜÁïåÈù¢
                fileTabsContainer.style.display = 'block';
                addFileBtn.style.display = 'inline-block';

                // Â¶ÇÊûúÊúâÊñá‰ª∂ÔºåÊòæÁ§∫Ê∏ÖÈô§Êñá‰ª∂ÊåâÈíÆ
                if (csvFiles.length > 0) {
                    clearFilesBtn.style.display = 'inline-block';
                }

                // Êõ¥Êñ∞Âõæ‰æãÊòæÁ§∫ËÆæÁΩÆ
                updateLegendDisplay();

                showToast(`Êñá‰ª∂ "${fileName}" Â∑≤Ê∑ªÂä†`, 'success', { duration: 3000 });
            }

            // ÂàõÂª∫Êñá‰ª∂Ê†áÁ≠æÈ°µ
            function createFileTab(fileInfo, index) {
                const tab = document.createElement('div');
                tab.className = 'file-tab';
                tab.dataset.fileIndex = index;

                const displayName = fileInfo.displayName;
                const rowCount = fileInfo.data.length;
                const colCount = fileInfo.data.length > 0 ? fileInfo.data[0].length : 0;
                const fileSize = formatFileSize(fileInfo.file.size);

                tab.innerHTML = `
                    <div class="file-name" contenteditable="true" title="ÁÇπÂáªÁºñËæëÂêçÁß∞">${displayName}</div>
                    <div class="file-info">${fileSize} | ${rowCount}√ó${colCount}</div>
                    <div class="file-config">
                        <input type="text" class="constant-rows-input" placeholder="ÂçïÁã¨ËÆæÁΩÆÂ∏∏ÊòæË°å(ÁïôÁ©∫Âàô‰ΩøÁî®ÂÖ®Â±ÄËÆæÁΩÆ)"
                               value="${fileInfo.constantRows || ''}" title="‰∏∫Ê≠§Êñá‰ª∂ÂçïÁã¨ËÆæÁΩÆÂ∏∏ÊòæË°åÔºåÁïôÁ©∫Âàô‰ΩøÁî®ÂÖ®Â±ÄËÆæÁΩÆ">
                    </div>
                    <button class="close-tab" data-file-index="${index}" title="ÁßªÈô§Êñá‰ª∂">√ó</button>
                `;

                const fileNameElement = tab.querySelector('.file-name');

                // ÈáçÂëΩÂêçÂäüËÉΩ
                fileNameElement.addEventListener('blur', () => {
                    const newName = fileNameElement.textContent.trim();
                    if (newName && newName !== fileInfo.displayName) {
                        renameFile(index, newName);
                    } else {
                        fileNameElement.textContent = fileInfo.displayName; // ÊÅ¢Â§çÂéüÂêçÁß∞
                    }
                });

                fileNameElement.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        fileNameElement.blur();
                    }
                });

                // ÈòªÊ≠¢ÁÇπÂáªÁºñËæëÂå∫ÂüüÊó∂Ëß¶ÂèëÊñá‰ª∂ÈÄâÊã©
                fileNameElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                });

                // ÂÖ≥Èó≠ÊåâÈíÆ‰∫ã‰ª∂
                const closeBtn = tab.querySelector('.close-tab');
                closeBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    removeFile(index);
                });

                // Â∏∏ÊòæË°åËÆæÁΩÆ‰∫ã‰ª∂
                const constantRowsInput = tab.querySelector('.constant-rows-input');
                const handleConstantRowsChange = () => {
                    const newValue = constantRowsInput.value.trim();
                    fileInfo.constantRows = newValue;

                    // Â¶ÇÊûúËÆæÁΩÆ‰∫ÜÂ∏∏ÊòæË°åÔºåËá™Âä®ÂêØÁî®Âõæ‰æã
                    if (newValue !== '' && showLegendSelect.value !== 'true') {
                        showLegendSelect.value = 'true';
                    }

                    // Â∏∏ÊòæË°åËÆæÁΩÆÂ∑≤Êõ¥Êñ∞ÔºåÈúÄË¶ÅÁÇπÂáª"ÁîüÊàêÂä®Áîª"ÊåâÈíÆÂ∫îÁî®Êõ¥Êîπ
                };

                constantRowsInput.addEventListener('change', handleConstantRowsChange);
                constantRowsInput.addEventListener('input', handleConstantRowsChange);

                // ÈòªÊ≠¢Â∏∏ÊòæË°åËæìÂÖ•Ê°ÜÁÇπÂáªÊó∂Ëß¶ÂèëÊñá‰ª∂ÈÄâÊã©
                constantRowsInput.addEventListener('click', (e) => {
                    e.stopPropagation();
                });

                tab.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('close-tab') && e.target !== fileNameElement) {
                        selectFile(index);
                    }
                });

                fileTabs.appendChild(tab);
            }

            // ÈáçÂëΩÂêçÊñá‰ª∂
            function renameFile(index, newName) {
                if (index < 0 || index >= csvFiles.length) return;

                const fileInfo = csvFiles[index];
                const oldName = fileInfo.displayName;

                // Êõ¥Êñ∞ÊòæÁ§∫ÂêçÁß∞
                fileInfo.displayName = newName;

                // Â¶ÇÊûúÂõæË°®Â∑≤ÁîüÊàêÔºåÊõ¥Êñ∞Âõæ‰æã
                if (chart && allFilesFrameData.length > index) {
                    chart.data.datasets[index].label = newName;
                    chart.update();
                }

                showToast(`Êñá‰ª∂ "${oldName}" Â∑≤ÈáçÂëΩÂêç‰∏∫ "${newName}"`, 'success', { duration: 3000 });
            }

            // ÈÄâÊã©Êñá‰ª∂
            function selectFile(index) {
                if (index < 0 || index >= csvFiles.length) return;

                // Êõ¥Êñ∞ÂΩìÂâçÊñá‰ª∂Á¥¢Âºï
                currentFileIndex = index;

                // Êõ¥Êñ∞Ê†áÁ≠æÈ°µÁä∂ÊÄÅ
                document.querySelectorAll('.file-tab').forEach((tab, i) => {
                    tab.classList.toggle('active', i === index);
                });

                // Êõ¥Êñ∞ÂΩìÂâçÊòæÁ§∫ÁöÑÊï∞ÊçÆ
                const fileInfo = csvFiles[index];
                csvData = fileInfo.data;
                csvFileName = fileInfo.fileName;

                // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫
                const rowCount = fileInfo.data.length;
                const colCount = fileInfo.data.length > 0 ? fileInfo.data[0].length : 0;
                fileName.innerHTML = `È¢ÑËßà: ${fileInfo.fileName} <span style="color: #666; font-size: 0.9em; font-weight: normal;">(${formatFileSize(fileInfo.file.size)} | ${rowCount}Ë°å √ó ${colCount}Âàó)</span>`;

                // È¢ÑËßàÊï∞ÊçÆ
                previewData();
            }

            // ÁßªÈô§Êñá‰ª∂
            function removeFile(index) {
                if (csvFiles.length === 0) {
                    showToast('Ê≤°ÊúâÊñá‰ª∂ÂèØ‰ª•ÁßªÈô§', 'warning', { duration: 3000 });
                    return;
                }

                const fileInfo = csvFiles[index];
                if (confirm(`Á°ÆÂÆöË¶ÅÁßªÈô§Êñá‰ª∂ "${fileInfo.fileName}" ÂêóÔºü`)) {
                    // ‰ªéÊï∞ÁªÑ‰∏≠ÁßªÈô§
                    csvFiles.splice(index, 1);

                    // ÈáçÊñ∞ÂàõÂª∫Ê†áÁ≠æÈ°µ
                    fileTabs.innerHTML = '';
                    csvFiles.forEach((file, i) => {
                        createFileTab(file, i);
                    });

                    // Â¶ÇÊûúÁßªÈô§ÁöÑÊòØÂΩìÂâçÊñá‰ª∂ÔºåÈÄâÊã©Á¨¨‰∏Ä‰∏™Êñá‰ª∂
                    if (currentFileIndex >= index) {
                        currentFileIndex = Math.max(0, currentFileIndex - 1);
                    }

                    // Â¶ÇÊûúËøòÊúâÊñá‰ª∂ÔºåÈÄâ‰∏≠‰∏Ä‰∏™
                    if (csvFiles.length > 0) {
                        selectFile(currentFileIndex);
                        // Êõ¥Êñ∞Âõæ‰æãÊòæÁ§∫ËÆæÁΩÆ
                        updateLegendDisplay();

                        // Ê∏ÖÈô§Êñá‰ª∂ÊåâÈíÆÂßãÁªàÊòæÁ§∫
                        clearFilesBtn.style.display = 'inline-block';
                    } else {
                        // Ê≤°ÊúâÊñá‰ª∂‰∫ÜÔºåÈöêËóèÁïåÈù¢Âπ∂Ê∏ÖÈô§ÁªòÂõæÂå∫Âüü
                        fileTabsContainer.style.display = 'none';
                        addFileBtn.style.display = 'none';
                        clearFilesBtn.style.display = 'inline-block'; // Ê∏ÖÈô§Êñá‰ª∂ÊåâÈíÆÂßãÁªàÊòæÁ§∫
                        uploadPrompt.classList.remove('hidden');
                        uploadSection.classList.remove('has-file');
                        dataPreviewSection.classList.add('hidden');
                        configSection.classList.add('hidden');

                        // Ê∏ÖÈô§ÁªòÂõæÂå∫Âüü
                        if (chart) {
                            chart.destroy();
                            chart = null;
                        }
                        // Ê∏ÖÈô§canvasÂÜÖÂÆπ
                        const canvas = document.getElementById('chartCanvas');
                        if (canvas) {
                            const ctx = canvas.getContext('2d');
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                        }

                        // ÈáçÁΩÆÊñá‰ª∂ÂêçÊòæÁ§∫
                        document.getElementById('fileName').textContent = 'È¢ÑËßà: Êú™ÈÄâÊã©Êñá‰ª∂';
                    }

                    showToast(`Êñá‰ª∂ "${fileInfo.fileName}" Â∑≤ÁßªÈô§`, 'info', { duration: 3000 });
                }
            }

            // Â§ÑÁêÜÂ§öÊñá‰ª∂ÈÄâÊã©
            function handleMultipleFiles(files) {
                let filesProcessed = 0;
                let firstFileAdded = false;

                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    if (file.name.endsWith('.csv')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                const fileContent = e.target.result;
                                const fileData = parseCSV(fileContent);

                                if (fileData.length === 0) {
                                    showToast(`Êñá‰ª∂ "${file.name}" ‰∏∫Á©∫ÊàñÊ†ºÂºè‰∏çÊ≠£Á°Æ`, 'warning', { duration: 4000 });
                                    return;
                                }

                                const fileName = file.name.replace(/\.[^/.]+$/, "");
                                addCsvFile(file, fileData, fileName);

                                filesProcessed++;

                                // Â¶ÇÊûúÊòØÁ¨¨‰∏Ä‰∏™ÊàêÂäüÊ∑ªÂä†ÁöÑÊñá‰ª∂ÔºåÊõ¥Êñ∞UIÊòæÁ§∫
                                if (!firstFileAdded && filesProcessed === 1) {
                                    firstFileAdded = true;
                                    updateUIForFirstFile(file, fileData, fileName);
                                }

                            } catch (error) {
                                showToast(`Ëß£ÊûêÊñá‰ª∂ "${file.name}" Êó∂Âá∫Èîô: ${error.message}`, 'error', { duration: 6000 });
                            }
                        };
                        reader.readAsText(file);
                    }
                }
            }

            // Ëé∑ÂèñÂä®ÊÄÅÊï∞ÊçÆÈ¢úËâ≤
            function getDynamicDataColor(fileIndex) {
                const dynamicDataColors = ['#E74C3C', '#F39C12', '#27AE60', '#8E44AD', '#E67E22', '#16A085', '#D35400', '#C0392B'];
                return dynamicDataColors[fileIndex % dynamicDataColors.length];
            }

            // Ëé∑ÂèñÂ∏∏ÊòæË°åÈ¢úËâ≤
            function getConstantRowColor(fileIndex, rowIndex, totalRows) {
                const constantRowColors = ['#5DADE2', '#48C9B0', '#45B7D1', '#7FB3D5', '#85C1E9', '#76D7C4', '#5499C7', '#2E86AB'];
                const globalIndex = fileIndex * totalRows + rowIndex;
                return constantRowColors[globalIndex % constantRowColors.length];
            }

            // Ê∏ÖÈô§ÊâÄÊúâÊñá‰ª∂
            function clearAllFiles() {
                if (csvFiles.length === 0) {
                    showToast('Ê≤°ÊúâÊñá‰ª∂ÈúÄË¶ÅÊ∏ÖÈô§', 'info', { duration: 3000 });
                    return;
                }

                if (confirm(`Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâ ${csvFiles.length} ‰∏™Êñá‰ª∂ÂêóÔºü`)) {
                    // Ê∏ÖÈô§ÊâÄÊúâÊñá‰ª∂
                    csvFiles = [];
                    currentFileIndex = -1;

                    // Ê∏ÖÁ©∫Ê†áÁ≠æÈ°µ
                    fileTabs.innerHTML = '';

                    // Ê∏ÖÈô§Êñá‰ª∂ÊåâÈíÆÂßãÁªàÊòæÁ§∫
                    clearFilesBtn.style.display = 'inline-block';

                    // Êõ¥Êñ∞Âõæ‰æãÊòæÁ§∫ËÆæÁΩÆ
                    updateLegendDisplay();

                    // ÈáçÁΩÆ‰∏∫ÂàùÂßãÁä∂ÊÄÅ
                    uploadPrompt.classList.remove('hidden');
                    uploadSection.classList.remove('has-file');
                    dataPreviewSection.classList.add('hidden');
                    configSection.classList.add('hidden');
                    document.getElementById('fileTabsContainer').style.display = 'none';

                    // ÈáçÁΩÆÊåâÈíÆÊòæÁ§∫Áä∂ÊÄÅ
                    document.getElementById('initialUploadBtn').style.display = 'inline-block';
                    document.getElementById('addFileBtn').style.display = 'none';

                    // ÈáçÁΩÆÊñá‰ª∂ÂêçÊòæÁ§∫
                    document.getElementById('fileName').textContent = 'È¢ÑËßà: Êú™ÈÄâÊã©Êñá‰ª∂';

                    // Ê∏ÖÈô§ÁªòÂõæÂå∫Âüü
                    if (chart) {
                        chart.destroy();
                        chart = null;
                    }
                    // Ê∏ÖÈô§canvasÂÜÖÂÆπ
                    const canvas = document.getElementById('chartCanvas');
                    if (canvas) {
                        const ctx = canvas.getContext('2d');
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                    }

                    showToast('Â∑≤Ê∏ÖÈô§ÊâÄÊúâÊñá‰ª∂ÂíåÁªòÂõæÂå∫Âüü', 'info', { duration: 3000 });
                }
            }

            // ‰∏∫Êñá‰ª∂Êõ¥Êñ∞UIÊòæÁ§∫
            function updateUIForFirstFile(file, fileData, fileName) {
                // Êõ¥Êñ∞UI
                uploadPrompt.classList.add('hidden');
                uploadSection.classList.add('has-file');
                fileName.textContent = `È¢ÑËßà: ${file.name}`;
                dataPreviewSection.classList.remove('hidden');

                // Ê∏ÖÈô§Êñá‰ª∂ÊåâÈíÆÂßãÁªàÊòæÁ§∫
                clearFilesBtn.style.display = 'inline-block';

                // È¢ÑËßàÊï∞ÊçÆ
                previewData();

                // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫
                updateFileInfo(file, fileData);

                // ÊòæÁ§∫ËÆæÁΩÆÂå∫Âüü
                configSection.classList.remove('hidden');

                // Âè™ÈáçÁΩÆÈªòËÆ§ËÆæÁΩÆÔºå‰øùÁïôÊâãÂä®ËÆæÁΩÆ
                setDefaultConfigOnly();
            }

            // XËΩ¥Êï∞ÊçÆË°åÂè∑ÊîπÂèòÊó∂ÁöÑÁâπÊÆäÂ§ÑÁêÜ
            xAxisRowInput.addEventListener('input', function() {
                updateRelatedDefaults();
            });

            // Êõ¥Êñ∞Âõæ‰æãÊòæÁ§∫ËÆæÁΩÆ
            function updateLegendDisplay() {
                // Âè™Âú®Êú™ÊâãÂä®ËÆæÁΩÆÊòæÁ§∫Âõæ‰æãÊó∂Ëá™Âä®Ë∞ÉÊï¥
                if (!manuallyModified.has('showLegend')) {
                    const hasConstantRows = constantRowsInput.value.trim() !== '';
                    const hasMultipleFiles = csvFiles.length > 1;
                    // Â¶ÇÊûúÊúâÂ∏∏ÊòæË°åÊàñÂ§ö‰∏™Êñá‰ª∂ÔºåËá™Âä®ÊòæÁ§∫Âõæ‰æã
                    showLegendSelect.value = (hasConstantRows || hasMultipleFiles) ? 'true' : 'false';
                }
            }

            // ÂÖ®Â±ÄÊãñÊîæÊ£ÄÊµãÂíåÂ§ÑÁêÜ
            let isDraggingFile = false;

            document.addEventListener('dragover', (e) => {
                // Ê£ÄÊü•ÊòØÂê¶ÊãñÊãΩÁöÑÊòØÊñá‰ª∂
                if (e.dataTransfer.types.includes('Files')) {
                    e.preventDefault();
                    e.stopPropagation();

                    if (!isDraggingFile) {
                        isDraggingFile = true;
                        globalDropOverlay.classList.add('active');
                        uploadSection.classList.add('global-drop-highlight');
                    }
                }
            });

            document.addEventListener('dragleave', (e) => {
                // ÂΩìÈº†Ê†áÁ¶ªÂºÄÈ°µÈù¢Êó∂ÈöêËóèË¶ÜÁõñÂ±Ç
                if (e.clientX === 0 && e.clientY === 0) {
                    hideGlobalDropOverlay();
                }
            });

            document.addEventListener('drop', (e) => {
                // Â§ÑÁêÜÂÖ®Â±ÄÊñá‰ª∂ÊãñÊîæ
                if (e.dataTransfer.types.includes('Files')) {
                    e.preventDefault();
                    e.stopPropagation();

                    hideGlobalDropOverlay();

                    if (e.dataTransfer.files.length > 0) {
                        // Áªü‰∏Ä‰ΩøÁî®Â§öÊñá‰ª∂Â§ÑÁêÜÈÄªËæë
                        const csvFiles = Array.from(e.dataTransfer.files).filter(file => file.name.endsWith('.csv'));
                        if (csvFiles.length > 0) {
                            handleMultipleFiles(csvFiles);
                        } else {
                            showToast('ËØ∑‰∏ä‰º† CSV Ê†ºÂºèÁöÑÊñá‰ª∂', 'error', { duration: 4000 });
                        }
                    }
                }
            });

            // Ë¶ÜÁõñÂ±ÇÁöÑÊãñÊîæ‰∫ã‰ª∂Â§ÑÁêÜ
            globalDropOverlay.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.stopPropagation();
            });

            globalDropOverlay.addEventListener('drop', (e) => {
                e.preventDefault();
                e.stopPropagation();
                hideGlobalDropOverlay();

                if (e.dataTransfer.files.length > 0) {
                    // Áªü‰∏Ä‰ΩøÁî®Â§öÊñá‰ª∂Â§ÑÁêÜÈÄªËæë
                    const csvFiles = Array.from(e.dataTransfer.files).filter(file => file.name.endsWith('.csv'));
                    if (csvFiles.length > 0) {
                        handleMultipleFiles(csvFiles);
                    } else {
                        showToast('ËØ∑‰∏ä‰º† CSV Ê†ºÂºèÁöÑÊñá‰ª∂', 'error', { duration: 4000 });
                    }
                }
            });

            // ÈöêËóèÂÖ®Â±ÄÊãñÊîæË¶ÜÁõñÂ±ÇÁöÑÂáΩÊï∞
            function hideGlobalDropOverlay() {
                isDraggingFile = false;
                globalDropOverlay.classList.remove('active');
                uploadSection.classList.remove('global-drop-highlight');
            }

            // Êñá‰ª∂‰∏ä‰º†Â§ÑÁêÜ
            initialUploadBtn.addEventListener('click', selectMultipleFilesWithPermission);
            uploadBtn.addEventListener('click', selectMultipleFilesWithPermission);
            refreshFileBtn.addEventListener('click', refreshAllFiles);
            clearFilesBtn.addEventListener('click', clearAllFiles);

            fileInput.addEventListener('change', handleFileSelect);

            // ÊãñÊãΩ‰∏ä‰º†
            uploadSection.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadSection.classList.add('dragover');
            });

            uploadSection.addEventListener('dragleave', (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadSection.classList.remove('dragover');
            });

            uploadSection.addEventListener('drop', (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadSection.classList.remove('dragover');

                if (e.dataTransfer.files.length) {
                    // Áªü‰∏Ä‰ΩøÁî®Â§öÊñá‰ª∂Â§ÑÁêÜÈÄªËæë
                    const files = Array.from(e.dataTransfer.files).filter(file => file.name.endsWith('.csv'));
                    if (files.length > 0) {
                        handleMultipleFiles(files);
                    }
                }
            });

            // ÁîüÊàêÂä®ÁîªÊåâÈíÆ
            generateChartBtn.addEventListener('click', generateChart);

            // ‰øùÂ≠òËßÜÈ¢ëÊåâÈíÆ
            saveVideoBtn.addEventListener('click', saveVideo);

            // ÈáçÁΩÆÊåâÈíÆ
            resetBtn.addEventListener('click', resetConfig);

            // ÂùêÊ†áËΩ¥Áº©ÊîæÊéßÂà∂‰∫ã‰ª∂ÁõëÂê¨Âô®
            axisZoomInBtn.addEventListener('click', (e) => {
                if (chart) {
                    axisZoomIn();
                }
                e.target.blur(); // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
            });

            axisZoomOutBtn.addEventListener('click', (e) => {
                if (chart) {
                    axisZoomOut();
                }
                e.target.blur(); // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
            });

            axisResetBtn.addEventListener('click', (e) => {
                if (chart) {
                    resetAxisZoom();
                }
                e.target.blur(); // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
            });

            // Áº©ÊîæÁõÆÊ†áÈÄâÊã©‰∫ã‰ª∂ÁõëÂê¨Âô®
            axisZoomTarget.addEventListener('change', (e) => {
                updateZoomDisplay(); // ÂàáÊç¢ÁõÆÊ†áÊó∂Êõ¥Êñ∞ÊòæÁ§∫
                e.target.blur(); // Èò≤Ê≠¢Ëé∑ÂæóÁÑ¶ÁÇπ
            });

            // Áº©ÊîæËæìÂÖ•Ê°Ü‰∫ã‰ª∂ÁõëÂê¨Âô®
            axisZoomInput.addEventListener('input', (e) => {
                if (chart) {
                    const target = axisZoomTarget.value;
                    let inputValue = parseInt(e.target.value);

                    // È™åËØÅËæìÂÖ•ÂÄº
                    if (isNaN(inputValue) || inputValue < 1) {
                        inputValue = 1;
                    } else if (inputValue > 999999) {
                        inputValue = 999999;
                    }

                    const newZoomLevel = inputValue / 100;

                    if (target === 'xy') {
                        axisZoomLevel = newZoomLevel;
                        xAxisZoomLevel = newZoomLevel;
                        yAxisZoomLevel = newZoomLevel;
                    } else if (target === 'x') {
                        xAxisZoomLevel = newZoomLevel;
                    } else if (target === 'y') {
                        yAxisZoomLevel = newZoomLevel;
                    }

                    updateAxisZoom();
                    updateZoomDisplay();
                }
            });

            // Áº©ÊîæÊªëÂùó‰∫ã‰ª∂ÁõëÂê¨Âô®
            axisZoomSlider.addEventListener('input', (e) => {
                if (chart) {
                    const target = axisZoomTarget.value;
                    const newZoomLevel = parseInt(e.target.value) / 100;

                    if (target === 'xy') {
                        axisZoomLevel = newZoomLevel;
                        xAxisZoomLevel = newZoomLevel;
                        yAxisZoomLevel = newZoomLevel;
                    } else if (target === 'x') {
                        xAxisZoomLevel = newZoomLevel;
                    } else if (target === 'y') {
                        yAxisZoomLevel = newZoomLevel;
                    }

                    updateAxisZoom();
                    updateZoomDisplay();
                    e.target.blur(); // Èò≤Ê≠¢ÊªëÂùóËé∑ÂæóÁÑ¶ÁÇπ
                }
            });

            // Êõ¥Êñ∞Áº©ÊîæÊòæÁ§∫
            function updateZoomDisplay() {
                const target = axisZoomTarget.value;
                let zoomPercent;

                if (target === 'xy') {
                    zoomPercent = Math.round(axisZoomLevel * 100);
                } else if (target === 'x') {
                    zoomPercent = Math.round(xAxisZoomLevel * 100);
                } else if (target === 'y') {
                    zoomPercent = Math.round(yAxisZoomLevel * 100);
                }

                // Êõ¥Êñ∞ËæìÂÖ•Ê°ÜÂíåÊªëÂùó
                axisZoomInput.value = zoomPercent;

                // Â¶ÇÊûúÁº©ÊîæÂÄºË∂ÖËøáÊªëÂùóËåÉÂõ¥Ôºå‰∏çÊõ¥Êñ∞ÊªëÂùóÔºåÂê¶ÂàôÂêåÊ≠•
                if (zoomPercent <= 1000) {
                    axisZoomSlider.value = zoomPercent;
                }
            }

            // Èò≤Ê≠¢ÂõæË°®ÂÆπÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
            chartContainer.setAttribute('tabindex', '-1'); // Èò≤Ê≠¢ÈÄöËøátabÈîÆËé∑ÂæóÁÑ¶ÁÇπ
            chartContainer.style.outline = 'none'; // ÁßªÈô§ÁÑ¶ÁÇπËΩÆÂªì

            // ÂõæË°®ÊãñÊãΩÂπ≥Áßª‰∫ã‰ª∂ÁõëÂê¨Âô®
            chartContainer.addEventListener('mousedown', (e) => {
                // Èò≤Ê≠¢ÂõæË°®ÂÆπÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                e.preventDefault();
                handleAxisPanStart(e);
            });
            chartContainer.addEventListener('mousemove', handleAxisPanMove);
            chartContainer.addEventListener('mouseup', (e) => {
                handleAxisPanEnd(e);
                // Á°Æ‰øùÂõæË°®ÂÆπÂô®‰∏ç‰ºö‰øùÊåÅÁÑ¶ÁÇπ
                e.target.blur();
                if (document.activeElement === chartContainer) {
                    document.body.focus(); // Â∞ÜÁÑ¶ÁÇπËΩ¨ÁßªÂà∞body
                }
            });
            chartContainer.addEventListener('mouseleave', handleAxisPanEnd);

            // Ê∑ªÂä†ÂèåÂáª‰∫ã‰ª∂Áî®‰∫éÊó∂Èó¥Â∫èÂàóÂàÜÊûêÔºàÈÅøÂÖç‰∏éÊãñÊãΩÂÜ≤Á™ÅÔºâ
            chartContainer.addEventListener('dblclick', handleChartDoubleClick);

            // ÂõæË°®Âå∫Èº†Ê†áÊªöËΩÆÂ§ÑÁêÜÔºöÂÖÅËÆ∏È°µÈù¢ÊªöÂä®ÔºåCtrl+ÊªöËΩÆËøõË°åÁº©Êîæ
            chartContainer.addEventListener('wheel', (e) => {
                // Âè™ÊúâÊåâ‰ΩèCtrlÈîÆÊó∂ÊâçËøõË°åÁº©Êîæ
                if (e.ctrlKey || e.metaKey) {
                    e.preventDefault();

                    // Ê†πÊçÆÊªöËΩÆÊñπÂêëËøõË°åÁº©Êîæ
                    if (e.deltaY < 0) {
                        // Âêë‰∏äÊªöÂä®ÔºåÊîæÂ§ß
                        axisZoomIn();
                    } else {
                        // Âêë‰∏ãÊªöÂä®ÔºåÁº©Â∞è
                        axisZoomOut();
                    }
                }
                // ‰∏çÊåâCtrlÈîÆÊó∂ÔºåÂÖÅËÆ∏Ê≠£Â∏∏ÁöÑÈ°µÈù¢ÊªöÂä®Ë°å‰∏∫Ôºà‰∏çÈòªÊ≠¢ÈªòËÆ§‰∫ã‰ª∂Ôºâ
            });


            // Êí≠Êîæ/ÊöÇÂÅúÊåâÈíÆ
            playPauseBtn.addEventListener('click', (e) => {
                togglePlayPause();
                e.target.blur(); // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
            });

            // ‰∏ä‰∏ÄÂ∏ß/‰∏ã‰∏ÄÂ∏ßÊåâÈíÆÈïøÊåâ‰∫ã‰ª∂
            prevFrameBtn.addEventListener('mousedown', (e) => {
                e.preventDefault();
                // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
                e.target.blur();
                if (isPlaying) togglePlayPause();
                startFrameNavigation(-1);
            });

            prevFrameBtn.addEventListener('mouseup', () => {
                stopFrameNavigation();
            });

            prevFrameBtn.addEventListener('mouseleave', () => {
                stopFrameNavigation();
            });

            prevFrameBtn.addEventListener('click', () => {
                // ÂçïÂáªÊó∂Â∑≤ÁªèÂú®mousedown‰∏≠Â§ÑÁêÜ‰∫ÜÔºåËøôÈáå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜ
            });

            nextFrameBtn.addEventListener('mousedown', (e) => {
                e.preventDefault();
                // Èò≤Ê≠¢ÊåâÈíÆËé∑ÂæóÁÑ¶ÁÇπ
                e.target.blur();
                if (isPlaying) togglePlayPause();
                startFrameNavigation(1);
            });

            nextFrameBtn.addEventListener('mouseup', () => {
                stopFrameNavigation();
            });

            nextFrameBtn.addEventListener('mouseleave', () => {
                stopFrameNavigation();
            });

            nextFrameBtn.addEventListener('click', () => {
                // ÂçïÂáªÊó∂Â∑≤ÁªèÂú®mousedown‰∏≠Â§ÑÁêÜ‰∫ÜÔºåËøôÈáå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂ§ÑÁêÜ
            });

            // ËøõÂ∫¶Êù°
            progressBar.addEventListener('input', (e) => {
                currentFrameIndex = parseInt(progressBar.value);
                updateChart();
                updateFrameInfo();
                // Èò≤Ê≠¢ËøõÂ∫¶Êù°Ëé∑ÂæóÁÑ¶ÁÇπ
                e.target.blur();
            });

            // Èò≤Ê≠¢ËøõÂ∫¶Êù°Âú®ÁÇπÂáªÊó∂Ëé∑ÂæóÁÑ¶ÁÇπ
            progressBar.addEventListener('mousedown', (e) => {
                // ‰∏çÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫ÔºåÂÖÅËÆ∏Ê≠£Â∏∏ÊãñÊãΩ
                // ÁÑ¶ÁÇπÊéßÂà∂Â∞ÜÂú®input‰∫ã‰ª∂‰∏≠Â§ÑÁêÜ
            });

            progressBar.addEventListener('change', (e) => {
                e.target.blur(); // Á°Æ‰øùÂú®ÂÄºÊîπÂèòÂêéÂ§±ÂéªÁÑ¶ÁÇπ
            });

            // Êõ¥Êñ∞Áõ∏ÂÖ≥ÈªòËÆ§ÂÄº
            function updateRelatedDefaults() {
                const xAxisRow = parseInt(xAxisRowInput.value);

                // Êõ¥Êñ∞YËΩ¥Ëµ∑ÂßãË°åÔºàÂ¶ÇÊûúÊú™ÊâãÂä®‰øÆÊîπÔºâ
                if (!manuallyModified.has('startRow')) {
                    startRowInput.value = xAxisRow + 1;
                }

                // Êõ¥Êñ∞XËΩ¥ËåÉÂõ¥ÔºàÂ¶ÇÊûúÊú™ÊâãÂä®‰øÆÊîπÔºâ
                if (!manuallyModified.has('xMin') || !manuallyModified.has('xMax')) {
                    updateXAxisRange();
                }

                // ÊÄªÊòØÊõ¥Êñ∞XËΩ¥Ê†áÁ≠æÁöÑÂÄºÔºàÂΩìXËΩ¥Ë°åÂè∑ÊîπÂèòÊó∂Ôºâ
                updateXAxisLabelValue();
            }

            // Êõ¥Êñ∞XËΩ¥ËåÉÂõ¥ - ‰øÆÊîπ‰∏∫‰ΩøÁî®ÊâÄÊúâÊñá‰ª∂ÁöÑÊï∞ÊçÆ
            function updateXAxisRange() {
                const xAxisRow = parseInt(xAxisRowInput.value) - 1;
                if (csvFiles.length > 0) {
                    let allMinValues = [];
                    let allMaxValues = [];

                    // Êî∂ÈõÜÊâÄÊúâÊñá‰ª∂ÁöÑÊúâÊïàXËΩ¥Êï∞ÊçÆ
                    for (const file of csvFiles) {
                        if (xAxisRow >= 0 && xAxisRow < file.data.length) {
                            const xData = file.data[xAxisRow].filter(val => val !== '' && !isNaN(parseFloat(val)));
                            if (xData.length > 0) {
                                const numericData = xData.map(val => parseFloat(val));
                                // ‰ΩøÁî®Âæ™ÁéØ‰ª£ÊõøÊâ©Â±ïËøêÁÆóÁ¨¶,ÈÅøÂÖçWindows‰∏ãÂèÇÊï∞Êï∞ÈáèÈôêÂà∂ÂºÇÂ∏∏
                                let minVal = numericData[0];
                                let maxVal = numericData[0];
                                for (let i = 1; i < numericData.length; i++) {
                                    if (numericData[i] < minVal) minVal = numericData[i];
                                    if (numericData[i] > maxVal) maxVal = numericData[i];
                                }
                                allMinValues.push(minVal);
                                allMaxValues.push(maxVal);
                            }
                        }
                    }

                    // ‰ΩøÁî®ÊâÄÊúâÊñá‰ª∂‰∏≠ÁöÑÊúÄÂ∞è/ÊúÄÂ§ßÂÄº
                    if (allMinValues.length > 0) {
                        // ‰ΩøÁî®Âæ™ÁéØ‰ª£ÊõøÊâ©Â±ïËøêÁÆóÁ¨¶,ÈÅøÂÖçWindows‰∏ãÂèÇÊï∞Êï∞ÈáèÈôêÂà∂ÂºÇÂ∏∏
                        let min = allMinValues[0];
                        let max = allMaxValues[0];
                        for (let i = 1; i < allMinValues.length; i++) {
                            if (allMinValues[i] < min) min = allMinValues[i];
                            if (allMaxValues[i] > max) max = allMaxValues[i];
                        }

                        if (!manuallyModified.has('xMin')) {
                            xMinInput.value = min;
                            xMinInput.classList.remove('manual-value');
                            xMinInput.classList.add('default-value');
                        }
                        if (!manuallyModified.has('xMax')) {
                            xMaxInput.value = max;
                            xMaxInput.classList.remove('manual-value');
                            xMaxInput.classList.add('default-value');
                        }
                    }
                }
            }

            // Êõ¥Êñ∞XËΩ¥Ê†áÁ≠æÔºàÂåÖÂê´Ê†∑ÂºèËÆæÁΩÆÔºâ
            function updateXAxisLabel() {
                const xAxisRow = parseInt(xAxisRowInput.value) - 1;
                if (csvFiles.length > 0 && xAxisRow >= 0 && xAxisRow < csvFiles[0].data.length && csvFiles[0].data[xAxisRow].length > 0) {
                    xAxisLabelInput.value = csvFiles[0].data[xAxisRow][0];
                    // Âè™ÊúâÂú®ÈùûÊâãÂä®‰øÆÊîπÊó∂ÊâçËÆæÁΩÆÈªòËÆ§Ê†∑Âºè
                    if (!manuallyModified.has('xAxisLabel')) {
                        xAxisLabelInput.classList.remove('manual-value');
                        xAxisLabelInput.classList.add('default-value');
                    }
                }
            }

            // Âè™Êõ¥Êñ∞XËΩ¥Ê†áÁ≠æÁöÑÂÄºÔºå‰∏çÊîπÂèòÊâãÂä®‰øÆÊîπÁä∂ÊÄÅ
            function updateXAxisLabelValue() {
                const xAxisRow = parseInt(xAxisRowInput.value) - 1;
                if (csvFiles.length > 0 && xAxisRow >= 0 && xAxisRow < csvFiles[0].data.length && csvFiles[0].data[xAxisRow].length > 0) {
                    const newLabel = csvFiles[0].data[xAxisRow][0];
                    // Âè™ÊúâÂú®ÂÄºÁ°ÆÂÆûÊîπÂèòÊó∂ÊâçÊõ¥Êñ∞
                    if (xAxisLabelInput.value !== newLabel) {
                        xAxisLabelInput.value = newLabel;
                        // Â¶ÇÊûú‰πãÂâçÊòØÈªòËÆ§Áä∂ÊÄÅÔºå‰øùÊåÅÈªòËÆ§Áä∂ÊÄÅÔºõÂ¶ÇÊûúÊòØÊâãÂä®‰øÆÊîπÁä∂ÊÄÅÔºå‰øùÊåÅÊâãÂä®‰øÆÊîπÁä∂ÊÄÅ
                        if (!manuallyModified.has('xAxisLabel')) {
                            xAxisLabelInput.classList.remove('manual-value');
                            xAxisLabelInput.classList.add('default-value');
                        }
                    }
                }
            }

            // Â§ÑÁêÜÊñá‰ª∂ÈÄâÊã©
            function handleFileSelect(e) {
                if (e.target.files.length) {
                    // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊúâÊñá‰ª∂
                    if (csvFiles.length === 0) {
                        // Á¨¨‰∏Ä‰∏™Êñá‰ª∂Ôºå‰ΩøÁî®ÂéüÊúâÈÄªËæë
                        handleFile(e.target.files[0], false); // ÈÄöËøáÈÄâÊã©Âô®ÂØºÂÖ•Ôºå‰∏çÊòØÊãñÊãΩ
                    } else {
                        // Â∑≤ÊúâÊñá‰ª∂Ôºå‰ΩøÁî®Â§öÊñá‰ª∂Â§ÑÁêÜÈÄªËæë
                        const files = Array.from(e.target.files).filter(file => file.name.endsWith('.csv'));
                        if (files.length > 0) {
                            handleMultipleFiles(files);
                        }
                    }
                }
            }

            // ‰ΩøÁî® File System Access API ÈÄâÊã©Êñá‰ª∂ÔºàÂ∏¶ÊåÅ‰πÖÊùÉÈôêÔºâ
            // ÈÄâÊã©Â§ö‰∏™Êñá‰ª∂ÔºàÂ∏¶ÊùÉÈôêÔºâ
            async function selectMultipleFilesWithPermission() {
                try {
                    if ('showOpenFilePicker' in window) {
                        // ‰ΩøÁî®Áé∞‰ª£ File System Access API ÊîØÊåÅÂ§öÊñá‰ª∂ÈÄâÊã©
                        const pickerOptions = {
                            types: [
                                {
                                    description: 'CSV files',
                                    accept: {
                                        'text/csv': ['.csv'],
                                        'application/vnd.ms-excel': ['.csv'],
                                        'text/plain': ['.csv']
                                    },
                                },
                            ],
                            multiple: true, // ÂÖÅËÆ∏Â§öÈÄâ
                        };

                        // ËÆæÁΩÆÈªòËÆ§ÊâìÂºÄÁõÆÂΩï
                        if (lastOpenedFileHandle) {
                            // Â¶ÇÊûúÊúâ‰∏äÊ¨°ÊâìÂºÄÁöÑÊñá‰ª∂Ôºå‰ªéËØ•Êñá‰ª∂ÊâÄÂú®ÁõÆÂΩïÂºÄÂßã
                            pickerOptions.startIn = lastOpenedFileHandle;
                        } else {
                            // Âê¶ÂàôÈªòËÆ§ÊâìÂºÄDownloadsÁõÆÂΩï
                            pickerOptions.startIn = 'downloads';
                        }

                        const fileHandles = await window.showOpenFilePicker(pickerOptions);

                        if (fileHandles.length === 0) {
                            return; // Áî®Êà∑Ê≤°ÊúâÈÄâÊã©Êñá‰ª∂
                        }

                        showToast(`Ê≠£Âú®ÂØºÂÖ• ${fileHandles.length} ‰∏™Êñá‰ª∂...`, 'info', { duration: 3000 });

                        // Â§ÑÁêÜÂ§ö‰∏™Êñá‰ª∂
                        let successCount = 0;
                        let skipCount = 0;

                        for (let i = 0; i < fileHandles.length; i++) {
                            const fileHandle = fileHandles[i];
                            try {
                                const file = await fileHandle.getFile();

                                // Ê£ÄÊü•Êñá‰ª∂Á±ªÂûã
                                if (!file.name.toLowerCase().endsWith('.csv')) {
                                    showToast(`Ë∑≥ËøáÈùûCSVÊñá‰ª∂: ${file.name}`, 'warning', { duration: 2000 });
                                    skipCount++;
                                    continue;
                                }

                                // Ê£ÄÊü•Êñá‰ª∂Â§ßÂ∞è
                                if (file.size > 100 * 1024 * 1024) { // 100MB limit
                                    showToast(`Êñá‰ª∂ËøáÂ§ßÔºåË∑≥Ëøá: ${file.name}`, 'warning', { duration: 2000 });
                                    skipCount++;
                                    continue;
                                }

                                // Â¶ÇÊûúÊòØÁ¨¨‰∏Ä‰∏™Êñá‰ª∂Ôºå‰øùÂ≠òÂè•ÊüÑÁî®‰∫éÂêéÁª≠Âà∑Êñ∞
                                if (i === 0) {
                                    rememberedFileHandle = fileHandle;
                                }

                                // Â§ÑÁêÜÊñá‰ª∂
                                await handleFileAsync(file, fileHandle);
                                successCount++;

                            } catch (fileError) {
                                console.error(`Â§ÑÁêÜÊñá‰ª∂ ${fileHandle.name} Êó∂Âá∫Èîô:`, fileError);
                                showToast(`Êñá‰ª∂ ${fileHandle.name} Â§ÑÁêÜÂ§±Ë¥•`, 'error', { duration: 3000 });
                                skipCount++;
                            }
                        }

                        // ÊòæÁ§∫ÂØºÂÖ•ÁªìÊûú
                        if (successCount > 0) {
                            showToast(`‚úÖ ÊàêÂäüÂØºÂÖ• ${successCount} ‰∏™Êñá‰ª∂${skipCount > 0 ? `ÔºåË∑≥Ëøá ${skipCount} ‰∏™` : ''}`, 'success', { duration: 4000 });

                            // ËÆ∞ÂΩïÊúÄÂêéÊâìÂºÄÁöÑÊñá‰ª∂Ë∑ØÂæÑÔºà‰ΩøÁî®Á¨¨‰∏Ä‰∏™ÊàêÂäüÂØºÂÖ•ÁöÑÊñá‰ª∂Ôºâ
                            if (fileHandles.length > 0) {
                                lastOpenedFileHandle = fileHandles[0];
                                console.log('Â∑≤ËÆ∞ÂΩïÊúÄÂêéÊâìÂºÄÊñá‰ª∂Ë∑ØÂæÑ:', lastOpenedFileHandle.name);
                            }
                        } else {
                            showToast('‚ùå Ê≤°ÊúâÊàêÂäüÂØºÂÖ•‰ªª‰ΩïÊñá‰ª∂', 'error', { duration: 4000 });
                        }

                    } else {
                        // ÂõûÈÄÄÂà∞‰º†ÁªüÊñπÂºèÔºàÂçïÊñá‰ª∂Ôºâ
                        fileInput.click();
                    }
                } catch (error) {
                    if (error.name === 'AbortError') {
                        // Áî®Êà∑ÂèñÊ∂à‰∫ÜÈÄâÊã©
                        return;
                    }
                    console.error('Êñá‰ª∂ÈÄâÊã©ÈîôËØØ:', error);
                    showToast('‚ùå Êñá‰ª∂ÈÄâÊã©Â§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error', { duration: 6000 });
                }
            }

            // ÂºÇÊ≠•Â§ÑÁêÜÂçï‰∏™Êñá‰ª∂ÔºàÁî®‰∫éÂ§öÊñá‰ª∂ÂØºÂÖ•Ôºâ
            async function handleFileAsync(file, fileHandle = null) {
                try {
                    const fileContent = await file.text();
                    const fileData = parseCSV(fileContent);

                    if (!fileData || fileData.length === 0) {
                        throw new Error('CSVÊñá‰ª∂‰∏∫Á©∫ÊàñÊ†ºÂºè‰∏çÊ≠£Á°Æ');
                    }

                    const fileName = file.name.replace(/\.[^/.]+$/, "");

                    // ‰ΩøÁî® addCsvFile ÂáΩÊï∞Ê∑ªÂä†Êñá‰ª∂
                    addCsvFile(file, fileData, fileName);

                    // Â¶ÇÊûúÊèê‰æõ‰∫ÜÊñá‰ª∂Âè•ÊüÑÔºåÊõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØ
                    if (fileHandle && csvFiles.length > 0) {
                        const lastIndex = csvFiles.length - 1;
                        csvFiles[lastIndex].fileHandle = fileHandle;
                    }

                    // Â¶ÇÊûúÊòØÁ¨¨‰∏Ä‰∏™Êñá‰ª∂ÔºåÊõ¥Êñ∞UIÊòæÁ§∫
                    if (csvFiles.length === 1) {
                        updateUIForFirstFile(file, fileData, fileName);
                    }

                } catch (error) {
                    console.error('Â§ÑÁêÜÊñá‰ª∂Êó∂Âá∫Èîô:', error);
                    throw error;
                }
            }

            // ÈÄâÊã©Êñá‰ª∂ÔºàÂ∏¶ÊùÉÈôêÔºâ- ‰øùÊåÅÂêëÂêéÂÖºÂÆπ
            async function selectFileWithPermission() {
                try {
                    if ('showOpenFilePicker' in window) {
                        // ‰ΩøÁî®Áé∞‰ª£ File System Access API
                        const pickerOptions = {
                            types: [
                                {
                                    description: 'CSV files',
                                    accept: {
                                        'text/csv': ['.csv'],
                                    },
                                },
                            ],
                            multiple: false,
                        };

                        // ËÆæÁΩÆÈªòËÆ§ÊâìÂºÄÁõÆÂΩï
                        if (lastOpenedFileHandle) {
                            // Â¶ÇÊûúÊúâ‰∏äÊ¨°ÊâìÂºÄÁöÑÊñá‰ª∂Ôºå‰ªéËØ•Êñá‰ª∂ÊâÄÂú®ÁõÆÂΩïÂºÄÂßã
                            pickerOptions.startIn = lastOpenedFileHandle;
                        } else {
                            // Âê¶ÂàôÈªòËÆ§ÊâìÂºÄDownloadsÁõÆÂΩï
                            pickerOptions.startIn = 'downloads';
                        }

                        const [fileHandle] = await window.showOpenFilePicker(pickerOptions);

                        // Ëé∑ÂèñÊñá‰ª∂Âπ∂Â§ÑÁêÜ
                        const file = await fileHandle.getFile();

                        // ‰øùÂ≠òÊñá‰ª∂Âè•ÊüÑ
                        rememberedFileHandle = fileHandle;

                        // Â§ÑÁêÜÊñá‰ª∂
                        handleFile(file, false);

                        // ËÆ∞ÂΩïÊúÄÂêéÊâìÂºÄÁöÑÊñá‰ª∂Ë∑ØÂæÑ
                        lastOpenedFileHandle = fileHandle;
                        console.log('Â∑≤ËÆ∞ÂΩïÊúÄÂêéÊâìÂºÄÊñá‰ª∂Ë∑ØÂæÑ:', lastOpenedFileHandle.name);

                        showToast('‚úÖ Êñá‰ª∂ÂØºÂÖ•ÊàêÂäü', 'success', { duration: 4000 });
                    } else {
                        // ÂõûÈÄÄÂà∞‰º†ÁªüÊñπÂºè
                        fileInput.click();
                    }
                } catch (error) {
                    if (error.name === 'AbortError') {
                        // Áî®Êà∑ÂèñÊ∂à‰∫ÜÈÄâÊã©
                        return;
                    }
                    console.error('Êñá‰ª∂ÈÄâÊã©ÈîôËØØ:', error);
                    showToast('‚ùå Êñá‰ª∂ÈÄâÊã©Â§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error', { duration: 6000 });
                }
            }

            // Âà∑Êñ∞ÊâÄÊúâÊñá‰ª∂
            async function refreshAllFiles() {
                if (csvFiles.length === 0) {
                    showToast('Ê≤°ÊúâÂèØÂà∑Êñ∞ÁöÑÊñá‰ª∂', 'warning', { duration: 3000 });
                    return;
                }

                showToast(`Ê≠£Âú®Âà∑Êñ∞ ${csvFiles.length} ‰∏™Êñá‰ª∂...`, 'info', { duration: 3000 });

                // Êî∂ÈõÜÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉÁöÑÊñá‰ª∂
                const filesNeedingPermission = [];
                const refreshedFiles = [];
                const failedFiles = [];

                // ÈÄê‰∏™Ê£ÄÊü•Êñá‰ª∂ÊùÉÈôê
                for (let i = 0; i < csvFiles.length; i++) {
                    const fileInfo = csvFiles[i];

                    try {
                        if (typeof fileInfo.fileHandle.getFile === 'function') {
                            // ËøôÊòØ FileSystemFileHandleÔºåÊúâÊåÅ‰πÖÊùÉÈôê
                            const file = await fileInfo.fileHandle.getFile();
                            const fileContent = await file.text();

                            // ÈáçÊñ∞Ëß£ÊûêCSVÊï∞ÊçÆ
                            const parsedData = parseCSV(fileContent);

                            // È™åËØÅÊñ∞Êï∞ÊçÆÁªìÊûÑÊòØÂê¶‰∏éÂéüÊï∞ÊçÆ‰∏ÄËá¥
                            if (validateDataStructure(parsedData, fileInfo.data)) {
                                fileInfo.data = parsedData;
                                refreshedFiles.push({
                                    index: i,
                                    name: fileInfo.displayName,
                                    success: true
                                });

                                // Â¶ÇÊûúÊòØÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñá‰ª∂ÔºåÊõ¥Êñ∞È¢ÑËßà
                                if (i === currentFileIndex) {
                                    csvData = parsedData;
                                    previewData();
                                }
                            } else {
                                failedFiles.push({
                                    index: i,
                                    name: fileInfo.displayName,
                                    reason: 'Êï∞ÊçÆÁªìÊûÑÂèëÁîüÂèòÂåñ'
                                });
                            }
                        } else {
                            // ËøôÊòØÊôÆÈÄö File ÂØπË±°ÔºàÊãñÊãΩÂØºÂÖ•ÁöÑÔºâÔºåÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉ
                            filesNeedingPermission.push({
                                index: i,
                                name: fileInfo.displayName,
                                fileInfo: fileInfo
                            });
                        }
                    } catch (error) {
                        console.error(`Âà∑Êñ∞Êñá‰ª∂ ${fileInfo.displayName} Êó∂Âá∫Èîô:`, error);

                        let reason = 'Âà∑Êñ∞Â§±Ë¥•';
                        if (error.name === 'NotAllowedError' || error.message.includes('permission')) {
                            reason = 'ÊùÉÈôê‰∏çË∂≥';
                        } else if (error.name === 'NotFoundError') {
                            reason = 'Êñá‰ª∂‰∏çÂ≠òÂú®';
                        } else if (error.message.includes('read')) {
                            reason = 'Êó†Ê≥ïËØªÂèñÊñá‰ª∂';
                        }

                        failedFiles.push({
                            index: i,
                            name: fileInfo.displayName,
                            reason: reason
                        });
                    }
                }

                // ÊòæÁ§∫Âà∑Êñ∞ÁªìÊûú
                let resultMessage = '';

                if (refreshedFiles.length > 0) {
                    resultMessage += `ÊàêÂäüÂà∑Êñ∞ ${refreshedFiles.length} ‰∏™Êñá‰ª∂\n`;
                    refreshedFiles.forEach(file => {
                        resultMessage += `‚úì ${file.name}\n`;
                    });
                }

                if (filesNeedingPermission.length > 0) {
                    resultMessage += `\nÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉÁöÑÊñá‰ª∂:\n`;
                    filesNeedingPermission.forEach(file => {
                        resultMessage += `‚ö† ${file.name}\n`;
                    });

                    // ÊòæÁ§∫ÊéàÊùÉÂØπËØùÊ°Ü
                    setTimeout(() => {
                        requestFilesPermission(filesNeedingPermission);
                    }, 1000);
                }

                if (failedFiles.length > 0) {
                    resultMessage += `\nÂà∑Êñ∞Â§±Ë¥•ÁöÑÊñá‰ª∂:\n`;
                    failedFiles.forEach(file => {
                        resultMessage += `‚úó ${file.name} (${file.reason})\n`;
                    });
                }

                // Â¶ÇÊûúÊúâÊàêÂäüÂà∑Êñ∞ÁöÑÊñá‰ª∂ÔºåÈáçÊñ∞ÁîüÊàêÂõæË°®
                if (refreshedFiles.length > 0 && chart) {
                    showToast('Ê≠£Âú®ÈáçÊñ∞ÁîüÊàêÂõæË°®...', 'info', { duration: 2000 });
                    setTimeout(() => {
                        generateChart();
                    }, 500);
                }

                showToast(resultMessage.trim(),
                    failedFiles.length === 0 && filesNeedingPermission.length === 0 ? 'success' :
                    refreshedFiles.length > 0 ? 'warning' : 'error',
                    { duration: Math.max(5000, resultMessage.length * 50) }
                );
            }

            // È™åËØÅÊï∞ÊçÆÁªìÊûÑÊòØÂê¶‰∏ÄËá¥
            function validateDataStructure(newData, originalData) {
                if (!newData || !Array.isArray(newData) || newData.length === 0) {
                    return false;
                }

                // Ê£ÄÊü•Ë°åÊï∞ÂíåÂàóÊï∞ÊòØÂê¶‰∏ÄËá¥
                if (newData.length !== originalData.length) {
                    return false;
                }

                if (originalData.length > 0 && newData[0].length !== originalData[0].length) {
                    return false;
                }

                return true;
            }

            // ËØ∑Ê±ÇÂ§ö‰∏™Êñá‰ª∂ÁöÑÊùÉÈôê
            async function requestFilesPermission(filesNeedingPermission) {
                if (!('showOpenFilePicker' in window)) {
                    showToast('ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÊ≠§ÂäüËÉΩÔºåËØ∑‰ΩøÁî®ChromeÊàñEdgeÊµèËßàÂô®', 'warning', { duration: 6000 });
                    return;
                }

                try {
                    // ‰∏∫ÊØè‰∏™ÈúÄË¶ÅÊéàÊùÉÁöÑÊñá‰ª∂ÂàõÂª∫Êñá‰ª∂ÈÄâÊã©Âô®
                    const handles = [];

                    for (const file of filesNeedingPermission) {
                        showToast(`ËØ∑ÈÄâÊã©Êñá‰ª∂‰ª•ÊõøÊç¢ "${file.name}"`, 'info', { duration: 3000 });

                        const pickerOptions = {
                            multiple: false,
                            types: [
                                {
                                    description: 'CSV files',
                                    accept: {
                                        'text/csv': ['.csv'],
                                        'application/vnd.ms-excel': ['.csv'],
                                        'text/plain': ['.csv']
                                    }
                                }
                            ]
                        };

                        // ËÆæÁΩÆÈªòËÆ§ÊâìÂºÄÁõÆÂΩï
                        if (lastOpenedFileHandle) {
                            pickerOptions.startIn = lastOpenedFileHandle;
                        } else {
                            pickerOptions.startIn = 'downloads';
                        }

                        const fileHandles = await window.showOpenFilePicker(pickerOptions);

                        if (fileHandles.length > 0) {
                            handles.push({
                                originalIndex: file.index,
                                handle: fileHandles[0]
                            });
                        }
                    }

                    // Â§ÑÁêÜËé∑ÂèñÂà∞ÁöÑÊñ∞Êñá‰ª∂Âè•ÊüÑ
                    for (const { originalIndex, handle } of handles) {
                        const file = await handle.getFile();
                        const fileContent = await file.text();
                        const parsedData = parseCSV(fileContent);

                        // È™åËØÅÊï∞ÊçÆÁªìÊûÑ
                        if (validateDataStructure(parsedData, csvFiles[originalIndex].data)) {
                            // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØ
                            csvFiles[originalIndex].data = parsedData;
                            csvFiles[originalIndex].fileHandle = handle;
                            csvFiles[originalIndex].file = file;
                            csvFiles[originalIndex].fileName = file.name;

                            // Â¶ÇÊûúÊòØÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñá‰ª∂ÔºåÊõ¥Êñ∞È¢ÑËßà
                            if (originalIndex === currentFileIndex) {
                                csvData = parsedData;
                                previewData();
                            }

                            showToast(`Êñá‰ª∂ "${csvFiles[originalIndex].displayName}" Â∑≤ÈáçÊñ∞ÊéàÊùÉÂπ∂Âà∑Êñ∞`, 'success', { duration: 3000 });
                        } else {
                            showToast(`Êñá‰ª∂ "${file.name}" ÁöÑÊï∞ÊçÆÁªìÊûÑ‰∏éÂéüÊñá‰ª∂‰∏çÂåπÈÖç`, 'error', { duration: 5000 });
                        }
                    }

                    // Â¶ÇÊûúÊúâÊñá‰ª∂Ë¢´ÊàêÂäüÈáçÊñ∞ÊéàÊùÉÔºåÈáçÊñ∞ÁîüÊàêÂõæË°®
                    if (handles.length > 0) {
                        setTimeout(() => {
                            generateChart();
                        }, 500);
                    }

                } catch (error) {
                    if (error.name !== 'AbortError') {
                        console.error('Ëé∑ÂèñÊñá‰ª∂ÊùÉÈôêÊó∂Âá∫Èîô:', error);
                        showToast('Ëé∑ÂèñÊñá‰ª∂ÊùÉÈôêÂ§±Ë¥•', 'error', { duration: 5000 });
                    }
                }
            }

            // Âà∑Êñ∞ÂΩìÂâçÊñá‰ª∂Ôºà‰øùÊåÅÂêëÂêéÂÖºÂÆπÔºâ
            async function refreshCurrentFile() {
                if (!rememberedFileHandle) {
                    showToast('Ê≤°ÊúâËÆ∞‰ΩèÁöÑÊñá‰ª∂ÔºåËØ∑ÂÖàÂØºÂÖ•Êñá‰ª∂', 'error', { duration: 7000 });
                    return;
                }

                showToast('Ê≠£Âú®ÈáçÊñ∞ËØªÂèñÊñá‰ª∂...', 'info', { duration: 3000 });

                try {
                    // Ê£ÄÊü•Êñá‰ª∂Âè•ÊüÑÁ±ªÂûã
                    if (typeof rememberedFileHandle.getFile === 'function') {
                        // ËøôÊòØ FileSystemFileHandleÔºåÊúâÊåÅ‰πÖÊùÉÈôê
                        console.log('‰ΩøÁî®ÊúâÊùÉÈôêÁöÑÊñá‰ª∂Âè•ÊüÑÂà∑Êñ∞Êñá‰ª∂');
                        const file = await rememberedFileHandle.getFile();
                        const fileContent = await file.text();
                        processFileData(file.name, fileContent);
                        showToast('Êñá‰ª∂Âà∑Êñ∞ÊàêÂäü', 'success', { duration: 4000 });
                        return;
                    } else {
                        // ËøôÊòØÊôÆÈÄö File ÂØπË±°ÔºàÊãñÊãΩÂØºÂÖ•ÁöÑÔºâÔºåÊó†Ê≥ïÂà∑Êñ∞
                        console.log('Ê£ÄÊµãÂà∞ÊãñÊãΩÂØºÂÖ•ÁöÑÊñá‰ª∂ÔºåÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉ');
                        showToast('ÂΩìÂâçÊñá‰ª∂ÊòØÊãñÊãΩÂØºÂÖ•ÁöÑÔºåÈúÄË¶ÅÈáçÊñ∞Ëé∑ÂèñÊùÉÈôêÊâçËÉΩÂà∑Êñ∞', 'info', { duration: 2000 });
                        // Á´ãÂç≥ËØ∑Ê±ÇÊùÉÈôêÔºåÊó†ÈúÄÁ≠âÂæÖ
                        requestFilePermission();
                        return;
                    }

                } catch (error) {
                    console.error('Êñá‰ª∂Âà∑Êñ∞ÈîôËØØ:', error);

                    // ÂàÜÊûêÈîôËØØÁ±ªÂûãÂπ∂ÁªôÂá∫Áõ∏Â∫îÊèêÁ§∫
                    if (error.name === 'NotAllowedError' || error.message.includes('permission')) {
                        showToast('Êñá‰ª∂ËÆøÈóÆÊùÉÈôê‰∏çË∂≥ÔºåÈúÄË¶ÅÈáçÊñ∞ÊéàÊùÉ', 'warning', { duration: 3000 });
                        // Á´ãÂç≥ËØ∑Ê±ÇÊùÉÈôêÔºåÊó†ÈúÄÁ≠âÂæÖ
                        requestFilePermission();
                    } else if (error.name === 'NotFoundError') {
                        showToast('ÂéüÊñá‰ª∂Â∑≤‰∏çÂ≠òÂú®ÔºåËØ∑ÈáçÊñ∞ÂØºÂÖ•Êñá‰ª∂', 'error', { duration: 8000 });
                        rememberedFileHandle = null; // Ê∏ÖÈô§Êó†ÊïàÁöÑÊñá‰ª∂ÂºïÁî®
                    } else if (error.message.includes('read')) {
                        showToast('Êó†Ê≥ïËØªÂèñÊñá‰ª∂ÔºåÂèØËÉΩÊñá‰ª∂Â∑≤Ë¢´ÁßªÂä®ÊàñÂà†Èô§', 'error', { duration: 8000 });
                    } else {
                        showToast(`Âà∑Êñ∞Êñá‰ª∂Êó∂Âá∫Èîô: ${error.message}`, 'error', { duration: 10000 });
                    }
                }
            }

            // ËØ∑Ê±ÇÊñá‰ª∂ÊùÉÈôê
            async function requestFilePermission() {
                if (!('showOpenFilePicker' in window)) {
                    showToast('ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÊ≠§ÂäüËÉΩÔºåËØ∑‰ΩøÁî®ChromeÊàñEdgeÊµèËßàÂô®', 'warning', { duration: 6000 });
                    return;
                }

                try {
                    showToast('Ê≠£Âú®ËØ∑Ê±ÇÊñá‰ª∂ËÆøÈóÆÊùÉÈôê...', 'info', { duration: 3000 });

                    // Ëé∑ÂèñÂéüÊñá‰ª∂Âêç
                    const fileName = rememberedFileHandle.name || rememberedFileHandle;
                    if (!fileName) {
                        throw new Error('Êó†Ê≥ïËé∑ÂèñÊñá‰ª∂Âêç‰ø°ÊÅØ');
                    }

                    // Á°ÆÂÆöËµ∑ÂßãÁõÆÂΩïÔºö‰ºòÂÖà‰ΩøÁî®ÊúÄÂêéÊâìÂºÄÁöÑÊñá‰ª∂Ë∑ØÂæÑÔºåÂÖ∂Ê¨°‰ΩøÁî®ËÆ∞‰ΩèÁöÑÁõÆÂΩïÁ±ªÂûãÔºåÊúÄÂêé‰ΩøÁî®Downloads
                    let startInDirectory;
                    if (lastOpenedFileHandle) {
                        startInDirectory = lastOpenedFileHandle;
                    } else if (rememberedFileDirectory && rememberedFileDirectory !== 'documents') {
                        startInDirectory = rememberedFileDirectory;
                    } else {
                        startInDirectory = 'downloads';
                    }

                    // Ëé∑ÂèñÁõÆÂΩïÁöÑ‰∏≠ÊñáÂêçÁß∞
                    const directoryNames = {
                        'desktop': 'Ê°åÈù¢',
                        'downloads': '‰∏ãËΩΩ',
                        'documents': 'ÊñáÊ°£',
                        'pictures': 'ÂõæÁâá',
                        'videos': 'ËßÜÈ¢ë',
                        'music': 'Èü≥‰πê'
                    };

                    let directoryName;
                    if (startInDirectory === lastOpenedFileHandle) {
                        directoryName = '‰∏äÊ¨°ÊâìÂºÄÊñá‰ª∂ÊâÄÂú®ÁõÆÂΩï';
                    } else {
                        directoryName = directoryNames[startInDirectory] || '‰∏ãËΩΩ';
                    }

                    showToast(`ËØ∑ÈáçÊñ∞ÈÄâÊã©Âêå‰∏Ä‰∏™Êñá‰ª∂‰ª•Ëé∑ÂèñÊùÉÈôê:<br><strong>${fileName}</strong><br><small>Êñá‰ª∂ÈÄâÊã©Âô®Â∞ÜËá™Âä®ÊâìÂºÄ <strong>${directoryName}</strong> ÁõÆÂΩï</small>`, 'info', { duration: 10000 });

                    const pickerOptions = {
                        types: [
                            {
                                description: 'CSV files',
                                accept: {
                                    'text/csv': ['.csv'],
                                },
                            },
                        ],
                        multiple: false,
                        startIn: startInDirectory
                    };

                    const [fileHandle] = await window.showOpenFilePicker(pickerOptions);

                    // È™åËØÅÈÄâÊã©ÁöÑÊñá‰ª∂ÊòØÂê¶‰∏éÂéüÊñá‰ª∂ÂåπÈÖç
                    if (fileHandle.name !== fileName) {
                        const directoryNames = {
                            'desktop': 'Ê°åÈù¢',
                            'downloads': '‰∏ãËΩΩ',
                            'documents': 'ÊñáÊ°£',
                            'pictures': 'ÂõæÁâá',
                            'videos': 'ËßÜÈ¢ë',
                            'music': 'Èü≥‰πê'
                        };

                        const currentDirectory = directoryNames[startInDirectory] || 'ÊñáÊ°£';
                        showToast('Êñá‰ª∂Âêç‰∏çÂåπÈÖç<br><small>ËØ∑ÈáçÊñ∞ÈÄâÊã©ÔºåÊñá‰ª∂Âêç‰∏∫Ôºö<strong>' + fileName + '</strong><br>Â∫îËØ•Âú® <strong>' + currentDirectory + '</strong> ÁõÆÂΩï‰∏≠</small>', 'warning', { duration: 12000 });
                        return;
                    }

                    // ËØ∑Ê±ÇÊåÅ‰πÖÂåñÊùÉÈôê
                    let hasPermission = false;
                    if ('requestPermission' in fileHandle) {
                        try {
                            const permission = await fileHandle.requestPermission({ mode: 'read' });
                            hasPermission = (permission === 'granted');
                        } catch (permError) {
                            console.warn('ÊùÉÈôêËØ∑Ê±ÇÂ§±Ë¥•:', permError);
                            hasPermission = false;
                        }
                    }

                    // ‰øùÂ≠òÊñ∞ÁöÑÊñá‰ª∂Âè•ÊüÑÔºàÊúâÊùÉÈôêÊàñÊó†ÊùÉÈôêÔºâ
                    rememberedFileHandle = fileHandle;
                    rememberedFileDirectory = detectFileDirectory(fileHandle.name);
                    lastOpenedFileHandle = fileHandle; // ÂêåÊó∂Êõ¥Êñ∞ÊúÄÂêéÊâìÂºÄÁöÑÊñá‰ª∂Ë∑ØÂæÑ

                    // ÈáçÊñ∞ËØªÂèñÊñá‰ª∂
                    const file = await fileHandle.getFile();
                    const fileContent = await file.text();
                    processFileData(file.name, fileContent);

                    // Ê†πÊçÆÊùÉÈôêÊÉÖÂÜµÊòæÁ§∫ÊèêÁ§∫
                    if (hasPermission) {
                        showToast('ÊùÉÈôêËé∑ÂèñÊàêÂäüÔºåÊñá‰ª∂Â∑≤Âà∑Êñ∞Ôºå‰∏ãÊ¨°Âà∑Êñ∞Êó†ÈúÄÈáçÊñ∞ÊéàÊùÉ', 'success', { duration: 5000 });
                    } else {
                        showToast('Êñá‰ª∂Â∑≤Âà∑Êñ∞Ôºå‰ΩÜ‰∏ãÊ¨°Âà∑Êñ∞ÂèØËÉΩ‰ªçÈúÄÊéàÊùÉ', 'warning', { duration: 6000 });
                    }

                } catch (error) {
                    console.error('ËØ∑Ê±ÇÊñá‰ª∂ÊùÉÈôêÂ§±Ë¥•:', error);
                    if (error.name !== 'AbortError') {
                        showToast('ËØ∑Ê±ÇÊñá‰ª∂ÊùÉÈôêÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error', { duration: 7000 });
                    }
                }
            }

            // Â§ÑÁêÜÊñá‰ª∂Êï∞ÊçÆÔºàÁî®‰∫éÂà∑Êñ∞Ôºâ
            function processFileData(fileName, fileContent) {
                try {
                    console.log('ÂºÄÂßãÂ§ÑÁêÜÊñá‰ª∂:', fileName);
                    console.log('Êñá‰ª∂ÂÜÖÂÆπÈïøÂ∫¶:', fileContent.length);

                    // ËÆæÁΩÆÊñá‰ª∂Âêç
                    csvFileName = fileName.replace(/\.[^/.]+$/, "");

                    // Ëß£ÊûêCSVÊï∞ÊçÆ
                    csvData = parseCSV(fileContent);
                    console.log('Ëß£ÊûêÂêéÁöÑCSVÊï∞ÊçÆË°åÊï∞:', csvData.length);

                    if (csvData.length === 0) {
                        throw new Error('CSVÊñá‰ª∂‰∏∫Á©∫ÊàñÊ†ºÂºè‰∏çÊ≠£Á°Æ');
                    }

                    // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫‰∏ä‰º†Âå∫Âüü
                    if (uploadPrompt.classList.contains('hidden')) {
                        // Êõ¥Êñ∞Êñá‰ª∂ÂêçÊòæÁ§∫ÂíåÊñá‰ª∂‰ø°ÊÅØ
                        updateFileInfoForRefresh(fileName, csvData);
                    } else {
                        // È¶ñÊ¨°Âä†ËΩΩÔºåÊòæÁ§∫‰∏ä‰º†Âå∫Âüü
                        uploadPrompt.classList.add('hidden');
                        uploadSection.classList.add('has-file');
                        document.getElementById('fileName').textContent = `È¢ÑËßà: ${fileName}`;
                        dataPreviewSection.classList.remove('hidden');
                        configSection.classList.remove('hidden');
                        setDefaultConfigOnly();
                    }


                    // È¢ÑËßàÊï∞ÊçÆ
                    previewData();

                    // Â¶ÇÊûúÂõæË°®Â∑≤ÁîüÊàêÔºåËá™Âä®ÈáçÊñ∞ÁîüÊàêÂä®Áîª
                    if (chart && !chartSection.classList.contains('hidden')) {
                        setTimeout(() => {
                            generateChart();
                        }, 500);
                    }
                } catch (error) {
                    console.error('Êñá‰ª∂Â§ÑÁêÜÈîôËØØËØ¶ÊÉÖ:', error);
                    showToast(`Â§ÑÁêÜÊñá‰ª∂Êó∂Âá∫Èîô: ${error.message}`, 'error', { duration: 10000 });
                }
            }

            // Â§ÑÁêÜÊñá‰ª∂
            function handleFile(file, isDragged = false) {
                if (!file.name.endsWith('.csv')) {
                    showToast('ËØ∑‰∏ä‰º† CSVÊ†ºÂºèÁöÑÊñá‰ª∂', 'error', { duration: 4000 });
                    return;
                }

                // ÂèñÊ∂à‰πãÂâçÁöÑËß£Êûê‰ªªÂä°
                if (parseAbortController) {
                    parseAbortController.abort();
                }
                parseAbortController = new AbortController();

                // Á¶ÅÁî®È°µÈù¢Âπ∂ÊòæÁ§∫Ëß£ÊûêËøõÂ∫¶
                mainContainer.classList.add('page-disabled');
                const parseToast = showToast('Ê≠£Âú®Ëß£ÊûêÊñá‰ª∂ÔºåËØ∑Á®çÂÄô...', 'info', {
                    persistent: true,
                    showCancel: true,
                    onCancel: () => {
                        if (parseAbortController) {
                            parseAbortController.abort();
                            parseAbortController = null;
                        }
                        mainContainer.classList.remove('page-disabled');
                    }
                });

                // Â≠òÂÇ®Êñá‰ª∂Âêç
                const rawFileName = file.name;
                csvFileName = rawFileName.replace(/\.[^/.]+$/, "");

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÂèñÊ∂à
                        if (parseAbortController.signal.aborted) {
                            return;
                        }

                        const fileContent = e.target.result;

                        // Êõ¥Êñ∞CSVËß£ÊûêÂáΩÊï∞ÔºåÂ§ÑÁêÜÊú´Â∞æÁ©∫ÂÄº
                        csvData = parseCSV(fileContent);

                        if (csvData.length === 0) {
                            throw new Error('CSVÊñá‰ª∂‰∏∫Á©∫ÊàñÊ†ºÂºè‰∏çÊ≠£Á°Æ');
                        }

                        // Ê∑ªÂä†Á¨¨‰∏Ä‰∏™Êñá‰ª∂Âà∞Â§öÊñá‰ª∂Á≥ªÁªü
                        const fileName = rawFileName.replace(/\.[^/.]+$/, "");
                        addCsvFile(file, csvData, fileName);

                        // Êõ¥Êñ∞UI
                        uploadPrompt.classList.add('hidden');
                        uploadSection.classList.add('has-file');
                        fileName.textContent = `È¢ÑËßà: ${rawFileName}`;
                        dataPreviewSection.classList.remove('hidden');

                        // È¢ÑËßàÊï∞ÊçÆ
                        previewData();

                        // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫
                        updateFileInfo(file, csvData);

                        // ÊòæÁ§∫ËÆæÁΩÆÂå∫Âüü
                        configSection.classList.remove('hidden');

                        // Âè™ÈáçÁΩÆÈªòËÆ§ËÆæÁΩÆÔºå‰øùÁïôÊâãÂä®ËÆæÁΩÆ
                        setDefaultConfigOnly();

                        // ÊãñÊãΩÊñá‰ª∂Êó∂ÁöÑÁâπÊÆäÂ§ÑÁêÜÔºàÂè™ÊúâÊãñÊãΩÊñá‰ª∂Êó∂ÊâçÈúÄË¶ÅÊ£ÄÊü•ÊùÉÈôêÂÜ≤Á™ÅÔºâ
                        if (isDragged && rememberedFileHandle && typeof rememberedFileHandle.getFile === 'function') {
                            // ÂΩìÂâçÂ∑≤ÊúâÊéàÊùÉÊñá‰ª∂ÔºàFileSystemFileHandleÔºâÔºåËØ¢ÈóÆÁî®Êà∑ÊòØÂê¶Ë¶ÅÊõøÊç¢
                            const currentFileName = rememberedFileHandle.name;
                            const newFileName = file.name;

                            const message = `‚ö†Ô∏è Ê£ÄÊµãÂà∞ÈáçË¶ÅÊèêÈÜíÔºö\n\n` +
                                `ÂΩìÂâçÊñá‰ª∂ "${currentFileName}" ÂÖ∑ÊúâÊåÅ‰πÖËÆøÈóÆÊùÉÈôêÔºåÂà∑Êñ∞Êó∂Êó†ÈúÄÈáçÊñ∞ÈÄâÊã©„ÄÇ\n\n` +
                                `ÊãñÂÖ•Êñ∞Êñá‰ª∂ "${newFileName}" Â∞ÜÔºö\n` +
                                `‚Ä¢ Â§±ÂéªÊåÅ‰πÖËÆøÈóÆÊùÉÈôê\n` +
                                `‚Ä¢ Âà∑Êñ∞Êó∂ÈúÄË¶ÅÈáçÊñ∞ÈÄâÊã©Êñá‰ª∂\n\n` +
                                `ÊòØÂê¶Ë¶ÅÁªßÁª≠ÊãñÂÖ•Êìç‰ΩúÔºü\n\n` +
                                `‚Ä¢ Á°ÆÂÆöÔºö‰ΩøÁî®Êñ∞Êñá‰ª∂ÔºàÂ§±ÂéªÊåÅ‰πÖÊùÉÈôêÔºâ\n` +
                                `‚Ä¢ ÂèñÊ∂àÔºö‰øùÁïôÂéüÊñá‰ª∂ÔºàÁª¥ÊåÅÊåÅ‰πÖÊùÉÈôêÔºâ`;

                            if (!confirm(message)) {
                                // Áî®Êà∑ÂèñÊ∂àÔºå‰øùÁïôÂéüÊéàÊùÉÊñá‰ª∂
                                showToast(`‚úÖ Â∑≤‰øùÁïôÂéüÊñá‰ª∂: ${currentFileName}`, 'success', { duration: 4000 });
                                removeToast(parseToast);
                                mainContainer.classList.remove('page-disabled');
                                parseAbortController = null;
                                return;
                            }

                            // Áî®Êà∑Á°ÆËÆ§ÔºåÊõøÊç¢‰∏∫ÊãñÂÖ•Êñá‰ª∂
                            showToast(`‚ö†Ô∏è Â∑≤ÂàáÊç¢Âà∞ÊãñÂÖ•Êñá‰ª∂: ${newFileName}ÔºåÊåÅ‰πÖÊùÉÈôêÂ∑≤Ê∏ÖÈô§`, 'warning', { duration: 6000 });
                        }

                        // Âè™ÊúâÊãñÊãΩÊñá‰ª∂Êó∂Êâç‰øùÂ≠òÊñá‰ª∂ÂºïÁî®ÔºàÊåâÈíÆÂØºÂÖ•ÁöÑÊñá‰ª∂Â∑≤Âú® selectFileWithPermission ‰∏≠‰øùÂ≠òÔºâ
                        if (isDragged) {
                            rememberedFileHandle = file;
                            rememberedFileDirectory = detectFileDirectory(file.name);
                            console.log('ÊãñÂÖ•Êñá‰ª∂Â∑≤‰øùÂ≠ò:', file.name);
                            console.log('Êñá‰ª∂Âè•ÊüÑÁ±ªÂûã:', file.constructor.name);
                        }

                        // ÁßªÈô§Ëß£ÊûêËøõÂ∫¶ÊèêÁ§∫
                        removeToast(parseToast);
                        mainContainer.classList.remove('page-disabled');
                        parseAbortController = null;

                        showToast('Êñá‰ª∂‰∏ä‰º†ÊàêÂäüÔºåËØ∑ËÆæÁΩÆÂèÇÊï∞', 'success', { duration: 4000 });

                        // Â¶ÇÊûúÂõæË°®Â∑≤ÁîüÊàêÔºåËá™Âä®ÈáçÊñ∞ÁîüÊàêÂä®Áîª
                        if (chart && !chartSection.classList.contains('hidden')) {
                            setTimeout(() => {
                                generateChart();
                            }, 500);
                        }
                    } catch (error) {
                        console.error('Êñá‰ª∂Â§ÑÁêÜÈîôËØØËØ¶ÊÉÖ:', error);
                        // ÁßªÈô§Ëß£ÊûêËøõÂ∫¶ÊèêÁ§∫
                        removeToast(parseToast);
                        mainContainer.classList.remove('page-disabled');
                        parseAbortController = null;

                        let errorMessage = `Ëß£ÊûêCSVÊñá‰ª∂Êó∂Âá∫Èîô: ${error.message}`;

                        // Â¶ÇÊûúÊòØÊùÉÈôêÈîôËØØÔºåÊèê‰æõÊõ¥ËØ¶ÁªÜÁöÑËØ¥Êòé
                        if (error.name === 'NotAllowedError') {
                            errorMessage = 'Êñá‰ª∂ËÆøÈóÆÊùÉÈôêË¢´ÊãíÁªùÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂ÊùÉÈôêÊàñÈáçÊñ∞ÈÄâÊã©Êñá‰ª∂';
                        } else if (error.message.includes('permission')) {
                            errorMessage = 'Êñá‰ª∂ÊùÉÈôê‰∏çË∂≥ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂ÊùÉÈôêÊàñÈáçÊñ∞ÈÄâÊã©Êñá‰ª∂';
                        }

                        showToast(errorMessage, 'error', { duration: 10000 });
                    }
                };

                reader.onerror = function() {
                    console.error('Êñá‰ª∂ËØªÂèñÈîôËØØ:', reader.error);
                    removeToast(parseToast);
                    mainContainer.classList.remove('page-disabled');
                    parseAbortController = null;

                    let errorMessage = 'Êñá‰ª∂ËØªÂèñÂ§±Ë¥•';
                    if (reader.error) {
                        errorMessage += `: ${reader.error.message}`;
                    }

                    // Â¶ÇÊûúÊòØÊùÉÈôêÈîôËØØÔºåÊèê‰æõÊõ¥ËØ¶ÁªÜÁöÑËØ¥Êòé
                    if (reader.error && reader.error.name === 'NotAllowedError') {
                        errorMessage = 'Êñá‰ª∂ËÆøÈóÆÊùÉÈôêË¢´ÊãíÁªùÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂ÊùÉÈôêÊàñÈáçÊñ∞ÈÄâÊã©Êñá‰ª∂';
                    } else if (reader.error && reader.error.message.includes('permission')) {
                        errorMessage = 'Êñá‰ª∂ÊùÉÈôê‰∏çË∂≥ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂ÊùÉÈôêÊàñÈáçÊñ∞ÈÄâÊã©Êñá‰ª∂';
                    }

                    showToast(errorMessage, 'error', { duration: 10000 });
                };

                reader.readAsText(file);
            }

            // ‰øÆÊîπÂêéÁöÑCSVËß£ÊûêÂáΩÊï∞ - Â§ÑÁêÜÊú´Â∞æÁ©∫ÂÄº
            function parseCSV(text) {
                const rows = text.split('\n').map(row => {
                    // ÂàÜÂâ≤Ë°åÂπ∂ÂéªÈô§Á©∫Ê†º
                    let cells = row.split(',').map(cell => cell.trim());

                    // ÁßªÈô§Ë°åÊú´Â∞æÁöÑÁ©∫ÂÄºÔºàÁî±‰∫éÈÄóÂè∑ÂØºËá¥ÁöÑÁ©∫ÂÄºÔºâ
                    while (cells.length > 0 && (cells[cells.length - 1] === '' || cells[cells.length - 1] === 'NaN')) {
                        cells.pop();
                    }

                    return cells;
                });

                // ËøáÊª§ÊéâÁ©∫Ë°å
                return rows.filter(row => row.length > 0);
            }

            // Ê†ºÂºèÂåñÊñá‰ª∂Â§ßÂ∞èÊòæÁ§∫
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';

                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));

                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫ÔºàÂà∑Êñ∞Êó∂‰ΩøÁî®ÔºåÊó†Êñá‰ª∂Â§ßÂ∞è‰ø°ÊÅØÔºâ
            function updateFileInfoForRefresh(fileName, data) {
                // ËÆ°ÁÆóÊñá‰ª∂‰ø°ÊÅØ
                const rowCount = data.length;
                const colCount = data.length > 0 ? data[0].length : 0;

                // Êõ¥Êñ∞Êñá‰ª∂ÂêçÊòæÁ§∫ÔºåÊ∑ªÂä†Êñá‰ª∂‰ø°ÊÅØÔºà‰∏çÂê´Êñá‰ª∂Â§ßÂ∞èÔºâ
                fileName.innerHTML = `È¢ÑËßà: ${fileName} <span style="color: #666; font-size: 0.9em; font-weight: normal;">(${rowCount}Ë°å √ó ${colCount}Âàó)</span>`;
            }

            // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØÊòæÁ§∫
            function updateFileInfo(file, data) {
                // ËÆ°ÁÆóÊñá‰ª∂‰ø°ÊÅØ
                const fileSize = formatFileSize(file.size);
                const rowCount = data.length;
                const colCount = data.length > 0 ? data[0].length : 0;

                // Êõ¥Êñ∞Êñá‰ª∂ÂêçÊòæÁ§∫ÔºåÊ∑ªÂä†Êñá‰ª∂‰ø°ÊÅØ
                fileName.innerHTML = `È¢ÑËßà: ${file.name} <span style="color: #666; font-size: 0.9em; font-weight: normal;">(${fileSize} | ${rowCount}Ë°å √ó ${colCount}Âàó)</span>`;
            }

            // È¢ÑËßàÊï∞ÊçÆ - ‰øÆÊîπË°åÂè∑ÂàóÊ†∑Âºè
            function previewData() {
                const previewRows = csvData.slice(0, 50); // Âè™ÊòæÁ§∫Ââç50Ë°å

                let html = '<table><thead><tr>';
                // Ê∑ªÂä†Ë°åÂè∑Ë°®Â§¥ÔºåÂ∫îÁî®Âõ∫ÂÆöÊ†∑Âºè
                html += '<th class="row-number-header"></th>';
                // Ë°®Â§¥
                if (previewRows.length > 0) {
                    for (let i = 0; i < previewRows[0].length; i++) {
                        html += `<th>Âàó ${i + 1}</th>`;
                    }
                }
                html += '</tr></thead><tbody>';

                // Êï∞ÊçÆË°å
                for (let i = 0; i < previewRows.length; i++) {
                    html += '<tr>';
                    // Ê∑ªÂä†Ë°åÂè∑ÔºåÂ∫îÁî®Âõ∫ÂÆöÊ†∑Âºè
                    html += `<td class="row-number">Ë°å${i + 1}</td>`;
                    for (let j = 0; j < previewRows[i].length; j++) {
                        html += `<td>${previewRows[i][j]}</td>`;
                    }
                    html += '</tr>';
                }

                html += '</tbody></table>';
                dataPreview.innerHTML = html;
            }

            // ÈªòËÆ§ËÆæÁΩÆ
            function setDefaultConfig() {
                // ÈáçÁΩÆÊâãÂä®‰øÆÊîπÊ†áËÆ∞
                manuallyModified.clear();

                // ËÆæÁΩÆÈªòËÆ§ÂÄºÂπ∂Â∫îÁî®ÈªòËÆ§Ê†∑Âºè
                function setDefaultValue(element, value) {
                    element.value = value;
                    element.classList.remove('manual-value');
                    element.classList.add('default-value');
                }

                setDefaultValue(xAxisRowInput, '1');
                setDefaultValue(startRowInput, '2');
                setDefaultValue(endRowInput, '-1');
                setDefaultValue(startColInput, '2');
                setDefaultValue(endColInput, '-1');
                setDefaultValue(constantRowsInput, '');
                setDefaultValue(frameIntervalInput, '50');
                setDefaultValue(skipFramesInput, '0');
                setDefaultValue(xMinInput, 'auto');
                setDefaultValue(xMaxInput, 'auto');
                setDefaultValue(yMinInput, 'auto');
                setDefaultValue(yMaxInput, 'auto');
                setDefaultValue(showLegendSelect, 'false');
                setDefaultValue(tooltipModeSelect, 'compact');
                setDefaultValue(xAxisTypeSelect, 'linear');
                setDefaultValue(chartTitleInput, csvFileName || 'Êï∞ÊçÆÂä®Áîª');
                setDefaultValue(yAxisLabelInput, 'YËΩ¥');

                // Êõ¥Êñ∞XËΩ¥Áõ∏ÂÖ≥ÁöÑÈªòËÆ§ÂÄº
                updateXAxisRange();
                updateXAxisLabel();
            }

            // Âè™ÈáçÁΩÆÈªòËÆ§ËÆæÁΩÆÔºå‰øùÁïôÊâãÂä®ËÆæÁΩÆ
            function setDefaultConfigOnly() {
                // ËÆæÁΩÆÈªòËÆ§ÂÄºÁöÑÂáΩÊï∞ÔºàÂè™ÂØπÊú™ÊâãÂä®‰øÆÊîπÁöÑÂ≠óÊÆµËøõË°åËÆæÁΩÆÔºâ
                function setDefaultValueIfNotModified(element, fieldName, value) {
                    if (!manuallyModified.has(fieldName)) {
                        element.value = value;
                        element.classList.remove('manual-value');
                        element.classList.add('default-value');
                    }
                }

                setDefaultValueIfNotModified(xAxisRowInput, 'xAxisRow', '1');
                setDefaultValueIfNotModified(startRowInput, 'startRow', '2');
                setDefaultValueIfNotModified(endRowInput, 'endRow', '-1');
                setDefaultValueIfNotModified(startColInput, 'startCol', '2');
                setDefaultValueIfNotModified(endColInput, 'endCol', '-1');
                setDefaultValueIfNotModified(constantRowsInput, 'constantRows', '');
                setDefaultValueIfNotModified(frameIntervalInput, 'frameInterval', '50');
                setDefaultValueIfNotModified(skipFramesInput, 'skipFrames', '0');
                setDefaultValueIfNotModified(xMinInput, 'xMin', 'auto');
                setDefaultValueIfNotModified(xMaxInput, 'xMax', 'auto');
                setDefaultValueIfNotModified(yMinInput, 'yMin', 'auto');
                setDefaultValueIfNotModified(yMaxInput, 'yMax', 'auto');
                setDefaultValueIfNotModified(showLegendSelect, 'showLegend', 'false');
                setDefaultValueIfNotModified(tooltipModeSelect, 'tooltipMode', 'compact');
                setDefaultValueIfNotModified(xAxisTypeSelect, 'xAxisType', 'linear');
                setDefaultValueIfNotModified(chartTitleInput, 'chartTitle', csvFileName || 'Êï∞ÊçÆÂä®Áîª');
                setDefaultValueIfNotModified(yAxisLabelInput, 'yAxisLabel', 'YËΩ¥');

                // Êõ¥Êñ∞XËΩ¥Áõ∏ÂÖ≥ÁöÑÈªòËÆ§ÂÄºÔºàÂ¶ÇÊûúÊú™ÊâãÂä®‰øÆÊîπÔºâ
                if (!manuallyModified.has('xMin') || !manuallyModified.has('xMax')) {
                    updateXAxisRange();
                }
                if (!manuallyModified.has('xAxisLabel')) {
                    updateXAxisLabel();
                }

                // Êõ¥Êñ∞Âõæ‰æãÊòæÁ§∫ËÆæÁΩÆ
                updateLegendDisplay();
            }

            // ÈáçÁΩÆËÆæÁΩÆ
            function resetConfig() {
                setDefaultConfig();
                showToast('ËÆæÁΩÆÂ∑≤ÈáçÁΩÆ', 'success', { duration: 4000 });
            }

            // Ëß£ÊûêÂ∏∏ÊòæË°åËÆæÁΩÆ
            function parseConstantRows(constantRowsStr) {
                if (!constantRowsStr.trim()) {
                    return [];
                }

                return constantRowsStr.split(',')
                    .map(s => s.trim())
                    .filter(s => s !== '')
                    .map(s => parseInt(s))
                    .filter(n => !isNaN(n))
                    .map(n => {
                        // Â§ÑÁêÜË¥üÊï∞Á¥¢ÂºïÔºàÂÄíÊï∞Ôºâ
                        if (n < 0) {
                            return csvData.length + n; // ËΩ¨Êç¢‰∏∫Ê≠£Á¥¢Âºï
                        } else {
                            return n - 1; // ËΩ¨Êç¢‰∏∫0-basedÁ¥¢Âºï
                        }
                    })
                    .filter(n => n >= 0 && n < csvData.length); // È™åËØÅÁ¥¢ÂºïÊúâÊïàÊÄß
            }

            // ÁîüÊàêÂä®Áîª
            function generateChart() {
                try {
                    // Ê£ÄÊü• Chart.js ÊòØÂê¶Â∑≤Âä†ËΩΩ
                    if (typeof Chart === 'undefined') {
                        // Êèê‰æõËØ¶ÁªÜÁöÑËØäÊñ≠‰ø°ÊÅØ
                        const errorMsg = 'Chart.js Â∫ìÊú™Âä†ËΩΩÂÆåÊàê\n\n' +
                            'ÂèØËÉΩÁöÑÂéüÂõ†Ôºö\n' +
                            '1. ÂõΩÂÜÖÁΩëÁªúËÆøÈóÆ CDN ÂèóÈôê\n' +
                            '2. ÁΩëÁªúÔºàÂÖ¨Âè∏/Â≠¶Ê†°ÔºâÈôêÂà∂‰∫ÜÂ§ñÈÉ®ËµÑÊ∫ê\n' +
                            '3. Èò≤ÁÅ´Â¢ôÊàñÂÆâÂÖ®ËΩØ‰ª∂Ôºà360„ÄÅÁÅ´ÁªíÁ≠âÔºâÈòªÊ≠¢‰∫ÜÂä†ËΩΩ\n' +
                            '4. ÁΩëÁªúËøûÊé•‰∏çÁ®≥ÂÆöÊàñ DNS Ëß£ÊûêÂ§±Ë¥•\n\n' +
                            'Ëß£ÂÜ≥ÊñπÊ°àÔºö\n' +
                            '‚Ä¢ Á≠âÂæÖÂá†ÁßíÂêéÂÜçËØï\n' +
                            '‚Ä¢ Âà∑Êñ∞È°µÈù¢ (F5)\n' +
                            '‚Ä¢ ÂàáÊç¢ÁΩëÁªúÔºàÂ¶Ç‰ΩøÁî®ÊâãÊú∫ÁÉ≠ÁÇπÔºâ\n' +
                            '‚Ä¢ Êü•ÁúãÊµèËßàÂô®ÊéßÂà∂Âè∞ (F12) ‰∫ÜËß£ËØ¶ÁªÜ‰ø°ÊÅØ\n' +
                            '‚Ä¢ ÊöÇÊó∂ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô/ÂÆâÂÖ®ËΩØ‰ª∂ÊµãËØï';

                        showToast('Chart.js Â∫ìÂä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Êü•ÁúãÊµèËßàÂô®ÊéßÂà∂Âè∞', 'error', { duration: 10000 });
                        console.error(errorMsg);
                        throw new Error(errorMsg);
                    }

                    // Ê£ÄÊü•ÊòØÂê¶ÊúâÊñá‰ª∂
                    if (csvFiles.length === 0) {
                        throw new Error('ËØ∑ÂÖà‰∏ä‰º†CSVÊñá‰ª∂');
                    }

                    // Ëé∑ÂèñËÆæÁΩÆ
                    const xAxisRow = parseInt(xAxisRowInput.value) - 1; // ËΩ¨Êç¢‰∏∫0-basedÁ¥¢Âºï
                    const startRow = parseInt(startRowInput.value) - 1;
                    const endRow = parseInt(endRowInput.value);
                    const startCol = parseInt(startColInput.value) - 1;
                    const endCol = parseInt(endColInput.value);
                    const constantRowsStr = constantRowsInput.value;
                    const frameInterval = parseInt(frameIntervalInput.value);
                    const skipFrames = parseInt(skipFramesInput.value) || 0;
                    const xMin = xMinInput.value === 'auto' ? null : parseFloat(xMinInput.value);
                    const xMax = xMaxInput.value === 'auto' ? null : parseFloat(xMaxInput.value);
                    const yMin = yMinInput.value === 'auto' ? null : parseFloat(yMinInput.value);
                    const yMax = yMaxInput.value === 'auto' ? null : parseFloat(yMaxInput.value);

                    // Ëá™Âä®Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫Âõæ‰æã
                    let shouldShowLegend = showLegendSelect.value === 'true';

                    // Ê£ÄÊü•ÊòØÂê¶ÊúâÂ∏∏ÊòæË°åÈúÄË¶ÅÊòæÁ§∫
                    const hasGlobalConstantRows = constantRowsStr.trim() !== '';
                    const hasFileConstantRows = csvFiles.some(file => file.constantRows && file.constantRows.trim() !== '');

                    // Â¶ÇÊûúÊúâÂ∏∏ÊòæË°åËÆæÁΩÆÊàñÂ§ö‰∏™Êñá‰ª∂ÔºåËá™Âä®ÂêØÁî®Âõæ‰æã
                    if ((hasGlobalConstantRows || hasFileConstantRows || csvFiles.length > 1) && !shouldShowLegend) {
                        shouldShowLegend = true;
                        showLegendSelect.value = 'true';
                    }

                    const showLegend = shouldShowLegend;
                    const xAxisType = xAxisTypeSelect.value;
                    const chartTitle = chartTitleInput.value;
                    const xAxisLabel = xAxisLabelInput.value;
                    const yAxisLabel = yAxisLabelInput.value;

                    // ËÆ°ÁÆóXËΩ¥ÁöÑÂÆûÈôÖËåÉÂõ¥ÔºàÂ§öÊñá‰ª∂Ôºâ
                    let xMinForAuto = xMin;
                    let xMaxForAuto = xMax;
                    if (xAxisType === 'linear' && (isNaN(xMin) || isNaN(xMax))) {
                        // ËÆ°ÁÆóÊâÄÊúâÊñá‰ª∂ÁöÑXËΩ¥ËåÉÂõ¥
                        let allXValues = [];
                        for (const file of csvFiles) {
                            const fileXAxisData = file.data[xAxisRow].slice(startCol, endCol);
                            for (const val of fileXAxisData) {
                                if (val !== '' && !isNaN(parseFloat(val))) {
                                    allXValues.push(parseFloat(val));
                                }
                            }
                        }
                        if (allXValues.length > 0) {
                            // ‰ΩøÁî®Âæ™ÁéØ‰ª£ÊõøÊâ©Â±ïËøêÁÆóÁ¨¶,ÈÅøÂÖçWindows‰∏ãÂèÇÊï∞Êï∞ÈáèÈôêÂà∂ÂºÇÂ∏∏
                            if (isNaN(xMin)) {
                                xMinForAuto = allXValues[0];
                                for (let i = 1; i < allXValues.length; i++) {
                                    if (allXValues[i] < xMinForAuto) xMinForAuto = allXValues[i];
                                }
                            }
                            if (isNaN(xMax)) {
                                xMaxForAuto = allXValues[0];
                                for (let i = 1; i < allXValues.length; i++) {
                                    if (allXValues[i] > xMaxForAuto) xMaxForAuto = allXValues[i];
                                }
                            }
                        }
                    }

                    // È™åËØÅÊâÄÊúâÊñá‰ª∂ÁöÑÁªìÊûÑÂÖºÂÆπÊÄß
                    const firstFile = csvFiles[0].data;
                    for (let i = 1; i < csvFiles.length; i++) {
                        const fileData = csvFiles[i].data;
                        if (fileData.length !== firstFile.length || fileData[0].length !== firstFile[0].length) {
                            throw new Error(`Êñá‰ª∂ "${csvFiles[i].fileName}" ÁöÑÁªìÊûÑ‰∏éÁ¨¨‰∏Ä‰∏™Êñá‰ª∂‰∏çÂÖºÂÆπ`);
                        }
                    }

                    // È™åËØÅËÆæÁΩÆ
                    if (xAxisRow < 0 || xAxisRow >= firstFile.length) {
                        throw new Error('XËΩ¥Êï∞ÊçÆË°åÂè∑Ë∂ÖÂá∫ËåÉÂõ¥');
                    }

                    // ËÆ°ÁÆóÂÆûÈôÖÁªìÊùüË°å/Âàó
                    const actualEndRow = endRow < 0 ? firstFile.length + endRow : endRow;
                    const actualEndCol = endCol < 0 ? firstFile[0].length + endCol : endCol;

                    if (startRow < 0 || startRow >= firstFile.length || actualEndRow < 0 || actualEndRow >= firstFile.length || startRow > actualEndRow) {
                        throw new Error('YËΩ¥Ë°åËåÉÂõ¥Êó†Êïà');
                    }

                    if (startCol < 0 || startCol >= firstFile[0].length || actualEndCol < 0 || actualEndCol >= firstFile[0].length || startCol > actualEndCol) {
                        throw new Error('YËΩ¥ÂàóËåÉÂõ¥Êó†Êïà');
                    }

                    // ÂáÜÂ§áÂ∏∏ÊòæË°åÊï∞ÊçÆÔºàÊù•Ëá™ÊâÄÊúâÊñá‰ª∂Ôºâ
                    constantRowsData = [];
                    // Â∏∏ÊòæË°åËâ≤Á≥ªÔºö‰ΩøÁî®ÂÜ∑Ëâ≤Ë∞ÉÔºåËæÉ‰∏∫ÊüîÂíåÔºåÈÄÇÂêà‰Ωú‰∏∫ÂèÇËÄÉÁ∫ø
                    const constantRowColors = ['#5DADE2', '#48C9B0', '#45B7D1', '#7FB3D5', '#85C1E9', '#76D7C4', '#5499C7', '#2E86AB'];
                    // Âä®ÊÄÅÊï∞ÊçÆËâ≤Á≥ªÔºö‰ΩøÁî®È≤úÊòéÂØπÊØîËâ≤ÔºåÁ™ÅÂá∫Âä®ÊÄÅÂèòÂåñ
                    const dynamicDataColors = ['#E74C3C', '#F39C12', '#27AE60', '#8E44AD', '#E67E22', '#16A085', '#D35400', '#C0392B'];
                    for (let fileIndex = 0; fileIndex < csvFiles.length; fileIndex++) {
                        const fileInfo = csvFiles[fileIndex];
                        const fileData = fileInfo.data;

                        // ÊèêÂèñÂΩìÂâçÊñá‰ª∂ÁöÑXËΩ¥Êï∞ÊçÆ
                        const fileXAxisData = fileData[xAxisRow].slice(startCol, actualEndCol + 1);

                        // Ëß£ÊûêÂΩìÂâçÊñá‰ª∂ÁöÑÂ∏∏ÊòæË°åÔºà‰ºòÂÖà‰ΩøÁî®Êñá‰ª∂Áã¨Á´ãËÆæÁΩÆÔºâ
                        let constantRowIndices = [];
                        if (fileInfo.constantRows && fileInfo.constantRows.trim()) {
                            // Êñá‰ª∂ÊúâÁã¨Á´ãËÆæÁΩÆÔºå‰ΩøÁî®Êñá‰ª∂ËÆæÁΩÆ
                            constantRowIndices = parseConstantRows(fileInfo.constantRows.trim());
                        } else {
                            // Êñá‰ª∂Ê≤°ÊúâÁã¨Á´ãËÆæÁΩÆÔºå‰ΩøÁî®ÂÖ®Â±ÄËÆæÁΩÆ
                            constantRowIndices = parseConstantRows(constantRowsStr);
                        }

                        for (let constRowIndex of constantRowIndices) {
                            if (constRowIndex < 0 || constRowIndex >= fileData.length) {
                                continue; // Ë∑≥ËøáÊó†ÊïàÁöÑË°åÁ¥¢Âºï
                            }

                            const rowData = fileData[constRowIndex].slice(startCol, actualEndCol + 1);
                            const datasets = [];

                            for (let j = 0; j < rowData.length; j++) {
                                // Ë∑≥ËøáÁ©∫ÂÄºÂíåNaN
                                if (rowData[j] === '' || rowData[j] === 'NaN' || isNaN(parseFloat(rowData[j]))) {
                                    continue;
                                }

                                datasets.push({
                                    x: xAxisType === 'linear' ? parseFloat(fileXAxisData[j]) : fileXAxisData[j],
                                    y: parseFloat(rowData[j])
                                });
                            }

                            if (datasets.length > 0) {
                                const rowLabel = fileData[constRowIndex][0] || `Ë°å ${constRowIndex + 1}`;
                                // ‰∏∫ÊØè‰∏™Â∏∏ÊòæË°åÂàÜÈÖçÁã¨Á´ãÈ¢úËâ≤ÔºöÂü∫‰∫éÂ∏∏ÊòæË°åÂú®ÂÖ®Â±Ä‰∏≠ÁöÑ‰ΩçÁΩÆ
                                const globalConstRowIndex = fileIndex * constantRowIndices.length + constantRowIndices.indexOf(constRowIndex);
                                const colorIndex = globalConstRowIndex % constantRowColors.length;
                                constantRowsData.push({
                                    label: `${fileInfo.displayName} - ${rowLabel}`, // ÂåÖÂê´Êñá‰ª∂ÂêçÁöÑÊ†áÁ≠æ
                                    data: datasets,
                                    fileName: fileInfo.displayName,
                                    fileIndex: fileIndex,
                                    color: constantRowColors[colorIndex] // ‰ΩøÁî®Â∏∏ÊòæË°åËâ≤Á≥ª
                                });
                            }
                        }
                    }

                    // ÊèêÂèñYËΩ¥Êï∞ÊçÆÂπ∂ÂáÜÂ§áÂ∏ßÊï∞ÊçÆÔºàÂ∫îÁî®Ë∑≥Â∏ßËÆæÁΩÆÔºâ- Â§öÊñá‰ª∂ÁâàÊú¨
                    allFilesFrameData = []; // Â≠òÂÇ®ÊâÄÊúâÊñá‰ª∂ÁöÑÂ∏ßÊï∞ÊçÆ

                    for (let fileIndex = 0; fileIndex < csvFiles.length; fileIndex++) {
                        const fileData = csvFiles[fileIndex].data;
                        const fileFrameData = [];

                        // ÊèêÂèñÂΩìÂâçÊñá‰ª∂ÁöÑXËΩ¥Êï∞ÊçÆ
                        const fileXAxisData = fileData[xAxisRow].slice(startCol, actualEndCol + 1);

                        for (let i = startRow; i <= actualEndRow; i += (skipFrames + 1)) {
                            const rowData = fileData[i].slice(startCol, actualEndCol + 1);
                            const datasets = [];

                            for (let j = 0; j < rowData.length; j++) {
                                // Ë∑≥ËøáÁ©∫ÂÄºÂíåNaN
                                if (rowData[j] === '' || rowData[j] === 'NaN' || isNaN(parseFloat(rowData[j]))) {
                                    continue;
                                }

                                datasets.push({
                                    x: xAxisType === 'linear' ? parseFloat(fileXAxisData[j]) : fileXAxisData[j],
                                    y: parseFloat(rowData[j])
                                });
                            }

                            fileFrameData.push(datasets);
                        }

                        allFilesFrameData.push({
                            fileName: csvFiles[fileIndex].fileName,
                            frameData: fileFrameData,
                            color: dynamicDataColors[fileIndex % dynamicDataColors.length] // ‰ΩøÁî®Âä®ÊÄÅÊï∞ÊçÆËâ≤Á≥ª
                        });
                    }

                    // ‰øùÊåÅÂêëÂêéÂÖºÂÆπÊÄßÔºåËÆæÁΩÆÁ¨¨‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊï∞ÊçÆ‰∏∫ÈªòËÆ§frameData
                    frameData = allFilesFrameData[0].frameData;

                    if (frameData.length === 0) {
                        throw new Error('Ê≤°ÊúâÊúâÊïàÁöÑÊï∞ÊçÆÂèØÊòæÁ§∫');
                    }

                    // ÊòæÁ§∫Âä®ÁîªÂå∫Âüü
                    chartSection.classList.remove('hidden');

                    // ÂàõÂª∫Âä®Áîª
                    if (chart) {
                        chart.destroy();
                    }

                    const ctx = document.createElement('canvas');
                    chartContainer.innerHTML = '';
                    chartContainer.appendChild(ctx);

                    // Ëé∑ÂèñÁ¨¨‰∏ÄÂ∏ßÁöÑÊó∂Èó¥ÔºàÁî®‰∫éÂàùÂßãÊ†áÈ¢òÔºâ
                    const firstFrameTime = firstFile[startRow][0];

                    // ÂáÜÂ§áÊï∞ÊçÆÈõÜ - Â§öÊñá‰ª∂ÁâàÊú¨
                    const datasets = [];

                    // Ê∑ªÂä†ÊâÄÊúâÊñá‰ª∂ÁöÑÂä®ÊÄÅÊï∞ÊçÆÈõÜ
                    for (let fileIndex = 0; fileIndex < allFilesFrameData.length; fileIndex++) {
                        const fileInfo = allFilesFrameData[fileIndex];
                        const csvFileInfo = csvFiles[fileIndex];
                        datasets.push({
                            label: csvFileInfo.displayName, // ‰ΩøÁî®ÊòæÁ§∫ÂêçÁß∞
                            data: fileInfo.frameData[0], // Á¨¨‰∏ÄÂ∏ßÊï∞ÊçÆ
                            borderColor: fileInfo.color,
                            backgroundColor: fileInfo.color + '20', // Ê∑ªÂä†ÈÄèÊòéÂ∫¶
                            borderWidth: 2.5, // Âä®ÊÄÅÊï∞ÊçÆÁ∫øÊù°ÈÄÇ‰∏≠Á≤óÁªÜ
                            pointRadius: 0, // ÂéªÊéâÁÇπÊ†áËÆ∞
                            pointHoverRadius: 5, // Èº†Ê†áÊÇ¨ÊµÆÊó∂ÊòæÁ§∫ÁÇπ
                            tension: 0.1,
                            borderDash: [] // Á°Æ‰øù‰ΩøÁî®ÂÆûÁ∫ø
                        });
                    }

                    // Ê∑ªÂä†Â∏∏ÊòæË°åÊï∞ÊçÆÈõÜÔºàÊù•Ëá™ÊâÄÊúâÊñá‰ª∂Ôºâ
                    for (let i = 0; i < constantRowsData.length; i++) {
                        const constRowData = constantRowsData[i];
                        datasets.push({
                            label: constRowData.label,
                            data: constRowData.data,
                            borderColor: constRowData.color,
                            backgroundColor: constRowData.color + '20',
                            borderWidth: 1.5, // Â∏∏ÊòæË°å‰ΩøÁî®ÁªÜÂÆûÁ∫ø
                            pointRadius: 0,
                            pointHoverRadius: 4,
                            tension: 0.1,
                            borderDash: [] // ‰ΩøÁî®ÂÆûÁ∫ø
                        });
                    }

                    chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            datasets: datasets
                        },
                        plugins: [{
                            id: 'crosshair',
                            afterDraw: (chart) => {
                                // ‰ªÖÂΩìtooltipÊøÄÊ¥ªÊó∂ÔºàÂç≥Èº†Ê†áÂú®ÂõæË°®‰∏äÔºâÊâçÁªòÂà∂
                                if (chart.tooltip?.getActiveElements().length) {
                                    const activePoint = chart.tooltip.getActiveElements()[0];
                                    const ctx = chart.ctx;
                                    const x = activePoint.element.x;
                                    const topY = chart.scales.y.top;
                                    const bottomY = chart.scales.y.bottom;

                                    ctx.save();
                                    ctx.beginPath();
                                    ctx.moveTo(x, topY);
                                    ctx.lineTo(x, bottomY);
                                    ctx.lineWidth = 1;
                                    ctx.strokeStyle = 'grey'; // ËÆæÁΩÆÁ∫øÊù°‰∏∫ÁÅ∞Ëâ≤
                                    ctx.setLineDash([5, 5]); // ËÆæÁΩÆ‰∏∫ËôöÁ∫ø
                                    ctx.stroke();
                                    ctx.restore();
                                }
                            }
                        }],
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 0 // Á¶ÅÁî®ÊâÄÊúâÂä®Áîª
                            },
                            interaction: {
                                intersect: false, // Èº†Ê†á‰∏çÈúÄË¶ÅÁ≤æÁ°ÆÁßªÂä®Âà∞ÁÇπ‰∏ä
                                mode: 'index',    // ÊåâXËΩ¥Á¥¢ÂºïÊü•ÊâæÊúÄËøëÁöÑÁÇπ
                            },
                            plugins: {
                                tooltip: {
                                    animation: false,
                                    enabled: function(context) {
                                        return tooltipModeSelect.value !== 'off';
                                    },
                                    callbacks: {
                                        title: function(context) {
                                            const xAxisLabel = xAxisLabelInput.value || 'XËΩ¥';
                                            return `${xAxisLabel}: ${context[0].label}`;
                                        },
                                        label: function(context) {
                                            const tooltipMode = tooltipModeSelect.value;
                                            if (tooltipMode === 'compact') {
                                                // Áº©Áï•ÊòæÁ§∫ÔºöÂè™ÊòæÁ§∫Êï∞ÊçÆÂÄº
                                                return `${context.parsed.y.toFixed(4)}`;
                                            } else if (tooltipMode === 'full') {
                                                // ÂÆåÊï¥ÊòæÁ§∫ÔºöÊòæÁ§∫Êñá‰ª∂‰ø°ÊÅØÂíåÊï∞ÊçÆÂÄº
                                                return `${context.dataset.label}: ${context.parsed.y.toFixed(4)}`;
                                            } else {
                                                // ÂÖ≥Èó≠ÊòæÁ§∫ÔºöËøîÂõûÁ©∫Â≠óÁ¨¶‰∏≤
                                                return '';
                                            }
                                        }
                                    }
                                },
                                title: {
                                    display: true,
                                    text: [chartTitle, `${firstFrameTime}`],
                                    font: {
                                        size: 16
                                    }
                                },
                                legend: {
                                    display: showLegend // ‰ΩøÁî®ËÆæÁΩÆÁöÑÊòæÁ§∫Âõæ‰æãËÆæÁΩÆ
                                }
                            },
                            scales: {
                                x: {
                                    type: xAxisType,
                                    title: {
                                        display: true,
                                        text: xAxisLabel
                                    },
                                    min: xAxisType === 'linear' ? xMinForAuto : undefined,
                                    max: xAxisType === 'linear' ? xMaxForAuto : undefined
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: yAxisLabel
                                    },
                                    min: yMin,
                                    max: yMax
                                }
                            }
                        }
                    });

                    // ÈáçÁΩÆÂä®ÁîªÁä∂ÊÄÅ
                    currentFrameIndex = 0;
                    isPlaying = false;
                    playPauseBtn.textContent = 'Êí≠Êîæ';

                    // ÂàùÂßãÂåñÂùêÊ†áËΩ¥Áº©ÊîæÁä∂ÊÄÅ
                    axisZoomLevel = 1.0;
                    xAxisZoomLevel = 1.0;
                    yAxisZoomLevel = 1.0;
                    axisPanOffset = { x: 0, y: 0 };
                    hasPanned = false;

                    // ‰øùÂ≠òÂéüÂßãÂùêÊ†áËΩ¥ËåÉÂõ¥
                    setTimeout(() => {
                        if (chart && chart.scales && chart.scales.x && chart.scales.y) {
                            originalAxisLimits = {
                                xMin: chart.scales.x.min,
                                xMax: chart.scales.x.max,
                                yMin: chart.scales.y.min,
                                yMax: chart.scales.y.max
                            };

                            // ‰øùÂ≠òÂéüÂßãÂùêÊ†áËΩ¥ÊØî‰æã
                            const chartArea = chart.chartArea;
                            if (chartArea) {
                                originalAxisRatio = chartArea.width / chartArea.height;
                            }
                        }
                    }, 100);


                    // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂Âô®
                    if (animationTimer) {
                        clearInterval(animationTimer);
                        animationTimer = null;
                    }

                    // Êõ¥Êñ∞Â∏ß‰ø°ÊÅØ
                    totalFramesSpan.textContent = frameData.length; // ‰øùÊåÅÂêëÂêéÂÖºÂÆπÊÄß
                    updateFrameInfo();
                    setupProgressBar(); // ËÆæÁΩÆËøõÂ∫¶Êù°ËåÉÂõ¥ÂíåÂÆΩÂ∫¶
                    updateProgress();

                    // ÂêØÁî®‰øùÂ≠òËßÜÈ¢ëÊåâÈíÆ
                    saveVideoBtn.disabled = false;

                    showToast('Âä®ÁîªÁîüÊàêÊàêÂäü', 'success', { duration: 4000 });

                    // tooltipÊ®°ÂºèËÆæÁΩÆÂ∑≤Êõ¥Êñ∞ÔºåÈúÄË¶ÅÁÇπÂáª"ÁîüÊàêÂä®Áîª"ÊåâÈíÆÂ∫îÁî®Êõ¥Êîπ
                } catch (error) {
                    showToast(`ÁîüÊàêÂä®ÁîªÊó∂Âá∫Èîô: ${error.message}`, 'error', { duration: 8000 });
                }
            }

            // ÂàáÊç¢Êí≠Êîæ/ÊöÇÂÅú
            function togglePlayPause() {
                if (isPlaying) {
                    // ÊöÇÂÅú
                    clearInterval(animationTimer);
                    animationTimer = null;
                    isPlaying = false;
                    playPauseBtn.textContent = 'Êí≠Êîæ';
                } else {
                    // Êí≠Êîæ
                    isPlaying = true;
                    playPauseBtn.textContent = 'ÊöÇÂÅú';

                    const frameInterval = parseInt(frameIntervalInput.value);
                    animationTimer = setInterval(() => {
                        currentFrameIndex++;
                        if (currentFrameIndex >= frameData.length) {
                            currentFrameIndex = 0; // Âæ™ÁéØÊí≠Êîæ
                        }
                        updateChart();
                        updateProgress();
                    }, frameInterval);
                }
            }

            // Êõ¥Êñ∞Âä®Áîª
            function updateChart() {
                if (!chart || allFilesFrameData.length === 0) return;

                // Êõ¥Êñ∞ÊâÄÊúâÊñá‰ª∂ÁöÑÂä®ÁîªÊï∞ÊçÆ
                for (let fileIndex = 0; fileIndex < allFilesFrameData.length; fileIndex++) {
                    chart.data.datasets[fileIndex].data = allFilesFrameData[fileIndex].frameData[currentFrameIndex];
                }

                // Ëé∑ÂèñÂΩìÂâçÂ∏ßÂØπÂ∫îÁöÑÊó∂Èó¥ÔºàËÄÉËôëË∑≥Â∏ßËÆæÁΩÆÔºâ- ‰ªéÁ¨¨‰∏Ä‰∏™Êñá‰ª∂Ëé∑Âèñ
                const startRow = parseInt(startRowInput.value) - 1;
                const skipFrames = parseInt(skipFramesInput.value) || 0;
                const actualRowIndex = startRow + currentFrameIndex * (skipFrames + 1);
                const currentTime = csvFiles[0].data[actualRowIndex][0];

                // Êõ¥Êñ∞Âä®ÁîªÊ†áÈ¢òÔºàÂåÖÂê´Êó∂Èó¥‰ø°ÊÅØÔºâ
                chart.options.plugins.title.text = [chartTitleInput.value, `${currentTime}`];

                chart.update();
                updateFrameInfo();
            }

            // Êõ¥Êñ∞Â∏ß‰ø°ÊÅØ
            function updateFrameInfo() {
                currentFrameSpan.textContent = currentFrameIndex + 1;
            }

            // Êõ¥Êñ∞ËøõÂ∫¶Êù°
            function updateProgress() {
                progressBar.value = currentFrameIndex;
            }

            // ËÆæÁΩÆËøõÂ∫¶Êù°ËåÉÂõ¥
            function setupProgressBar() {
                if (frameData.length > 0) {
                    progressBar.max = frameData.length - 1;
                    progressBar.value = 0;
                }
            }

            // Â∏ßÂØºËà™ÂáΩÊï∞
            function navigateFrame(direction) {
                if (frameData.length === 0) return;

                if (direction === -1 && currentFrameIndex > 0) {
                    currentFrameIndex--;
                    updateChart();
                    updateProgress();
                } else if (direction === 1 && currentFrameIndex < frameData.length - 1) {
                    currentFrameIndex++;
                    updateChart();
                    updateProgress();
                }
            }

            // ÂºÄÂßãÈïøÊåâÂØºËà™
            function startFrameNavigation(direction) {
                if (frameNavTimer) return; // Â∑≤ÁªèÂú®ÂØºËà™‰∏≠

                frameNavDirection = direction;

                // Á´ãÂç≥ÊâßË°å‰∏ÄÊ¨°
                navigateFrame(direction);

                // ËÆæÁΩÆÂÆöÊó∂Âô®ÔºåÂª∂ËøüÂêéÂºÄÂßãËøûÁª≠ÂØºËà™
                frameNavTimer = setTimeout(() => {
                    // ÂºÄÂßãËøûÁª≠ÂØºËà™
                    frameNavTimer = setInterval(() => {
                        navigateFrame(direction);
                    }, frameNavInterval);
                }, longPressDelay);
            }

            // ÂÅúÊ≠¢ÈïøÊåâÂØºËà™
            function stopFrameNavigation() {
                if (frameNavTimer) {
                    clearTimeout(frameNavTimer);
                    clearInterval(frameNavTimer);
                    frameNavTimer = null;
                }
                frameNavDirection = 0;
            }

            // ÂùêÊ†áËΩ¥Áº©ÊîæÂäüËÉΩÂÆûÁé∞ÂáΩÊï∞
            function axisZoomIn() {
                const target = axisZoomTarget.value;
                const zoomFactor = 1.2; // ÊîæÂ§ß20%

                if (target === 'xy') {
                    axisZoomLevel *= zoomFactor;
                    xAxisZoomLevel *= zoomFactor;
                    yAxisZoomLevel *= zoomFactor;
                } else if (target === 'x') {
                    xAxisZoomLevel *= zoomFactor;
                } else if (target === 'y') {
                    yAxisZoomLevel *= zoomFactor;
                }

                // Âè™ÈôêÂà∂ÊúÄÂ∞èÂÄºÔºå‰∏çÈôêÂà∂ÊúÄÂ§ßÂÄº
                axisZoomLevel = Math.max(axisZoomLevel, 0.01);
                xAxisZoomLevel = Math.max(xAxisZoomLevel, 0.01);
                yAxisZoomLevel = Math.max(yAxisZoomLevel, 0.01);

                updateAxisZoom();
                updateZoomDisplay();
            }

            function axisZoomOut() {
                const target = axisZoomTarget.value;
                const zoomFactor = 1.2; // Áº©Â∞è20%

                if (target === 'xy') {
                    axisZoomLevel /= zoomFactor;
                    xAxisZoomLevel /= zoomFactor;
                    yAxisZoomLevel /= zoomFactor;
                } else if (target === 'x') {
                    xAxisZoomLevel /= zoomFactor;
                } else if (target === 'y') {
                    yAxisZoomLevel /= zoomFactor;
                }

                // Âè™ÈôêÂà∂ÊúÄÂ∞èÂÄºÔºå‰∏çÈôêÂà∂ÊúÄÂ§ßÂÄº
                axisZoomLevel = Math.max(axisZoomLevel, 0.01);
                xAxisZoomLevel = Math.max(xAxisZoomLevel, 0.01);
                yAxisZoomLevel = Math.max(yAxisZoomLevel, 0.01);

                updateAxisZoom();
                updateZoomDisplay();
            }

            function resetAxisZoom() {
                axisZoomLevel = 1.0;
                xAxisZoomLevel = 1.0;
                yAxisZoomLevel = 1.0;
                axisPanOffset = { x: 0, y: 0 };
                hasPanned = false;

                updateAxisZoom();
                updateZoomDisplay();
                showToast('ÂùêÊ†áËΩ¥Â∑≤ÈáçÁΩÆ', 'success', { duration: 4000 });
            }

            function updateAxisZoom() {
                if (!chart || !originalAxisLimits) return;

                const xRange = originalAxisLimits.xMax - originalAxisLimits.xMin;
                const yRange = originalAxisLimits.yMax - originalAxisLimits.yMin;
                const target = axisZoomTarget.value;

                // ËÆ°ÁÆóÁº©ÊîæÂêéÁöÑËåÉÂõ¥
                let zoomedXRange, zoomedYRange;

                if (target === 'xy') {
                    // XYËΩ¥ÂêåÊ≠•Áº©Êîæ
                    zoomedXRange = xRange / axisZoomLevel;
                    zoomedYRange = yRange / axisZoomLevel;
                } else if (target === 'x') {
                    // ‰ªÖXËΩ¥Áº©Êîæ
                    zoomedXRange = xRange / xAxisZoomLevel;
                    zoomedYRange = yRange; // YËΩ¥‰øùÊåÅ‰∏çÂèò
                } else if (target === 'y') {
                    // ‰ªÖYËΩ¥Áº©Êîæ
                    zoomedXRange = xRange; // XËΩ¥‰øùÊåÅ‰∏çÂèò
                    zoomedYRange = yRange / yAxisZoomLevel;
                }

                // ËÆ°ÁÆóËßÜÂõæ‰∏≠ÂøÉÁÇπÔºàËÄÉËôëÂπ≥ÁßªÔºâ
                const centerX = originalAxisLimits.xMin + xRange / 2 + axisPanOffset.x;
                const centerY = originalAxisLimits.yMin + yRange / 2 + axisPanOffset.y;

                // ËÆæÁΩÆÊñ∞ÁöÑÂùêÊ†áËΩ¥ËåÉÂõ¥
                chart.options.scales.x.min = centerX - zoomedXRange / 2;
                chart.options.scales.x.max = centerX + zoomedXRange / 2;
                chart.options.scales.y.min = centerY - zoomedYRange / 2;
                chart.options.scales.y.max = centerY + zoomedYRange / 2;

                chart.update('none'); // ‰∏ç‰ΩøÁî®Âä®Áîª‰ª•ÊèêÈ´òÊÄßËÉΩ
            }

            // Èº†Ê†áÊªöËΩÆÂùêÊ†áËΩ¥Áº©ÊîæÂ§ÑÁêÜ
            function handleAxisZoomWheel(e) {
                if (!chart || !originalAxisLimits) return;

                e.preventDefault();

                // Ê†πÊçÆÊªöËΩÆÊñπÂêëË∞ÉÊï¥Áº©ÊîæÁ∫ßÂà´
                const zoomFactor = e.deltaY < 0 ? 1.2 : 0.8;
                const target = axisZoomTarget.value;
                let hasChanged = false;

                if (target === 'xy') {
                    const oldAxisZoomLevel = axisZoomLevel;
                    axisZoomLevel *= zoomFactor;
                    xAxisZoomLevel *= zoomFactor;
                    yAxisZoomLevel *= zoomFactor;
                    axisZoomLevel = Math.max(axisZoomLevel, 0.01);
                    xAxisZoomLevel = Math.max(xAxisZoomLevel, 0.01);
                    yAxisZoomLevel = Math.max(yAxisZoomLevel, 0.01);
                    hasChanged = oldAxisZoomLevel !== axisZoomLevel;
                } else if (target === 'x') {
                    const oldXAxisZoomLevel = xAxisZoomLevel;
                    xAxisZoomLevel *= zoomFactor;
                    xAxisZoomLevel = Math.max(xAxisZoomLevel, 0.01);
                    hasChanged = oldXAxisZoomLevel !== xAxisZoomLevel;
                } else if (target === 'y') {
                    const oldYAxisZoomLevel = yAxisZoomLevel;
                    yAxisZoomLevel *= zoomFactor;
                    yAxisZoomLevel = Math.max(yAxisZoomLevel, 0.01);
                    hasChanged = oldYAxisZoomLevel !== yAxisZoomLevel;
                }

                if (hasChanged) {
                    updateAxisZoom();
                    updateZoomDisplay();
                }
            }

            // ÂùêÊ†áËΩ¥Âπ≥ÁßªÂ§ÑÁêÜÂáΩÊï∞
            function handleAxisPanStart(e) {
                if (!chart || e.button !== 0) return; // Âè™ÂìçÂ∫îÂ∑¶ÈîÆ

                isPanning = true;
                panStartPos.x = e.clientX;
                panStartPos.y = e.clientY;
                chartContainer.style.cursor = 'grabbing';
                e.preventDefault();
            }

            function handleAxisPanMove(e) {
                if (!isPanning || !chart) return;

                const deltaX = e.clientX - panStartPos.x;
                const deltaY = e.clientY - panStartPos.y;

                // ËΩ¨Êç¢ÂÉèÁ¥†ÂÅèÁßª‰∏∫Êï∞ÊçÆÂÅèÁßª
                const xScale = chart.scales.x;
                const yScale = chart.scales.y;

                const dataDeltaX = (deltaX / xScale.width) * (xScale.max - xScale.min);
                const dataDeltaY = (deltaY / yScale.height) * (yScale.max - yScale.min);

                axisPanOffset.x -= dataDeltaX;
                axisPanOffset.y += dataDeltaY; // YËΩ¥ÊñπÂêëÁõ∏Âèç

                updateAxisZoom();
                hasPanned = true; // Ê†áËÆ∞Â∑≤ÁªèÂπ≥ÁßªËøá

                panStartPos.x = e.clientX;
                panStartPos.y = e.clientY;
                e.preventDefault();
            }

            function handleAxisPanEnd(e) {
                isPanning = false;
                chartContainer.style.cursor = 'default';
            }

            // Â§ÑÁêÜÂõæË°®ÂèåÂáª‰∫ã‰ª∂ÔºåÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó
            function handleChartDoubleClick(e) {
                if (!chart) return;

                try {
                    // Ëé∑ÂèñÈº†Ê†áÂú®ÂõæË°®‰∏äÁöÑ‰ΩçÁΩÆ
                    const rect = chart.canvas.getBoundingClientRect();
                    const mouseX = e.clientX - rect.left;
                    const mouseY = e.clientY - rect.top;

                    // ‰ΩøÁî®Chart.jsÁöÑÊñπÊ≥ïËé∑ÂèñÂØπÂ∫îÁöÑÊï∞ÊçÆÁÇπ
                    const canvasPosition = Chart.helpers.getRelativePosition(e, chart);
                    const dataX = chart.scales.x.getValueForPixel(canvasPosition.x);
                    const dataY = chart.scales.y.getValueForPixel(canvasPosition.y);

                    // Âü∫‰∫éXÂùêÊ†áÊâæÂà∞ÊúÄÊé•ËøëÁöÑÊï∞ÊçÆÁÇπ
                    const currentFrameData = chart.data.datasets[0].data;
                    if (!currentFrameData || currentFrameData.length === 0) return;

                    let closestPoint = null;
                    let minDistance = Infinity;

                    for (let i = 0; i < currentFrameData.length; i++) {
                        const point = currentFrameData[i];
                        if (point && point.x !== undefined) {
                            const distance = Math.abs(point.x - dataX);
                            if (distance < minDistance) {
                                minDistance = distance;
                                closestPoint = {
                                    x: point.x,
                                    y: point.y,
                                    index: i
                                };
                            }
                        }
                    }

                    if (closestPoint) {
                        // ‰øùÂ≠òÁÇπÂáª‰ø°ÊÅØ
                        clickedDataPoint = closestPoint;

                        // Êõ¥Êñ∞ÊµÆÁ™óÊ†áÈ¢òÂíåÁÇπÂáª‰ΩçÁΩÆ‰ø°ÊÅØ
                        const xAxisType = xAxisTypeSelect.value;
                        const xLabel = xAxisLabelInput.value || 'XËΩ¥';
                        const yLabel = yAxisLabelInput.value || 'YËΩ¥';

                        timeSeriesModalTitle.textContent = `${xLabel} = ${closestPoint.x} ÁöÑÊó∂Èó¥Â∫èÂàó`;
                        clickedPosition.textContent = `${xLabel}: ${closestPoint.x}, ${yLabel}: ${closestPoint.y.toFixed(2)}`;

                        // ÊèêÂèñÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂπ∂ÊòæÁ§∫ÊµÆÁ™ó
                        extractTimeSeriesData(closestPoint.x, xAxisType);
                    }

                } catch (error) {
                    console.error('Â§ÑÁêÜÂõæË°®ÂèåÂáªÊó∂Âá∫Èîô:', error);
                    showToast('Êó†Ê≥ïÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊï∞ÊçÆ: ' + error.message, 'error', { duration: 6000 });
                }
            }

            // ÂÖ≥Èó≠Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó
            function closeTimeSeriesModal() {
                timeSeriesModal.style.display = "none";
                timeSeriesStats.style.display = "none";
                if (timeSeriesChart) {
                    timeSeriesChart.destroy();
                    timeSeriesChart = null;
                }
                clickedDataPoint = null;
            }

            // Â§ÑÁêÜÂõæË°®ÁÇπÂáª‰∫ã‰ª∂ÔºåÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊµÆÁ™ó
            function handleChartClick(activeElement, chart) {
                try {
                    const datasetIndex = activeElement.datasetIndex;
                    const index = activeElement.index;
                    const chartData = chart.data.datasets[datasetIndex].data;

                    if (!chartData || chartData.length === 0 || index >= chartData.length) {
                        return;
                    }

                    // Ëé∑ÂèñÁÇπÂáªÁöÑÊï∞ÊçÆÁÇπ‰ø°ÊÅØ
                    const clickedXValue = chartData[index].x;
                    const clickedYValue = chartData[index].y;

                    // ‰øùÂ≠òÁÇπÂáª‰ø°ÊÅØ
                    clickedDataPoint = {
                        x: clickedXValue,
                        y: clickedYValue,
                        index: index
                    };

                    // Êõ¥Êñ∞ÊµÆÁ™óÊ†áÈ¢òÂíåÁÇπÂáª‰ΩçÁΩÆ‰ø°ÊÅØ
                    const xAxisType = xAxisTypeSelect.value;
                    const xLabel = xAxisLabelInput.value || 'XËΩ¥';
                    const yLabel = yAxisLabelInput.value || 'YËΩ¥';

                    timeSeriesModalTitle.textContent = `${xLabel} = ${clickedXValue} ÁöÑÊó∂Èó¥Â∫èÂàó`;
                    clickedPosition.textContent = `${xLabel}: ${clickedXValue}, ${yLabel}: ${clickedYValue.toFixed(2)}`;

                    // ÊèêÂèñÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂπ∂ÊòæÁ§∫ÊµÆÁ™ó
                    extractTimeSeriesData(clickedXValue, xAxisType);

                } catch (error) {
                    console.error('Â§ÑÁêÜÂõæË°®ÁÇπÂáªÊó∂Âá∫Èîô:', error);
                    showToast('Êó†Ê≥ïÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊï∞ÊçÆ: ' + error.message, 'error', { duration: 6000 });
                }
            }

            // ÊèêÂèñÁâπÂÆöX‰ΩçÁΩÆÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÔºàÂ§öÊñá‰ª∂ÁâàÊú¨Ôºâ
            function extractTimeSeriesData(targetXValue, xAxisType) {
                try {
                    if (csvFiles.length === 0) {
                        throw new Error('Ê≤°ÊúâÂèØÁî®ÁöÑÊï∞ÊçÆÊñá‰ª∂');
                    }

                    // Ëé∑ÂèñËÆæÁΩÆÂèÇÊï∞
                    const startRow = parseInt(startRowInput.value) - 1;
                    const skipFrames = parseInt(skipFramesInput.value) || 0;
                    const xAxisRow = parseInt(xAxisRowInput.value) - 1;
                    const startCol = parseInt(startColInput.value) - 1;
                    const endRow = parseInt(endRowInput.value);
                    const endCol = parseInt(endColInput.value);

                    // ËÆ°ÁÆóÂÆûÈôÖËåÉÂõ¥
                    const firstFile = csvFiles[0].data;
                    const actualEndRow = endRow < 0 ? firstFile.length + endRow : endRow;
                    const actualEndCol = endCol < 0 ? firstFile[0].length + endCol : endCol;

                    // Ëé∑ÂèñXËΩ¥Êï∞ÊçÆ
                    const xAxisData = firstFile[xAxisRow].slice(startCol, actualEndCol + 1);

                    // ÊâæÂà∞ÁõÆÊ†áXÂÄºÂú®XËΩ¥Êï∞ÊçÆ‰∏≠ÁöÑÁ¥¢Âºï
                    let targetIndex = -1;
                    for (let i = 0; i < xAxisData.length; i++) {
                        const xVal = xAxisType === 'linear' ? parseFloat(xAxisData[i]) : xAxisData[i];
                        const targetVal = xAxisType === 'linear' ? parseFloat(targetXValue) : targetXValue;

                        if (Math.abs(xVal - targetVal) < 1e-10 || xVal === targetVal) {
                            targetIndex = i;
                            break;
                        }
                    }

                    if (targetIndex === -1) {
                        throw new Error('Êú™ÊâæÂà∞ÂåπÈÖçÁöÑXËΩ¥‰ΩçÁΩÆ');
                    }

                    // ÊèêÂèñÊâÄÊúâÊñá‰ª∂ÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆ
                    const allFilesTimeSeries = [];
                    const frameLabels = [];
                    // Âä®ÊÄÅÊï∞ÊçÆËâ≤Á≥ªÔºö‰ΩøÁî®È≤úÊòéÂØπÊØîËâ≤ÔºåÁ™ÅÂá∫Âä®ÊÄÅÂèòÂåñ
                    const dynamicDataColors = ['#E74C3C', '#F39C12', '#27AE60', '#8E44AD', '#E67E22', '#16A085', '#D35400', '#C0392B'];

                    for (let fileIndex = 0; fileIndex < csvFiles.length; fileIndex++) {
                        const fileInfo = csvFiles[fileIndex];
                        const fileData = fileInfo.data;
                        const timeSeriesData = [];

                        // ÈÅçÂéÜÊâÄÊúâÂ∏ßÊï∞ÊçÆ
                        for (let i = startRow; i <= actualEndRow; i += (skipFrames + 1)) {
                            if (i < fileData.length) {
                                const rowData = fileData[i].slice(startCol, actualEndCol + 1);
                                if (targetIndex < rowData.length && rowData[targetIndex] !== '' && rowData[targetIndex] !== 'NaN' && !isNaN(parseFloat(rowData[targetIndex]))) {
                                    const timeLabel = fileData[i][0] || `Êó∂Èó¥_${i + 1}`;
                                    const value = parseFloat(rowData[targetIndex]);

                                    timeSeriesData.push({
                                        x: timeLabel,
                                        y: value
                                    });

                                    // Âè™‰∏∫Á¨¨‰∏Ä‰∏™Êñá‰ª∂Êî∂ÈõÜÊó∂Èó¥Ê†áÁ≠æ
                                    if (fileIndex === 0) {
                                        frameLabels.push(timeLabel);
                                    }
                                }
                            }
                        }

                        if (timeSeriesData.length > 0) {
                            allFilesTimeSeries.push({
                                fileName: fileInfo.displayName,
                                data: timeSeriesData,
                                color: dynamicDataColors[fileIndex % dynamicDataColors.length] // ‰ΩøÁî®Âä®ÊÄÅÊï∞ÊçÆËâ≤Á≥ª
                            });
                        }
                    }

                    if (allFilesTimeSeries.length === 0) {
                        throw new Error('Ê≤°ÊúâÊâæÂà∞ÊúâÊïàÁöÑÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆ');
                    }

                    // ÊòæÁ§∫Â§öÊñá‰ª∂Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÂπ∂ÁªòÂà∂ÂØπÊØîÂõæË°®
                    showMultiFileTimeSeriesModal(allFilesTimeSeries, frameLabels, targetXValue);

                } catch (error) {
                    console.error('ÊèêÂèñÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÊó∂Âá∫Èîô:', error);
                    showToast('ÊèêÂèñÊó∂Èó¥Â∫èÂàóÊï∞ÊçÆÂ§±Ë¥•: ' + error.message, 'error', { duration: 8000 });
                }
            }

            // ËÆ°ÁÆóÁªüËÆ°‰ø°ÊÅØ
            function calculateStatistics(data) {
                if (!data || data.length === 0) {
                    return null;
                }

                const values = data.map(point => point.y).filter(y => y !== null && y !== undefined && !isNaN(y));
                if (values.length === 0) {
                    return null;
                }

                // ‰ΩøÁî®Âæ™ÁéØ‰ª£ÊõøÊâ©Â±ïËøêÁÆóÁ¨¶,ÈÅøÂÖçWindows‰∏ãÂèÇÊï∞Êï∞ÈáèÈôêÂà∂ÂºÇÂ∏∏
                let max = values[0];
                let min = values[0];
                for (let i = 1; i < values.length; i++) {
                    if (values[i] > max) max = values[i];
                    if (values[i] < min) min = values[i];
                }
                const mean = values.reduce((sum, val) => sum + val, 0) / values.length;

                // ËÆ°ÁÆóÊ†áÂáÜÂ∑Æ
                const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
                const stdDev = Math.sqrt(variance);

                return {
                    max: max,
                    min: min,
                    mean: mean,
                    stdDev: stdDev,
                    count: values.length,
                    range: max - min
                };
            }

            // Êõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØÊòæÁ§∫
            function updateStatisticsDisplay(stats) {
                if (!stats) {
                    timeSeriesStats.style.display = 'none';
                    return;
                }

                statsMax.textContent = stats.max.toFixed(3);
                statsMin.textContent = stats.min.toFixed(3);
                statsAvg.textContent = stats.mean.toFixed(3);
                statsStd.textContent = stats.stdDev.toFixed(3);
                statsCount.textContent = stats.count;
                statsRange.textContent = stats.range.toFixed(3);

                timeSeriesStats.style.display = 'block';
            }

            // Êõ¥Êñ∞Â§öÊñá‰ª∂ÁªüËÆ°‰ø°ÊÅØÊòæÁ§∫ÔºàË°®Ê†ºÂΩ¢ÂºèÔºâ
            function updateMultiFileStatisticsDisplay(allStats, targetXValue) {
                if (!allStats || allStats.length === 0) {
                    timeSeriesStats.style.display = 'none';
                    return;
                }

                // ÂàõÂª∫Ë°®Ê†ºHTML
                const fileCount = allStats.length;
                let tableHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>XËΩ¥‰ΩçÁΩÆ: ${targetXValue}</strong> - Â§öÊñá‰ª∂ÁªüËÆ°ÂØπÊØî (${fileCount} ‰∏™Êñá‰ª∂)
                    </div>
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background-color: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">Êñá‰ª∂</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">ÊúÄÂ§ßÂÄº</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">ÊúÄÂ∞èÂÄº</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">Âπ≥ÂùáÂÄº</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">Ê†áÂáÜÂ∑Æ</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">Êï∞ÊçÆÁÇπÊï∞</th>
                                <th style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">ÊûÅÂ∑Æ</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                // Ê∑ªÂä†ÊØè‰∏™Êñá‰ª∂ÁöÑÁªüËÆ°‰ø°ÊÅØË°å
                for (const fileStat of allStats) {
                    const stats = fileStat.stats;
                    if (stats) {
                        tableHTML += `
                            <tr>
                                <td style="padding: 6px 8px; border: 1px solid #dee2e6;">
                                    <span style="display: inline-block; width: 12px; height: 12px; background-color: ${fileStat.color}; border-radius: 50%; margin-right: 6px;"></span>
                                    ${fileStat.fileName}
                                </td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.max.toFixed(3)}</td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.min.toFixed(3)}</td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.mean.toFixed(3)}</td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.stdDev.toFixed(3)}</td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.count}</td>
                                <td style="padding: 6px 8px; text-align: right; border: 1px solid #dee2e6;">${stats.range.toFixed(3)}</td>
                            </tr>
                        `;
                    }
                }

                // Â¶ÇÊûúÊúâÂ§ö‰∏™Êñá‰ª∂ÔºåÊ∑ªÂä†Ê±áÊÄªË°å
                if (allStats.length > 1) {
                    const validStats = allStats.filter(fs => fs.stats).map(fs => fs.stats);
                    if (validStats.length > 0) {
                        const avgMax = validStats.reduce((sum, s) => sum + s.max, 0) / validStats.length;
                        const avgMin = validStats.reduce((sum, s) => sum + s.min, 0) / validStats.length;
                        const avgMean = validStats.reduce((sum, s) => sum + s.mean, 0) / validStats.length;
                        const avgStd = validStats.reduce((sum, s) => sum + s.stdDev, 0) / validStats.length;
                        const totalCount = validStats.reduce((sum, s) => sum + s.count, 0);
                        const avgRange = validStats.reduce((sum, s) => sum + s.range, 0) / validStats.length;

                        tableHTML += `
                            <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                                <td style="padding: 8px; border: 1px solid #dee2e6;">Âπ≥ÂùáÂÄº</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${avgMax.toFixed(3)}</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${avgMin.toFixed(3)}</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${avgMean.toFixed(3)}</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${avgStd.toFixed(3)}</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${totalCount}</td>
                                <td style="padding: 8px; text-align: right; border: 1px solid #dee2e6;">${avgRange.toFixed(3)}</td>
                            </tr>
                        `;
                    }
                }

                tableHTML += `
                        </tbody>
                    </table>
                `;

                // Êõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØÊòæÁ§∫Âå∫Âüü
                timeSeriesStats.innerHTML = tableHTML;
                timeSeriesStats.style.display = 'block';
            }

            // ÊòæÁ§∫Â§öÊñá‰ª∂Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÂπ∂ÁªòÂà∂ÂØπÊØîÂõæË°®
            function showMultiFileTimeSeriesModal(allFilesTimeSeries, frameLabels, targetXValue) {
                try {
                    // Êõ¥Êñ∞Ê®°ÊÄÅÊ°ÜÊ†áÈ¢ò‰ª•ÂèçÊò†Â§öÊñá‰ª∂ÂØπÊØî
                    const xLabel = xAxisLabelInput.value || 'XËΩ¥';
                    timeSeriesModalTitle.textContent = `${xLabel} = ${targetXValue} ÁöÑÂ§öÊñá‰ª∂Êó∂Èó¥Â∫èÂàóÂØπÊØî`;

                    // ÊòæÁ§∫ÊµÆÁ™ó
                    timeSeriesModal.style.display = "block";

                    // ËÆ°ÁÆóÂπ∂ÊòæÁ§∫Â§öÊñá‰ª∂ÁªüËÆ°‰ø°ÊÅØ
                    const allStats = [];
                    for (const fileSeries of allFilesTimeSeries) {
                        const stats = calculateStatistics(fileSeries.data);
                        allStats.push({
                            fileName: fileSeries.fileName,
                            color: fileSeries.color,
                            stats: stats
                        });
                    }
                    updateMultiFileStatisticsDisplay(allStats, targetXValue);

                    // Â¶ÇÊûúÂ∑≤ÊúâÂõæË°®ÂÆû‰æãÔºåÂÖàÈîÄÊØÅ
                    if (timeSeriesChart) {
                        timeSeriesChart.destroy();
                    }

                    // ÂáÜÂ§áÂ§öÊñá‰ª∂ÂØπÊØîÂõæË°®Êï∞ÊçÆ
                    const datasets = allFilesTimeSeries.map(fileSeries => ({
                        label: fileSeries.fileName,
                        data: fileSeries.data,
                        borderColor: fileSeries.color,
                        backgroundColor: fileSeries.color + '20',
                        borderWidth: 2,
                        pointRadius: 0,
                        pointHoverRadius: 4,
                        tension: 0.1,
                        fill: false
                    }));

                    // ÂàõÂª∫Â§öÊñá‰ª∂Êó∂Èó¥Â∫èÂàóÂØπÊØîÂõæË°®
                    const ctx = timeSeriesChartContainer.getContext('2d');
                    timeSeriesChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            datasets: datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 500
                            },
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                title: {
                                    display: false
                                },
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        usePointStyle: true,
                                        padding: 15
                                    }
                                },
                                tooltip: {
                                    enabled: function(context) {
                                        return tooltipModeSelect.value !== 'off';
                                    },
                                    callbacks: {
                                        title: function(context) {
                                            const xAxisLabel = xAxisLabelInput.value || 'Êó∂Èó¥';
                                            return `${xAxisLabel}: ${context[0].label}`;
                                        },
                                        label: function(context) {
                                            const tooltipMode = tooltipModeSelect.value;
                                            if (tooltipMode === 'compact') {
                                                // Áº©Áï•ÊòæÁ§∫ÔºöÂè™ÊòæÁ§∫Êï∞ÊçÆÂÄº
                                                return `${context.parsed.y.toFixed(4)}`;
                                            } else if (tooltipMode === 'full') {
                                                // ÂÆåÊï¥ÊòæÁ§∫ÔºöÊòæÁ§∫Êñá‰ª∂‰ø°ÊÅØÂíåÊï∞ÊçÆÂÄº
                                                return `${context.dataset.label}: ${context.parsed.y.toFixed(4)}`;
                                            } else {
                                                // ÂÖ≥Èó≠ÊòæÁ§∫ÔºöËøîÂõûÁ©∫Â≠óÁ¨¶‰∏≤
                                                return '';
                                            }
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    type: 'category',
                                    title: {
                                        display: true,
                                        text: 'Êó∂Èó¥'
                                    },
                                    grid: {
                                        display: true,
                                        color: 'rgba(0,0,0,0.1)'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Êï∞ÂÄº'
                                    },
                                    grid: {
                                        display: true,
                                        color: 'rgba(0,0,0,0.1)'
                                    }
                                }
                            }
                        }
                    });

                } catch (error) {
                    console.error('ÊòæÁ§∫Â§öÊñá‰ª∂Êó∂Èó¥Â∫èÂàóÂõæË°®Êó∂Âá∫Èîô:', error);
                    showToast('ÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÂõæË°®Â§±Ë¥•: ' + error.message, 'error', { duration: 8000 });
                }
            }

            // ÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÂπ∂ÁªòÂà∂ÂõæË°®Ôºà‰øùÊåÅÂêëÂêéÂÖºÂÆπÔºâ
            function showTimeSeriesModal(timeSeriesData, frameLabels, targetXValue) {
                try {
                    // ÊòæÁ§∫ÊµÆÁ™ó
                    timeSeriesModal.style.display = "block";

                    // ËÆ°ÁÆóÂπ∂ÊòæÁ§∫ÁªüËÆ°‰ø°ÊÅØ
                    const stats = calculateStatistics(timeSeriesData);
                    updateStatisticsDisplay(stats);

                    // Â¶ÇÊûúÂ∑≤ÊúâÂõæË°®ÂÆû‰æãÔºåÂÖàÈîÄÊØÅ
                    if (timeSeriesChart) {
                        timeSeriesChart.destroy();
                    }

                    // ÂáÜÂ§áÂõæË°®Êï∞ÊçÆ
                    const datasets = [{
                        label: `${targetXValue} Êó∂Èó¥Â∫èÂàó`,
                        data: timeSeriesData,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        pointRadius: 0,
                        pointHoverRadius: 0,
                        tension: 0.1,
                        fill: true
                    }];

                    // ÂàõÂª∫Êó∂Èó¥Â∫èÂàóÂõæË°®
                    const ctx = timeSeriesChartContainer.getContext('2d');
                    timeSeriesChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            datasets: datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 300
                            },
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                title: {
                                    display: false
                                },
                                legend: {
                                    display: true,
                                    position: 'top'
                                },
                                tooltip: {
                                    enabled: function(context) {
                                        return tooltipModeSelect.value !== 'off';
                                    },
                                    callbacks: {
                                        title: function(context) {
                                            const xAxisLabel = xAxisLabelInput.value || 'Êó∂Èó¥';
                                            return `${xAxisLabel}: ${context[0].label}`;
                                        },
                                        label: function(context) {
                                            const tooltipMode = tooltipModeSelect.value;
                                            if (tooltipMode === 'compact') {
                                                // Áº©Áï•ÊòæÁ§∫ÔºöÂè™ÊòæÁ§∫Êï∞ÊçÆÂÄº
                                                return `${context.parsed.y.toFixed(4)}`;
                                            } else if (tooltipMode === 'full') {
                                                // ÂÆåÊï¥ÊòæÁ§∫ÔºöÊòæÁ§∫Êï∞ÊçÆÂÄºÔºàËøôÈáåÊòØÂçïÊñá‰ª∂Ôºå‰∏çÈúÄË¶ÅÊñá‰ª∂ÂêçÔºâ
                                                return `Êï∞ÂÄº: ${context.parsed.y.toFixed(4)}`;
                                            } else {
                                                // ÂÖ≥Èó≠ÊòæÁ§∫ÔºöËøîÂõûÁ©∫Â≠óÁ¨¶‰∏≤
                                                return '';
                                            }
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Êó∂Èó¥'
                                    },
                                    ticks: {
                                        maxTicksLimit: 20,
                                        autoSkip: true,
                                        maxRotation: 45
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: yAxisLabelInput.value || 'Êï∞ÂÄº'
                                    }
                                }
                            }
                        }
                    });

                } catch (error) {
                    console.error('ÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÊµÆÁ™óÊó∂Âá∫Èîô:', error);
                    showToast('ÊòæÁ§∫Êó∂Èó¥Â∫èÂàóÂõæË°®Â§±Ë¥•: ' + error.message, 'error', { duration: 6000 });
                }
            }

            // ‰øùÂ≠òËßÜÈ¢ëÂäüËÉΩ
            async function saveVideo() {
                if (isRecording || !chart || frameData.length === 0) {
                    return;
                }

                try {
                    isRecording = true;
                    saveVideoBtn.disabled = true;
                    saveVideoBtn.textContent = 'ÂΩïÂà∂‰∏≠...';

                    // ÂàõÂª∫ÂèñÊ∂àÂΩïÂà∂ÁöÑÊéßÂà∂Âô®
                    recordingAbortController = new AbortController();

                    // Áªü‰∏ÄÁöÑÂèñÊ∂àÂΩïÂà∂Â§ÑÁêÜÂáΩÊï∞
                    const handleCancelRecording = () => {
                        if (recordingAbortController) {
                            recordingAbortController.abort();
                            // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                            isRecording = false;
                            saveVideoBtn.disabled = false;
                            saveVideoBtn.textContent = '‰øùÂ≠òËßÜÈ¢ë';
                            recordingAbortController = null;
                            if (recordingToast) {
                                removeToast(recordingToast);
                                recordingToast = null;
                            }
                            showToast('ÂΩïÂà∂Â∑≤ÂèñÊ∂à', 'warning', { duration: 4000 });
                        }
                    };

                    // ÊòæÁ§∫ÂΩïÂà∂ËøõÂ∫¶ToastÔºàÂ∏¶ÂèñÊ∂àÊåâÈíÆÔºâ
                    recordingToast = showToast('ÂáÜÂ§áÂΩïÂà∂...', 'info', {
                        persistent: true,
                        showCancel: true,
                        cancelText: 'ÂèñÊ∂àÂΩïÂà∂',
                        onCancel: handleCancelRecording
                    });

                    // Ëé∑ÂèñcanvasÂÖÉÁ¥†
                    const canvas = chartContainer.querySelector('canvas');
                    if (!canvas) {
                        throw new Error('Êú™ÊâæÂà∞ÂõæË°®ÁîªÂ∏É');
                    }

                    // Ëß£ÊûêËßÜÈ¢ëË¥®ÈáèËÆæÁΩÆ
                    const videoQuality = videoQualitySelect.value;

                    // Ê†πÊçÆË¥®ÈáèËÆæÁΩÆËÆ°ÁÆóÁõÆÊ†áÂàÜËæ®ÁéáÂíåÁ†ÅÁéá
                    let targetWidth, targetHeight, videoBitrate, videoFPS;
                    switch (videoQuality) {
                        case 'extreme':
                            // ÊûÅËá¥Ë¥®Èáè - 4K
                            targetWidth = 3840;
                            targetHeight = 2160;
                            videoBitrate = 15000000; // 15 Mbps
                            videoFPS = 30;
                            // 4K ËÄóÊó∂ÊèêÁ§∫
                            if (frameData.length > 50) {
                                showToast('4KÊ∏≤ÊüìËÄóÊó∂ÂèØËÉΩËæÉÈïøÔºåËØ∑ËÄêÂøÉÁ≠âÂæÖ', 'warning', { duration: 5000 });
                            }
                            break;
                        case 'ultra':
                            // Ë∂ÖÈ´òË¥®Èáè - 2K
                            targetWidth = 2560;
                            targetHeight = 1440;
                            videoBitrate = 8000000; // 8 Mbps
                            videoFPS = 30;
                            break;
                        case 'high':
                            // È´òË¥®Èáè - 1080p
                            targetWidth = 1920;
                            targetHeight = 1080;
                            videoBitrate = 5000000; // 5 Mbps
                            videoFPS = 30;
                            break;
                        case 'medium':
                        default:
                            // ‰∏≠Á≠âË¥®Èáè - 720p
                            targetWidth = 1280;
                            targetHeight = 720;
                            videoBitrate = 2500000; // 2.5 Mbps
                            videoFPS = 30;
                            break;
                        case 'low':
                            // ‰ΩéË¥®Èáè - 480p
                            targetWidth = 854;
                            targetHeight = 480;
                            videoBitrate = 1000000; // 1 Mbps
                            videoFPS = 24;
                            break;
                    }

                    // ËÆ°ÁÆóÂ≠óÂè∑Áº©ÊîæÊØî‰æãÔºàÂü∫‰∫é1080p‰∏∫Âü∫ÂáÜÔºâ
                    const baseResolution = 1920; // 1080pÂÆΩÂ∫¶
                    const scaleFactor = targetWidth / baseResolution;

                    // ËÆ°ÁÆóÂêÑÂÖÉÁ¥†Â≠óÂè∑ÔºåËÆæÁΩÆÊúÄÂ∞èÂ≠óÂè∑ÈôêÂà∂
                    const titleFontSize = Math.max(Math.round(16 * scaleFactor), 12);
                    const axisTitleFontSize = Math.max(Math.round(14 * scaleFactor), 10);
                    const axisTickFontSize = Math.max(Math.round(12 * scaleFactor), 8);
                    const legendFontSize = Math.max(Math.round(12 * scaleFactor), 8);

                    // ÂêéÂè∞ÂΩïÂà∂ - ÂàõÂª∫Á¶ªÂ±ècanvasÔºà‰ΩøÁî®È´òË¥®ÈáèÂàÜËæ®ÁéáÔºâ
                    const offscreenCanvas = document.createElement('canvas');
                    const canvasRect = canvas.getBoundingClientRect();
                    const devicePixelRatio = window.devicePixelRatio || 1;

                    // ËÆæÁΩÆÈ´òÂàÜËæ®ÁéáËæìÂá∫
                    offscreenCanvas.width = targetWidth;
                    offscreenCanvas.height = targetHeight;

                    // ËÆ°ÁÆóËßÜÈ¢ëÂ∏ßÁéáÔºà‰ΩøÁî®ËÆæÁΩÆÁöÑÂ∏ßÁéáËÄå‰∏çÊòØÂü∫‰∫éÂ∏ßÈó¥ÈöîÔºâ
                    const frameInterval = parseInt(frameIntervalInput.value);

                    // ÂàõÂª∫ËßÜÈ¢ëÂΩïÂà∂Âô®Ôºà‰ΩøÁî®VP9ÁºñÁ†ÅÂô®Âπ∂ËÆæÁΩÆÁ†ÅÁéáÔºâ
                    const stream = offscreenCanvas.captureStream(videoFPS);

                    // ËÆæÁΩÆËßÜÈ¢ëËΩ®ÈÅìÁöÑÁ†ÅÁéá
                    const videoTracks = stream.getVideoTracks();
                    if (videoTracks.length > 0) {
                        videoTracks[0].applyConstraints({
                            width: { ideal: targetWidth },
                            height: { ideal: targetHeight },
                            frameRate: { ideal: videoFPS },
                            bitrate: videoBitrate
                        });
                    }

                    // Ê£ÄÊü•ÊµèËßàÂô®ÊîØÊåÅÁöÑÊ†ºÂºè
                    let mimeType = 'video/webm;codecs=vp9';
                    if (!MediaRecorder.isTypeSupported(mimeType)) {
                        mimeType = 'video/webm;codecs=vp8';
                        if (!MediaRecorder.isTypeSupported(mimeType)) {
                            mimeType = 'video/webm';
                        }
                    }

                    const mediaRecorder = new MediaRecorder(stream, {
                        mimeType: mimeType,
                        videoBitsPerSecond: videoBitrate
                    });

                    const chunks = [];

                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            chunks.push(event.data);
                            console.log(`Êî∂Âà∞Êï∞ÊçÆÂùó ${chunks.length}, Â§ßÂ∞è: ${event.data.size}`);
                        }
                    };

                    // Ê∑ªÂä†ÈîôËØØÂ§ÑÁêÜ
                    mediaRecorder.onerror = (event) => {
                        console.error('MediaRecorderÈîôËØØ:', event.error);
                        throw new Error('ÂΩïÂà∂ÈîôËØØ: ' + event.error.message);
                    };

                    mediaRecorder.onstop = async () => {
                        console.log(`MediaRecorderÂÅúÊ≠¢ÔºåÊÄªÂÖ±Êî∂Âà∞ ${chunks.length} ‰∏™Êï∞ÊçÆÂùó`);
                        try {
                            if (recordingAbortController?.signal.aborted) {
                                // ÂΩïÂà∂Ë¢´ÂèñÊ∂à
                                isRecording = false;
                                saveVideoBtn.disabled = false;
                                saveVideoBtn.textContent = '‰øùÂ≠òËßÜÈ¢ë';
                                recordingAbortController = null;
                                recordingToast = null;
                                showToast('ÂΩïÂà∂Â∑≤ÂèñÊ∂à', 'warning', { duration: 4000 });
                                return;
                            }

                            updateToast(recordingToast, 'Ê≠£Âú®ÁîüÊàêËßÜÈ¢ëÊñá‰ª∂...');

                            // ÂàõÂª∫ËßÜÈ¢ëblob
                            if (chunks.length === 0) {
                                throw new Error('Ê≤°ÊúâÂΩïÂà∂Âà∞ËßÜÈ¢ëÊï∞ÊçÆ');
                            }

                            const blob = new Blob(chunks, { type: mimeType });
                            console.log(`ËßÜÈ¢ëblobÂàõÂª∫ÊàêÂäüÔºåÂ§ßÂ∞è: ${blob.size} Â≠óËäÇÔºåÁ±ªÂûã: ${blob.type}`);

                            // Ê£ÄÊü•blobÂ§ßÂ∞è
                            if (blob.size === 0) {
                                throw new Error('ÁîüÊàêÁöÑËßÜÈ¢ëÊñá‰ª∂‰∏∫Á©∫');
                            }

                            updateToast(recordingToast, 'Ê≠£Âú®ÂáÜÂ§á‰∏ãËΩΩ...');

                            // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
                            const url = URL.createObjectURL(blob);

                            const a = document.createElement('a');
                            a.href = url;

                            // ÁîüÊàêÂîØ‰∏ÄÊñá‰ª∂Âêç
                            const generateUniqueFileName = (baseName) => {
                                let fileName = baseName + '.webm';
                                let counter = 1;

                                // Â¶ÇÊûúÂü∫Á°ÄÊñá‰ª∂ÂêçÂ∑≤ÁªèÂåÖÂê´Â∫èÂè∑Ê†ºÂºèÔºåÂÖàÁßªÈô§Â∫èÂè∑ÈÉ®ÂàÜ
                                let cleanBaseName = baseName;
                                const suffixMatch = baseName.match(/^(.*?)\s*\(\d+\)$/);
                                if (suffixMatch) {
                                    cleanBaseName = suffixMatch[1].trim();
                                }

                                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®ÂêåÂêçÊñá‰ª∂
                                while (localStorage.getItem('video_file_' + fileName)) {
                                    // ‰ΩøÁî®Ê∏ÖÁêÜÂêéÁöÑÂü∫Á°ÄÂêçÁß∞Ê∑ªÂä†Â∫èÂè∑
                                    fileName = cleanBaseName + ' (' + counter + ').webm';
                                    counter++;
                                }

                                // Ê†áËÆ∞Ê≠§Êñá‰ª∂ÂêçÂ∑≤Ë¢´‰ΩøÁî®
                                localStorage.setItem('video_file_' + fileName, Date.now().toString());

                                // Ê∏ÖÁêÜÊóßÁöÑÊñá‰ª∂ÂêçËÆ∞ÂΩïÔºà‰øùÊåÅÊúÄËøë100‰∏™Ôºâ
                                const keys = Object.keys(localStorage).filter(key => key.startsWith('video_file_'));
                                if (keys.length > 100) {
                                    keys.slice(0, keys.length - 100).forEach(key => localStorage.removeItem(key));
                                }

                                return fileName;
                            };

                            const baseFileName = (chartTitleInput.value || 'Êï∞ÊçÆÂä®Áîª')
                                .replace(/[\\/:"*?<>|]/g, '')  // ÁßªÈô§Êñá‰ª∂Âêç‰∏≠ÁöÑÈùûÊ≥ïÂ≠óÁ¨¶
                                .replace(/\s+/g, '_')         // Â∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫‰∏ãÂàíÁ∫ø
                                .trim();

                            const uniqueFileName = generateUniqueFileName(baseFileName);
                            a.download = uniqueFileName;

                            // Ëß¶Âèë‰∏ãËΩΩÔºàÊ∑ªÂä†Ë∂ÖÊó∂‰øùÊä§Ôºâ
                            try {
                                await Promise.race([
                                    new Promise(resolve => {
                                        document.body.appendChild(a);
                                        a.click();
                                        document.body.removeChild(a);
                                        setTimeout(resolve, 100);
                                    }),
                                    new Promise((_, reject) =>
                                        setTimeout(() => reject(new Error('‰∏ãËΩΩËß¶ÂèëË∂ÖÊó∂')), 10000)
                                    )
                                ]);
                            } catch (error) {
                                // Ê∏ÖÁêÜDOM
                                if (a.parentNode) {
                                    document.body.removeChild(a);
                                }
                                throw new Error('Ëß¶Âèë‰∏ãËΩΩÂ§±Ë¥•: ' + error.message);
                            }

                            // Ê∏ÖÁêÜURLÂØπË±°
                            setTimeout(() => {
                                try {
                                    URL.revokeObjectURL(url);
                                } catch (e) {
                                    console.warn('Ê∏ÖÁêÜURLÂ§±Ë¥•:', e);
                                }
                            }, 1000);

                            // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                            isRecording = false;
                            saveVideoBtn.disabled = false;
                            saveVideoBtn.textContent = '‰øùÂ≠òËßÜÈ¢ë';
                            recordingAbortController = null;

                            // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
                            removeToast(recordingToast);
                            recordingToast = null;
                            showToast('ËßÜÈ¢ë‰øùÂ≠òÊàêÂäüÔºÅÊñá‰ª∂Â∑≤‰∏ãËΩΩÂà∞ÊÇ®ÁöÑ‰∏ãËΩΩÊñá‰ª∂Â§π', 'success', { duration: 5000 });

                        } catch (error) {
                            console.error('‰øùÂ≠òËßÜÈ¢ëÊó∂Âá∫Èîô:', error);
                            isRecording = false;
                            saveVideoBtn.disabled = false;
                            saveVideoBtn.textContent = '‰øùÂ≠òËßÜÈ¢ë';
                            recordingAbortController = null;

                            if (recordingToast) {
                                removeToast(recordingToast);
                                recordingToast = null;
                            }
                            showToast('‰øùÂ≠òËßÜÈ¢ëÂ§±Ë¥•: ' + error.message, 'error', { duration: 8000 });
                        }
                    };

                    // ÂºÄÂßãÂΩïÂà∂
                    mediaRecorder.start(100); // ÊØè100msÊî∂ÈõÜ‰∏ÄÊ¨°Êï∞ÊçÆ
                    console.log('MediaRecorderÂ∑≤ÂêØÂä®ÔºåÁä∂ÊÄÅ:', mediaRecorder.state);

                    // ÂáÜÂ§áÂΩïÂà∂ÂèÇÊï∞
                    const totalRecordFrames = frameData.length;
                    const startRow = parseInt(startRowInput.value) - 1;

                    // Ê∏≤ÊüìÊâÄÊúâÂ∏ßÔºàÂπ∂Ë°åÊàñ‰∏≤Ë°åÔºâ
                    updateToast(recordingToast, `ÂáÜÂ§áÊ∏≤Êüì ${targetWidth}x${targetHeight} È´òÂàÜËæ®ÁéáÂ∏ßÊï∞ÊçÆ...`);

                    let renderedFrames;
                    try {
                        // Â∞ùËØïÂπ∂Ë°åÊ∏≤Êüì
                        console.log('=== ÂºÄÂßãÂπ∂Ë°åÊ∏≤ÊüìÊµãËØï ===');
                        console.log('ÊÄªÂ∏ßÊï∞:', totalRecordFrames);
                        console.log('ÁõÆÊ†áÂàÜËæ®Áéá:', targetWidth + 'x' + targetHeight);
                        console.log('Â≠óÂè∑ËÆæÁΩÆ:', { titleFontSize, axisTitleFontSize, axisTickFontSize, legendFontSize });

                        // Ëé∑ÂèñÊâÄÊúâDOMÂÖÉÁ¥†ÁöÑÂÄºÔºåÈÅøÂÖçÂú®Âπ∂Ë°åÊâßË°å‰∏≠ËÆøÈóÆDOM
                        const chartTitle = chartTitleInput.value;
                        const showLegend = showLegendSelect.value === 'true';
                        const xAxisType = xAxisTypeSelect.value;
                        const xAxisLabel = xAxisLabelInput.value;
                        const yAxisLabel = yAxisLabelInput.value;
                        const xMin = xMinInput.value === 'auto' ? 'auto' : parseFloat(xMinInput.value);
                        const xMax = xMaxInput.value === 'auto' ? 'auto' : parseFloat(xMaxInput.value);
                        const yMin = yMinInput.value === 'auto' ? 'auto' : parseFloat(yMinInput.value);
                        const yMax = yMaxInput.value === 'auto' ? 'auto' : parseFloat(yMaxInput.value);
                        const skipFrames = parseInt(skipFramesInput.value) || 0;

                        // ÂÖàÊµãËØïÂçï‰∏™Â∏ßÊ∏≤Êüì
                        console.log('ÊµãËØïÂçï‰∏™Â∏ßÊ∏≤Êüì...');
                        const testFrame = await renderSingleFrame(targetWidth, targetHeight, 0, startRow, {
                            titleFontSize,
                            axisTitleFontSize,
                            axisTickFontSize,
                            legendFontSize
                        }, {
                            chartTitle,
                            showLegend,
                            xAxisType,
                            xAxisLabel,
                            yAxisLabel,
                            xMin,
                            xMax,
                            yMin,
                            yMax,
                            skipFrames
                        });
                        console.log('Âçï‰∏™Â∏ßÊµãËØïÊàêÂäüÔºåcanvasÂ§ßÂ∞è:', testFrame.width + 'x' + testFrame.height);

                        console.log('ÂºÄÂßãÁúüÊ≠£ÁöÑÂπ∂Ë°åÊ∏≤Êüì...');
                        renderedFrames = await renderAllFramesParallel(
                            targetWidth,
                            targetHeight,
                            totalRecordFrames,
                            startRow,
                            recordingAbortController,
                        (progress) => {
                            // Êõ¥Êñ∞Ê∏≤ÊüìËøõÂ∫¶
                            updateToast(recordingToast, `Ê≠£Âú®Ê∏≤ÊüìÂ∏ßÊï∞ÊçÆ... ${progress}%`, {
                                showCancel: true,
                                cancelText: 'ÂèñÊ∂àÂΩïÂà∂',
                                onCancel: handleCancelRecording
                            });
                        }, {
                            titleFontSize,
                            axisTitleFontSize,
                            axisTickFontSize,
                            legendFontSize
                        }, {
                            chartTitle,
                            showLegend,
                            xAxisType,
                            xAxisLabel,
                            yAxisLabel,
                            xMin,
                            xMax,
                            yMin,
                            yMax,
                            skipFrames
                        }
                    );
                    } catch (error) {
                        console.error('Âπ∂Ë°åÊ∏≤ÊüìÂ§±Ë¥•ÔºåËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ:', {
                            message: error.message,
                            stack: error.stack,
                            name: error.name
                        });
                        updateToast(recordingToast, 'Âπ∂Ë°åÊ∏≤ÊüìÂ§±Ë¥•ÔºåÂàáÊç¢Âà∞‰∏≤Ë°åÊ∏≤ÊüìÊ®°Âºè...');

                        // ‰∏≤Ë°åÊ∏≤ÊüìÔºàÊõ¥Á®≥ÂÆö‰ΩÜËæÉÊÖ¢Ôºâ
                        renderedFrames = [];
                        for (let frameIndex = 0; frameIndex < totalRecordFrames; frameIndex++) {
                            if (recordingAbortController?.signal.aborted) {
                                throw new Error('ÂΩïÂà∂Â∑≤ÂèñÊ∂à');
                            }

                            const progress = Math.round((frameIndex / totalRecordFrames) * 100);
                            updateToast(recordingToast, `Ê≠£Âú®Ê∏≤ÊüìÂ∏ßÊï∞ÊçÆ(‰∏≤Ë°å)... ${progress}%`, {
                                showCancel: true,
                                cancelText: 'ÂèñÊ∂àÂΩïÂà∂',
                                onCancel: handleCancelRecording
                            });

                            renderedFrames.push(await renderSingleFrame(targetWidth, targetHeight, frameIndex, startRow, {
                                titleFontSize,
                                axisTitleFontSize,
                                axisTickFontSize,
                                legendFontSize
                            }, {
                                chartTitle: chartTitleInput.value,
                                showLegend: showLegendSelect.value === 'true',
                                xAxisType: xAxisTypeSelect.value,
                                xAxisLabel: xAxisLabelInput.value,
                                yAxisLabel: yAxisLabelInput.value,
                                xMin: xMinInput.value === 'auto' ? 'auto' : parseFloat(xMinInput.value),
                                xMax: xMaxInput.value === 'auto' ? 'auto' : parseFloat(xMaxInput.value),
                                yMin: yMinInput.value === 'auto' ? 'auto' : parseFloat(yMinInput.value),
                                yMax: yMaxInput.value === 'auto' ? 'auto' : parseFloat(yMaxInput.value),
                                skipFrames: parseInt(skipFramesInput.value) || 0
                            }));
                        }
                    }

                    // Ê£ÄÊü•ÊòØÂê¶Ë¢´ÂèñÊ∂à
                    if (recordingAbortController.signal.aborted) {
                        mediaRecorder.stop();
                        return;
                    }

                    updateToast(recordingToast, 'ÂºÄÂßãÂΩïÂà∂ËßÜÈ¢ë...');

                    // ÂºÄÂßãÂΩïÂà∂Âπ∂ÈÄêÂ∏ßËæìÂá∫Âà∞Á¶ªÂ±ècanvas
                    const recordAllFrames = async () => {
                        for (let frameIndex = 0; frameIndex < totalRecordFrames; frameIndex++) {
                            // Ê£ÄÊü•ÊòØÂê¶Ë¢´ÂèñÊ∂à
                            if (recordingAbortController.signal.aborted) {
                                mediaRecorder.stop();
                                return;
                            }

                            // Êõ¥Êñ∞ËøõÂ∫¶
                            const progress = Math.round((frameIndex / totalRecordFrames) * 100);
                            updateToast(recordingToast, `Ê≠£Âú®ÂΩïÂà∂ËßÜÈ¢ë... ${frameIndex + 1}/${totalRecordFrames} (${progress}%)`, {
                                showCancel: true,
                                cancelText: 'ÂèñÊ∂àÂΩïÂà∂',
                                onCancel: handleCancelRecording
                            });

                            // Â∞ÜÈ¢ÑÊ∏≤ÊüìÁöÑÂ∏ßÁªòÂà∂Âà∞Á¶ªÂ±ècanvasÔºàËÆæÁΩÆÁôΩËâ≤ËÉåÊôØÔºâ
                            const offscreenCtx = offscreenCanvas.getContext('2d');
                            offscreenCtx.fillStyle = 'white';
                            offscreenCtx.fillRect(0, 0, offscreenCanvas.width, offscreenCanvas.height);
                            offscreenCtx.drawImage(renderedFrames[frameIndex], 0, 0);

                            // Á≠âÂæÖÂ∏ßÈó¥ÈöîÊó∂Èó¥ÔºàÂü∫‰∫éËÆæÁΩÆÁöÑËßÜÈ¢ëÂ∏ßÁéáÔºâ
                            const targetFrameInterval = 1000 / videoFPS;
                            await new Promise(resolve => setTimeout(resolve, targetFrameInterval));
                        }

                        // ÂΩïÂà∂ÂÆåÊàê
                        updateToast(recordingToast, 'ÂΩïÂà∂ÂÆåÊàêÔºåÊ≠£Âú®Â§ÑÁêÜËßÜÈ¢ë...');
                        console.log('ÊâÄÊúâÂ∏ßÊ∏≤ÊüìÂÆåÊàêÔºåÂáÜÂ§áÂÅúÊ≠¢MediaRecorder');

                        // Ê∑ªÂä†Ë∂ÖÊó∂‰øùÊä§ÔºåÁ°Æ‰øù‰∏ç‰ºöÂç°‰Ωè
                        const stopTimeout = setTimeout(() => {
                            console.error('MediaRecorderÂÅúÊ≠¢Ë∂ÖÊó∂ÔºåÂº∫Âà∂Â§ÑÁêÜ');
                            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                                try {
                                    mediaRecorder.stop();
                                } catch (e) {
                                    console.error('Âº∫Âà∂ÂÅúÊ≠¢Â§±Ë¥•:', e);
                                }
                            }
                        }, 5000); // 5ÁßíË∂ÖÊó∂

                        // Á°Æ‰øùMediaRecorderÂÅúÊ≠¢
                        try {
                            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                                mediaRecorder.stop();
                                console.log('MediaRecorder.stop()Â∑≤Ë∞ÉÁî®');

                                // Ê∏ÖÈô§Ë∂ÖÊó∂
                                clearTimeout(stopTimeout);
                            } else {
                                console.log('MediaRecorderÂ∑≤ÁªèÊòØinactiveÁä∂ÊÄÅ');
                                clearTimeout(stopTimeout);
                            }
                        } catch (error) {
                            console.error('ÂÅúÊ≠¢MediaRecorderÊó∂Âá∫Èîô:', error);
                            clearTimeout(stopTimeout);
                            throw error;
                        }
                    };

                    // ÂºÄÂßãÂêéÂè∞ÂΩïÂà∂
                    recordAllFrames();

                } catch (error) {
                    console.error('ÂΩïÂà∂ËßÜÈ¢ëÊó∂Âá∫Èîô:', error);
                    isRecording = false;
                    saveVideoBtn.disabled = false;
                    saveVideoBtn.textContent = '‰øùÂ≠òËßÜÈ¢ë';
                    recordingAbortController = null;

                    if (recordingToast) {
                        removeToast(recordingToast);
                        recordingToast = null;
                    }
                    showToast('ÂΩïÂà∂ËßÜÈ¢ëÂ§±Ë¥•: ' + error.message, 'error', { duration: 8000 });
                }
            }

            // Âπ∂Ë°åÊ∏≤ÊüìÊâÄÊúâÂ∏ß‰ª•Âä†ÈÄüÂ§ÑÁêÜ
            async function renderAllFramesParallel(width, height, totalFrames, startRow, abortController, progressCallback, fontSizeConfig = {}, chartConfig = {}) {
                console.log(`=== renderAllFramesParallel ÂºÄÂßã ===`);
                console.log(`ÂèÇÊï∞: ${width}x${height}, ÊÄªÂ∏ßÊï∞: ${totalFrames}, Ëµ∑ÂßãË°å: ${startRow}`);
                console.log(`abortControllerÂ≠òÂú®: ${!!abortController}`);
                console.log(`progressCallbackÁ±ªÂûã: ${typeof progressCallback}`);

                const renderedFrames = new Array(totalFrames);
                // Ê†πÊçÆÂàÜËæ®ÁéáË∞ÉÊï¥ÊâπÈáèÂ§ßÂ∞èÔºåÈ´òÂàÜËæ®ÁéáÊó∂ÂáèÂ∞ëÂπ∂Âèë
                const maxConcurrent = width >= 1920 ? 2 : (width >= 1280 ? 4 : 8);
                const batchSize = Math.min(maxConcurrent, totalFrames);
                console.log(`ÊúÄÂ§ßÂπ∂ÂèëÊï∞: ${maxConcurrent}, ÊâπÊ¨°Â§ßÂ∞è: ${batchSize}`);
                const batches = [];

                // Â∞ÜÂ∏ßÂàÜÊâπÂ§ÑÁêÜ
                for (let i = 0; i < totalFrames; i += batchSize) {
                    batches.push({
                        start: i,
                        end: Math.min(i + batchSize, totalFrames)
                    });
                }
                console.log(`ÂàÜÊâπÂÆåÊàêÔºåÊÄªÂÖ± ${batches.length} ‰∏™ÊâπÊ¨°`);

                let completedFrames = 0;

                // Âπ∂Ë°åÂ§ÑÁêÜÊØè‰∏™ÊâπÊ¨°
                console.log('ÂºÄÂßãÂπ∂Ë°åÂ§ÑÁêÜÊØè‰∏™ÊâπÊ¨°...');
                for (let batchIndex = 0; batchIndex < batches.length; batchIndex++) {
                    const batch = batches[batchIndex];
                    console.log(`Â§ÑÁêÜÁ¨¨ ${batchIndex + 1}/${batches.length} ÊâπÊ¨°ÔºåÂ∏ßËåÉÂõ¥: ${batch.start}-${batch.end-1}`);

                    // Ê£ÄÊü•ÊòØÂê¶Ë¢´ÂèñÊ∂à
                    if (abortController?.signal.aborted) {
                        console.log('Ê£ÄÊµãÂà∞ÂèñÊ∂à‰ø°Âè∑ÔºåÂÅúÊ≠¢Ê∏≤Êüì');
                        throw new Error('ÂΩïÂà∂Â∑≤ÂèñÊ∂à');
                    }

                    const batchPromises = [];

                    // ‰∏∫ÊâπÊ¨°‰∏≠ÁöÑÊØèÂ∏ßÂàõÂª∫Ê∏≤Êüì‰ªªÂä°
                    console.log(`‰∏∫ÊâπÊ¨° ${batchIndex + 1} ÂàõÂª∫ ${batch.end - batch.start} ‰∏™Ê∏≤Êüì‰ªªÂä°`);
                    for (let frameIndex = batch.start; frameIndex < batch.end; frameIndex++) {
                        console.log(`ÂàõÂª∫Ê∏≤Êüì‰ªªÂä°: Â∏ß ${frameIndex + 1}`);

                        batchPromises.push(renderSingleFrame(width, height, frameIndex, startRow, fontSizeConfig, chartConfig));
                    }

                    // Á≠âÂæÖÂΩìÂâçÊâπÊ¨°ÂÆåÊàêÔºàÊ∑ªÂä†Ë∂ÖÊó∂‰øùÊä§Ôºâ
                    console.log(`Á≠âÂæÖÊâπÊ¨° ${batchIndex + 1} ÂÆåÊàêÔºå${batchPromises.length} ‰∏™‰ªªÂä°...`);
                    const batchResults = await Promise.race([
                        Promise.all(batchPromises),
                        new Promise((_, reject) => setTimeout(() => reject(new Error('Ê∏≤ÊüìË∂ÖÊó∂')), 30000)) // 30ÁßíË∂ÖÊó∂
                    ]);
                    console.log(`ÊâπÊ¨° ${batchIndex + 1} ÂÆåÊàêÔºåÊî∂Âà∞ ${batchResults.length} ‰∏™ÁªìÊûú`);

                    // ‰øùÂ≠òÊâπÊ¨°ÁªìÊûú
                    for (let i = 0; i < batchResults.length; i++) {
                        const frameIndex = batch.start + i;
                        renderedFrames[frameIndex] = batchResults[i];
                        completedFrames++;

                        // Êõ¥Êñ∞ËøõÂ∫¶
                        const progress = Math.round((completedFrames / totalFrames) * 100);
                        progressCallback(progress);
                    }
                }

                console.log(`=== renderAllFramesParallel ÂÆåÊàê ===`);
                console.log(`ÊÄªÂÖ±Ê∏≤Êüì ${renderedFrames.filter(f => f).length}/${renderedFrames.length} Â∏ß`);
                return renderedFrames;
            }

            // Ê∏≤ÊüìÂçï‰∏™Â∏ßÔºà‰ºòÂåñÊÄßËÉΩÂíåÂÜÖÂ≠òÔºâ
            async function renderSingleFrame(width, height, frameIndex, startRow, fontSizeConfig = {}, chartConfig = {}) {
                return new Promise((resolve, reject) => {
                    const timeoutId = setTimeout(() => {
                        reject(new Error(`Ê∏≤ÊüìÁ¨¨ ${frameIndex + 1} Â∏ßË∂ÖÊó∂`));
                    }, 60000); // 60ÁßíË∂ÖÊó∂

                    try {
                        console.log(`ÂºÄÂßãÊ∏≤ÊüìÁ¨¨ ${frameIndex + 1} Â∏ßÔºåÂ≠óÂè∑ËÆæÁΩÆ:`, fontSizeConfig);
                        // ÂàõÂª∫‰∏¥Êó∂canvasÁî®‰∫éÊ∏≤Êüì
                        const tempCanvas = document.createElement('canvas');
                        tempCanvas.width = width;
                        tempCanvas.height = height;

                        // ËÆæÁΩÆÁôΩËâ≤ËÉåÊôØ
                        const tempCtx = tempCanvas.getContext('2d');
                        tempCtx.fillStyle = 'white';
                        tempCtx.fillRect(0, 0, width, height);

                        // Ëé∑ÂèñÂΩìÂâçÂ∏ßÊó∂Èó¥ÔºàËÄÉËôëË∑≥Â∏ßËÆæÁΩÆÔºâ
                        const skipFrames = chartConfig.skipFrames || 0;
                        const actualRowIndex = startRow + frameIndex * (skipFrames + 1);
                        const currentTime = csvFiles.length > 0 ? csvFiles[0].data[actualRowIndex][0] : `Êó∂Èó¥_${frameIndex + 1}`;

                        // ÂáÜÂ§áÊï∞ÊçÆÈõÜ - Â§öÊñá‰ª∂ÁâàÊú¨
                        const datasets = [];

                        // Ê∑ªÂä†ÊâÄÊúâÊñá‰ª∂ÁöÑÂä®ÊÄÅÊï∞ÊçÆÈõÜ
                        for (let fileIndex = 0; fileIndex < allFilesFrameData.length; fileIndex++) {
                            const fileInfo = allFilesFrameData[fileIndex];
                            const csvFileInfo = csvFiles[fileIndex];
                            datasets.push({
                                label: csvFileInfo.displayName, // ‰ΩøÁî®ÊòæÁ§∫ÂêçÁß∞
                                data: fileInfo.frameData[frameIndex], // ÂΩìÂâçÂ∏ßÊï∞ÊçÆ
                                borderColor: fileInfo.color,
                                backgroundColor: fileInfo.color + '20', // Ê∑ªÂä†ÈÄèÊòéÂ∫¶
                                borderWidth: 2.5, // Âä®ÊÄÅÊï∞ÊçÆÁ∫øÊù°ÈÄÇ‰∏≠Á≤óÁªÜ
                                pointRadius: 0, // ÂéªÊéâÁÇπÊ†áËÆ∞
                                pointHoverRadius: 5, // Èº†Ê†áÊÇ¨ÊµÆÊó∂ÊòæÁ§∫ÁÇπ
                                tension: 0.1,
                                borderDash: [] // Á°Æ‰øù‰ΩøÁî®ÂÆûÁ∫ø
                            });
                        }

                        // Ê∑ªÂä†Â∏∏ÊòæË°åÊï∞ÊçÆÈõÜÔºàÊù•Ëá™ÊâÄÊúâÊñá‰ª∂Ôºâ
                        for (let i = 0; i < constantRowsData.length; i++) {
                            const constRowData = constantRowsData[i];
                            datasets.push({
                                label: constRowData.label,
                                data: constRowData.data,
                                borderColor: constRowData.color,
                                backgroundColor: constRowData.color + '20',
                                borderWidth: 1.5, // Â∏∏ÊòæË°å‰ΩøÁî®ÁªÜÂÆûÁ∫ø
                                pointRadius: 0,
                                pointHoverRadius: 4,
                                tension: 0.1,
                                borderDash: [] // ‰ΩøÁî®ÂÆûÁ∫ø
                            });
                        }

                        // ÂàõÂª∫‰∏¥Êó∂ÂõæË°®ÔºàÈ´òÂàÜËæ®Áéá‰ºòÂåñÔºâ
                        const tempChart = new Chart(tempCanvas, {
                            type: 'line',
                            data: { datasets: datasets },
                            options: {
                                responsive: false,
                                maintainAspectRatio: false,
                                animation: false, // ÂÖ≥Èó≠Âä®Áîª‰ª•ÊèêÈ´òÊÄßËÉΩ
                                backgroundColor: 'white', // ËÆæÁΩÆÂõæË°®ËÉåÊôØ‰∏∫ÁôΩËâ≤
                                devicePixelRatio: 1, // Âõ∫ÂÆöÂÉèÁ¥†ÊØî‰æãÔºåÂõ†‰∏∫Êàë‰ª¨Â∑≤ÁªèÊâãÂä®Â§ÑÁêÜ‰∫ÜÈ´òÂàÜËæ®Áéá
                                plugins: {
                                    title: {
                                        display: true,
                                        text: [chartConfig.chartTitle || 'Êï∞ÊçÆÂä®Áîª', `${currentTime}`],
                                        font: { size: fontSizeConfig.titleFontSize || 16 },
                                        color: '#333' // Ê†áÈ¢òÈ¢úËâ≤
                                    },
                                    legend: {
                                        display: chartConfig.showLegend || (allFilesFrameData.length > 1 || constantRowsData.length > 0),
                                        labels: {
                                            color: '#333',
                                            font: { size: fontSizeConfig.legendFontSize || 12 } // Âõæ‰æãÊñáÂ≠óÈ¢úËâ≤
                                        }
                                    }
                                },
                                scales: {
                                    x: {
                                        type: chartConfig.xAxisType || 'linear',
                                        title: {
                                            display: true,
                                            text: chartConfig.xAxisLabel || 'XËΩ¥',
                                            color: '#333',
                                            font: { size: fontSizeConfig.axisTitleFontSize || 14 }
                                        },
                                        ticks: {
                                            color: '#333', // ÂàªÂ∫¶Ê†áÁ≠æÈ¢úËâ≤
                                            font: { size: fontSizeConfig.axisTickFontSize || 12 }
                                        },
                                        grid: {
                                            color: '#e0e0e0' // ÁΩëÊ†ºÁ∫øÈ¢úËâ≤
                                        },
                                        min: chartConfig.xAxisType === 'linear' ? chartConfig.xMin : undefined,
                                        max: chartConfig.xAxisType === 'linear' ? chartConfig.xMax : undefined
                                    },
                                    y: {
                                        title: {
                                            display: true,
                                            text: chartConfig.yAxisLabel || 'YËΩ¥',
                                            color: '#333',
                                            font: { size: fontSizeConfig.axisTitleFontSize || 14 }
                                        },
                                        ticks: {
                                            color: '#333',
                                            font: { size: fontSizeConfig.axisTickFontSize || 12 }
                                        },
                                        grid: {
                                            color: '#e0e0e0'
                                        },
                                        min: chartConfig.yMin === 'auto' ? null : chartConfig.yMin,
                                        max: chartConfig.yMax === 'auto' ? null : chartConfig.yMax
                                    }
                                }
                            }
                        });

                        // Á≠âÂæÖÂõæË°®Ê∏≤ÊüìÂÆåÊàê
                        setTimeout(() => {
                            try {
                                // ÂàõÂª∫ÊúÄÁªàÁöÑcanvasÁî®‰∫éËæìÂá∫
                                const outputCanvas = document.createElement('canvas');
                                outputCanvas.width = width;
                                outputCanvas.height = height;
                                const outputCtx = outputCanvas.getContext('2d');

                                // ËÆæÁΩÆÁôΩËâ≤ËÉåÊôØ
                                outputCtx.fillStyle = 'white';
                                outputCtx.fillRect(0, 0, width, height);

                                // ÁªòÂà∂ÂõæË°®ÔºåÁ°Æ‰øù‰ΩøÁî®Ê≠£Á°ÆÁöÑÂ∞∫ÂØ∏
                                outputCtx.drawImage(tempCanvas, 0, 0, width, height);

                                // Ê∏ÖÁêÜ‰∏¥Êó∂ÂõæË°®
                                tempChart.destroy();

                                resolve(outputCanvas);
                            } catch (error) {
                                tempChart.destroy();
                                reject(error);
                            }
                        }, 100); // ÁªôË∂≥Â§üÊó∂Èó¥Ê∏≤Êüì

                        clearTimeout(timeoutId); // Ê∏ÖÈô§Ë∂ÖÊó∂ÂÆöÊó∂Âô®

                    } catch (error) {
                        clearTimeout(timeoutId); // Ê∏ÖÈô§Ë∂ÖÊó∂ÂÆöÊó∂Âô®
                        reject(error);
                    }
                });
            }
        });
    </script>

    <!-- ÂõæÁâáÊù•Ê∫êÊ†áÊ≥® -->
    <div class="bg-source">
        ÂõæÁâáÊù•Ê∫êÔºö<a id="bgSourceLink" href="https://wallhaven.cc" target="_blank" rel="noopener noreferrer">https://wallhaven.cc</a>
    </div>
</body>
</html>
